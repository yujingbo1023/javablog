---
title: 05-MybatisPlus
date: 2028-12-15
sticky: 1
sidebar: 'auto'
tags:
 - ssm
categories:
 -  ssm
---



### 1，MyBatisPlus介绍

![1723100603943](./assets/1723100603943.png)

MyBatis-Plus（简称 MP）是一个MyBatis的增强工具，在MyBatis的基础上只做增强不做改变，为简化开发、提高效率而生。MyBatisPlus的愿景是成为MyBatis最好的搭档，就像魂斗罗中的1P、2P，基友搭配，效率翻倍。

![1723100657195](./assets/1723100657195.png)



官网：https://baomidou.com/



### 2，SB集成MyBatisPlus

接下来我们在SpringBoot项目中使用MyBatisPlus。创建SpringBoot项目，添加MyBatisPlus起步依赖

![1723100766593](./assets/1723100766593.png)

![1723100782842](./assets/1723100782842.png)

![1723101027550](./assets/1723101027550.png)

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.malu</groupId>
    <artifactId>springboot_test01</artifactId>
    <version>1.0-SNAPSHOT</version>
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.7.9</version>
    </parent>
    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter</artifactId>
        </dependency>
        <!-- MyBatisPlus -->
        <dependency>
            <groupId>com.baomidou</groupId>
            <artifactId>mybatis-plus-boot-starter</artifactId>
            <version>3.5.0</version>
        </dependency>
        <!-- mysql驱动 -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>8.0.26</version>
        </dependency>
        <!--测试的-->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
        <!--lombok-->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <version>1.18.22</version>
        </dependency>
    </dependencies>
    <!--  插件  -->
    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </exclude>
                    </excludes>
                </configuration>
            </plugin>
        </plugins>
    </build>
    <properties>
        <maven.compiler.source>11</maven.compiler.source>
        <maven.compiler.target>11</maven.compiler.target>
    </properties>

</project>
```

在SpringBoot配置文件中配置数据源:

![1723101129844](./assets/1723101129844.png)

```yml
# 配置数据源
spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://127.0.0.1:3388/scholl?serverTimezone=UTC
    username: root
    password: root
```



创建一张表：

![1723101378867](./assets/1723101378867.png)



缩写实体类：

![1723101531271](./assets/1723101531271.png)



编写Mapper接口，继承BaseMapper

![1723101593853](./assets/1723101593853.png)

```java
package com.malu.mapper;

import com.baomidou.mybatisplus.core.mapper.BaseMapper;
import com.malu.domain.Student;

public interface StudentMapper extends BaseMapper<Student> {
}
```



在 SpringBoot启动类中添加 @MapperScan 注解，扫描Mapper文件夹

![1723101711982](./assets/1723101711982.png)



测试：

![1723101893609](./assets/1723101893609.png)



![1723101965376](./assets/1723101965376.png)

```java
@SpringBootTest
public class StudentMapperTest {
    @Autowired
    private StudentMapper studentMapper;

    @Test
    public void testFindById(){
        Student student = studentMapper.selectById(1);
        System.out.println(student);
    }
}
```



### 3，CURD

配置文件开启SQL日志打印

![1723102049214](./assets/1723102049214.png)

```yml
mybatis-plus:
  configuration:
    # 开启SQL日志打印
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
```



测试添加方法：

![1723102214485](./assets/1723102214485.png)

```java
    @Test
    public void testAdd(){
        Student student1 = new Student(null, "yyy", "yyy@qq.com", "man", 22);
        studentMapper.insert(student1);
        // MP插入成功后，可以直接获取主键
        System.out.println(student1.getId());
    }
```



我们将表名改为tb_student，id字段名改为sid，name字段名改为sname，此时由于名字不同无法完成映射，我们可以通过相关注解为实体类对象指定表名和列名。

![1723102343949](./assets/1723102343949.png)

测试：

![1723102377246](./assets/1723102377246.png)



@TableName

- 作用：指定类为哪个表的实体类
- 位置：类上方



@TableId

- 作用：指定实体类的属性为主键
- 位置：属性上方



属性：

- value：主键字段名
- type：主键策略

![1723102444478](./assets/1723102444478.png)



@TableField

- 作用：在属性和列名不同的情况下，指定映射关系
- 位置：非主键属性上方



使用：

![1723102765035](./assets/1723102765035.png)

```java
@Data
@NoArgsConstructor
@AllArgsConstructor
@TableName("tb_student")
public class Student {
    @TableId(value = "sid",type = IdType.AUTO)
    private Integer id;
    @TableField("sname")
    private String name;
    private String email;
    private String gender;
    private Integer age;
}
```



测试：

![1723102779528](./assets/1723102779528.png)



测试修改：

![1723102896619](./assets/1723102896619.png)

```java
    @Test
    public void testUpdate(){
        //创建实体类对象
        Student student1 = new Student();
        //设置需要修改的数据id
        student1.setId(1);
        //设置需要更新的属性
        student1.setName("xxxppp");
        studentMapper.updateById(student1);
    }
```



测试删除：

![1723103088636](./assets/1723103088636.png)



批量删除：

![1723103139500](./assets/1723103139500.png)



![1723103261194](./assets/1723103261194.png)



也可以根据字段条件删除：

![1723103322161](./assets/1723103322161.png)

![1723103493013](./assets/1723103493013.png)



根据ID查询：

![1723103546363](./assets/1723103546363.png)



 根据id批量查询：

![1723103648933](./assets/1723103648933.png)

```java
    // 批量查询
    @Test
    public void testFindBatch(){
        ArrayList<Integer> ids = new ArrayList<>();
        ids.add(1);
        ids.add(2);
        ids.add(3);
        studentMapper.selectBatchIds(ids);
    }
```



 根据字段条件查询：

![1723103721604](./assets/1723103721604.png)



### 4，条件查询

Mybatis-Plus通过QueryWrapper对象让用户自由的构建SQL条件，简单便捷，没有额外的负担，能够有效提高开发效率。构造时使用的是数据库字段，不是Java属性。

条件参数说明:

![1723103794417](./assets/1723103794417.png)



准备数据：

![1723104633195](./assets/1723104633195.png)



实现条件查询：

![1723104736226](./assets/1723104736226.png)

![1723104875529](./assets/1723104875529.png)

![1723104947457](./assets/1723104947457.png)

```java
    // 条件构造器1
    @Test
    public void testFindWrapper1() {
        // 查询年龄小于25或年龄大于30的人
        QueryWrapper<Student> queryWrapper = new QueryWrapper<>();
        queryWrapper.lt("age",25).or().gt("age",30);
        List<Student> students = studentMapper.selectList(queryWrapper);
        students.forEach(System.out::println);
    }

    // 条件构造器2
    @Test
    public void testFindWrapper2() {
        // 查询性别为女，且年龄小于等于35的数据
        QueryWrapper<Student> queryWrapper = new QueryWrapper<>();
        queryWrapper.eq("gender","woman").le("age",35);
        List<Student> students = studentMapper.selectList(queryWrapper);
        students.forEach(System.out::println);
    }

    // 条件构造器3
    @Test
    public void testFindWrapper3() {
        // 查询名字包含"y"的学生，按照年龄升序排序
        QueryWrapper<Student> queryWrapper = new QueryWrapper<>();
        queryWrapper.like("sname","y").orderByAsc("age");
        List<Student> students = studentMapper.selectList(queryWrapper);
        students.forEach(System.out::println);
    }

```

### 5，分页查询

在配置类或启动类配置分页插件:

![1723105355568](./assets/1723105355568.png)

```java
// 启动类也是一个配置类
@SpringBootApplication
@MapperScan("com.malu.mapper")
public class App {
    public static void main(String[] args) {
        SpringApplication.run(App.class,args);
    }

    // 配置插件
    @Bean
    public MybatisPlusInterceptor mybatisPlusInterceptor(){
        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
        interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL));
        return interceptor;
    }
}

```



测试分页查询:

![1723105610514](./assets/1723105610514.png)

```java
    @Test
    public void testFindPage(){
        Page<Student> page = new Page<Student>(0,2);
        Page<Student> iPage = studentMapper.selectPage(page, null);
        // 打印分页数据
        System.out.println("结果集："+iPage.getRecords());
        System.out.println("总页数："+iPage.getPages());
        System.out.println("总条数："+iPage.getTotal());
        System.out.println("当前页："+iPage.getCurrent());
        System.out.println("每页条数："+iPage.getSize());
    }
```



### 6，全局配置



### 7，分页插件



### 8，乐观锁插件



### 9，逻辑删除



### 10，自动填充



### 11，代码生成器

如果不想手动编写实体类等文件，MyBaitsPlus提供了代码生成器，它可以读取数据库的表信息，生成MyBaitsPlus代码供我们使用，之前我们学过MyBatis的代码生成器MyBatis Generator。添加代码生成器所需的依赖：

![1723106764797](./assets/1723106764797.png)

``` xml
        <!-- MP代码生成器  -->
        <dependency>
            <groupId>com.baomidou</groupId>
            <artifactId>mybatis-plus-generator</artifactId>
            <version>3.5.1</version>
        </dependency>
        <!-- MP代码生成器需要的模板引擎  -->
        <dependency>
            <groupId>org.apache.velocity</groupId>
            <artifactId>velocity-engine-core</artifactId>
            <version>2.2</version>
        </dependency>
```



编写代码生成器:

![1723106953548](./assets/1723106953548.png)

```java
package com.malu;

import com.baomidou.mybatisplus.generator.FastAutoGenerator;
import com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;

public class MyGenerator {
    public static void main(String[] args) {
        FastAutoGenerator.create("jdbc:mysql://127.0.0.1:3388/scholl", "root", "root")
                // 全局配置
                .globalConfig(builder -> {
                    builder.author("malu") // 设置作者
                            .commentDate("YYYY-MM-dd") // 注释日期格式
                            .outputDir(System.getProperty("user.dir") + "/src/main/java") // 指定输出目录
                            .fileOverride(); //覆盖文件
                })
                // 包配置
                .packageConfig(builder -> {
                    builder.parent("com.malu") // 包名前缀
                            .entity("domain") //实体类包名
                            .mapper("mapper") //mapper接口包名
                            .service("service") //service包名
                            .controller("controller") //controller包名
                            .xml("mapper"); //映射文件包名
                })
                // 策略配置
                .strategyConfig(builder -> {
                    builder.addInclude("tb_student") // 设置需要生成的表名,可以有多个
                            .addTablePrefix("tb_") // 设置表名前缀
                            .entityBuilder() // 开始实体类配置
                            .enableLombok() // 开启lombok模型
                            .naming(NamingStrategy.underline_to_camel) //表名下划线转驼峰
                            .columnNaming(NamingStrategy.underline_to_camel);//列名下划线转驼峰
                })
                .execute();
    }
}
```



测试：

![1723107137872](./assets/1723107137872.png)



### 12，MybatisX

MybatisX是一款基于IDEA的快速开发插件，为效率而生。安装方法：打开 IDEA，进入 File -> Settings -> Plugins ->Marketplace，输入 mybatisx 搜索并安装。

![1723105682320](./assets/1723105682320.png)



利用这个插件可以生成代码，在IDEA中连接数据库，如下操作可以根据数据库表生成Mybaits代码：

![1723105833097](./assets/1723105833097.png)

![1723105870376](./assets/1723105870376.png)

![1723105999910](./assets/1723105999910.png)

![1723106086355](./assets/1723106086355.png)

![1723106138237](./assets/1723106138237.png)



第二个作用：

![1723106414638](./assets/1723106414638.png)



第三个作用，点击Mapper接口或映射文件前的小鸟图案，即可快速在Mapper接口与映射文件间跳转

![1723106528153](./assets/1723106528153.png)

![1723106537226](./assets/1723106537226.png)

