---
title: 13-vue2项目
date: 2028-12-15
sticky: 1
sidebar: 'auto'
tags:
 - js
categories:
 - base
---

## 一，项目介绍

### 1，项目介绍

开源GitHub项目地址：https://github.com/newbee-ltd

项目访问地址：http://47.99.134.126:5000/

账号密码：

* 已注册账号：18333333334
* 密码：123456

### 2，项目分析

五大组件与路由分析：

* 首页面组件  Home.vue
* 分类组件  Classify.vue
* 购物车组件  Cart.vue
* 我的组件  Personal.vue
* 登录组件  Login.vue

network面板分析登录接口：

![1698369277797](./assets/1698369277797.png)

![1698369519199](./assets/1698369519199.png)

![1698369596512](./assets/1698369596512.png)

![1698369737625](./assets/1698369737625.png)

![1698369986755](./assets/1698369986755.png)

application面板分析：

![1698370070033](./assets/1698370070033.png)

### 3，项目的骨架

我把项目中使用到的依赖，都记录好，把骨架发给大家，大家基于这个骨架进行开发，如下：

![1698370357009](./assets/1698370357009.png)

大家，需要解压，安装依赖（跑环境）：

```shell
npm i 
```

运行项目（看package.json）：

```shell
npm run serve
```

## 二，搭建五大组件并配置路由

### 1，创建出五大组件

组件分两类：

* 页面级别的组件（路由级别的组件）
* 通用组件（小组件，多个页面中可能都会用到）

上面分析的5大组件，是路由级别的，一般情况下，会放到views文件夹中，或者是pages文件夹中，如下：

![1698370499889](./assets/1698370499889.png)

配置路由，如下：

![1698370815994](./assets/1698370815994.png)

参考代码如下：

```js
import Vue from 'vue'
import VueRouter from 'vue-router'

Vue.use(VueRouter)

let routes = [{
        path: '/',
        redirect: '/home'
    },
    {
        path: '/home',
        component: () => import('../views/Home.vue'),
    },
    {
        path: '/classify',
        component: () => import('../views/Classify.vue'),
    },
    {
        path: '/cart',
        component: () => import('../views/Cart.vue'),
    },
    {
        path: '/personal',
        component: () => import('../views/Personal.vue'),
    },
    {
        path: '/login',
        component: () => import('../views/Login.vue'),
    }
]

const router = new VueRouter({
    routes
})

export default router;
```

在main.js中引入，挂载到根组件上，如下：

![1698370864116](./assets/1698370864116.png)

在App.vue中，需要指定出口，如下：

![1698370887818](./assets/1698370887818.png)

浏览器测试之，如下：

![1698370914084](./assets/1698370914084.png)

### 2，Vant组件库的使用

vant组件库，提供了大量的组件，可以方便我们快速构建项目。<br/>

vant的官网：https://vant-contrib.gitee.io/vant/#/zh-CN/  <br/>

如果是vue2，参考文档：https://vant-contrib.gitee.io/vant/v2/#/zh-CN/   <br/>

如果是vue3，参考文档：https://vant-contrib.gitee.io/vant/#/zh-CN   <br/>

要使用vant中提供的组件，引入方式，分三种：

* 自动按需引入（推荐）
* 手动按需引入
* 全部引入

如何实现自动按需引入？看看文档(文档怎么说就怎么做)：

* 地址：https://vant-contrib.gitee.io/vant/v2/#/zh-CN/quickstart

操作步骤如下：

![1698372309523](./assets/1698372309523.png)

![1698372365163](./assets/1698372365163.png)

操作之，如下：

![1698372482141](./assets/1698372482141.png)

重启项目，然后引入一个Button组件，测试之，如下：

![1698372528312](./assets/1698372528312.png)

浏览器测试之，如下：

![1698372929026](./assets/1698372929026.png)

在src下面创建一个utils文件夹，里面创建一个vant.js，如下：

![1698373289673](./assets/1698373289673.png)

参考代码如下：

```js
import Vue from "vue"
import {
    Button,
    Tabbar,
    TabbarItem,
    ShareSheet,
    Icon,
    Form,
    Field,
    NavBar,
    Swipe,
    SwipeItem,
    Grid,
    GridItem,
    GoodsAction,
    GoodsActionIcon,
    GoodsActionButton,
    Checkbox,
    Stepper,
    SubmitBar,
    AddressList,
    AddressEdit,
    Area,
    Tab,
    Tabs,
    List,
    Cell,
    SwipeCell,
    Card,
    Dialog,
    Toast,
    ContactCard,
    ActionSheet,
    Loading,
    divider,
    Search,
    sidebar,
    SidebarItem,
    grid
} from 'vant'

[
    Button,
    Tabbar,
    TabbarItem,
    ShareSheet,
    Icon,
    Form,
    Field,
    NavBar,
    Swipe,
    SwipeItem,
    Grid,
    GridItem,
    GoodsAction,
    GoodsActionIcon,
    GoodsActionButton,
    Checkbox,
    SubmitBar,
    AddressList,
    AddressEdit,
    Area,
    Stepper,
    Tab,
    Tabs,
    List,
    Cell,
    SwipeCell,
    Card,
    Dialog,
    Toast,
    ContactCard,
    ActionSheet,
    Loading,
    divider,
    Search,
    sidebar,
    SidebarItem,
    grid

].forEach(item => {
    Vue.use(item)
})
```

在main.js中引入vant.js，如下：

![1698373350875](./assets/1698373350875.png)

再次测试之，如下：

![1698373468649](./assets/1698373468649.png)

昨天讲了移动端适配：

* rem + 媒体查询来适配
* rem + 自己写的JS来适配
* rem + 淘宝的flexible来适配
* vw + vh适配 

在脚本架中，要适配的话，上面的方式都可以不用，可以配置postcss，如下：

![1698373126801](./assets/1698373126801.png)

### 3，处理全局样式

引入重置样式，如下：

![1698373600550](./assets/1698373600550.png)

设置App.vue组件的样式，如下：

![1698374325844](./assets/1698374325844.png)

浏览器效果如下：

![1698374339828](./assets/1698374339828.png)

## 三，封装TabBar组件

### 1，封装TabBar组件

我们需要封装的Tabbar组件如下：

![1698374983347](./assets/1698374983347.png)

要去写一个组件，先去UI组件库中找一下，有没有对应的组件，如下：

![1698375533970](./assets/1698375533970.png)

把Tabbar再封装一下，封装的通用组件就放在components中，如下(首页的to的值应该是/home)：

![1698375932510](./assets/1698375932510.png)

参考代码如下：

```vue
<template>
  <van-tabbar route active-color="#1baeae">
    <van-tabbar-item to="/home" icon="home-o">首页</van-tabbar-item>
    <van-tabbar-item to="/classify" icon="apps-o">分类</van-tabbar-item>
    <van-tabbar-item to="/cart" icon="shopping-cart-o" badge="5">购物车</van-tabbar-item>
    <van-tabbar-item to="/personal" icon="manager-o">我的</van-tabbar-item>
  </van-tabbar>
</template>

<script>
export default {
  name: "MyTarbar",
  props: [],
  data() {
    return {};
  },
  methods: {},
};
</script>

<style lang="less" scoped>
</style>
```

在App.vue中使用之，如下：

![1698376041916](./assets/1698376041916.png)

浏览器效果如下：

![1698376056965](./assets/1698376056965.png)

调整一下TabBar最大宽度，如下：

![1698377566898](./assets/1698377566898.png)

在main.js，引入flexble，引入vant的样式，如下：

![1698377619383](./assets/1698377619383.png)

浏览器效果如下：

![1698377682583](./assets/1698377682583.png)

### 2，控制Tabbar的显示与隐藏

当访问login组件时，不需要显示Tabbar，如下：

![1698377862118](./assets/1698377862118.png)

肯定要控制Tabbar的显示与隐藏，代码如下：

![1698378201259](./assets/1698378201259.png)

浏览器测试之，如下：

![1698378215476](./assets/1698378215476.png)

### 3，防止Tabar盖住页面内容

在首页面组件中写如下内容：

![1698378435359](./assets/1698378435359.png)

给#app的那个div添加一个padding-bottom，还不能直接添加，Login组件中没有Tabbar，也就是说有Tabbar时，需要添加，没有Tabbar时，不需要添加，代码如下：

![1698378580570](./assets/1698378580570.png)

绑定自定义事件，如下：

![1698378705704](./assets/1698378705704.png)

书写bottom这个类名，如下：

![1698378785683](./assets/1698378785683.png)

浏览器测试之，如下：

![1698378827776](./assets/1698378827776.png)

换成login组件，如下：

![1698378881718](./assets/1698378881718.png)

## 四，登录模块实现

### 1，绘制登录页面

目标：

![1698389591510](./assets/1698389591510.png)

找到vant中的导航组件，如下：

![1698389846795](./assets/1698389846795.png)

使用之，如下：

![1698389876617](./assets/1698389876617.png)

logo区域，如下:

![1698390067430](./assets/1698390067430.png)

实现样式，如下：

![1698390744846](./assets/1698390744846.png)

实现表单区域，如下：

```vue
<template>
  <div class="login-box">
    <!-- 导航 -->
    <van-nav-bar
      :title="isLogin ? '登录' : '注册'"
      left-text="返回"
      left-arrow
    />
    <!-- Logo -->
    <img :src="logo" alt="" class="logo" />

    <!-- 表单 -->
    <van-form validate-first @submit="submit" ref="formRef">
      <van-field
        v-model.trim="ruleForm.loginName"
        name="loginName"
        placeholder="请输入用户名"
        label="手机号"
        :rules="[
          { pattern: /^(?:(?:\+|00)86)?1\d{10}$/, message: '手机号格式有误' },
        ]"
      />
      <van-field
        v-model.trim="ruleForm.password"
        name="password"
        placeholder="请输入密码"
        label="密码"
        :rules="[{ required: true, message: '密码是必填项' }]"
      />
      <van-field
        v-model.trim="ruleForm.captcha"
        name="captcha"
        label="验证码"
        :rules="[{ validator: validatorCaptcha, message: '验证码输入有误' }]"
      >
        <template #button> 验证码（一会再说） </template>
      </van-field>

      <a href="javascript:;" class="text" @click="changeLogin">
        {{ isLogin ? "还没账号,请点此注册" : "已有账号,请点此登录" }}
      </a>
      <div style="margin: 16px">
        <van-button round block color="#1baeae" native-type="submit">
          确认提交
        </van-button>
      </div>
    </van-form>
  </div>
</template>

<script>
import logo from "@/assets/images/newbee-mall-vue3-app-logo.png";
export default {
  name: "Login",
  props: [],
  data() {
    return {
      logo,
      isLogin: true,
      ruleForm: {
        loginName: "", // 用户名
        password: "", // 密码
        captcha: "", // 验证码
      },
    };
  },
  methods: {
    changeLogin() {
      this.isLogin = !this.isLogin;
    },
    validatorCaptcha() {},
    async submit() {},
  },
};
</script>

<style lang="less" scoped>
.login-box {
  padding: 0 20px;
  .logo {
    width: 140px;
    height: 140%;
    display: block;
    margin: 40px auto 20px;
  }
  .text{
    display: block;
    margin-top: 20px;
    margin-bottom: 20px;
    padding: 0 15px;
    color: #1989fa;
    font-size: 14px;
  }
}
</style>
```

浏览器效果如下：

![1698392157397](./assets/1698392157397.png)

如果就想修改vant组件的样式，可以这样做，如下：

![1698393645850](./assets/1698393645850.png)

### 2，封装NavBar

在很多页面中都会使用到NavBar，封装一下，全局注册，封装如下：

![1698394037901](./assets/1698394037901.png)

全局注册之，如下：

![1698394181069](./assets/1698394181069.png)

在Login.vue中使用之，如下：

![1698394294543](./assets/1698394294543.png)

处理一下MyNavBar的样式，直接上代码，MyNavBar.vue如下：

```vue
<template>
  <div>
    <!-- 导航 -->
    <van-nav-bar
      fixed
      style="max-width: 540px"
      left-arrow
      @click-left="handleBack"
      safe-area-inset-top
      class="center-x"
    >
      <template #title>
        <span class="text">
          {{ title }}
        </span>
      </template>
      <template #right>
        <van-icon name="ellipsis" />
      </template>
    </van-nav-bar>
  </div>
</template>

<script>
export default {
  name: "MyNavBar",
  props: ["title"],
  data() {
    return {};
  },
  methods: {
    handleBack() {
      // 从哪来回哪去即可
      this.$router.back();
    },
  },
};
</script>
<style lang="less" scoped>
.text {
  font-weight: normal;
  font-size: 14px;
}
:deep(.van-nav-bar__title) {
  width: 70%;
  max-width: 70%;
}

.van-nav-bar{
  :deep(.van-icon){
    color: #000;
    font-size: 18px;
  } 
}
</style>
```

浏览器效果如下：

![1698394993353](./assets/1698394993353.png)

添加padding-top，如下：

![1698395042817](./assets/1698395042817.png)

点击右边的三个点，实现分享面板的显示，直接上代码：

```vue
<template>
  <div>
    <!-- 导航 -->
    <van-nav-bar
      fixed
      style="max-width: 540px"
      left-arrow
      @click-left="handleBack"
      safe-area-inset-top
      class="center-x"
    >
      <template #title>
        <span class="text">
          {{ title }}
        </span>
      </template>
      <template #right>
        <van-icon name="ellipsis" @click="isShare = true" />
      </template>
    </van-nav-bar>

    <!-- 分享 -->
    <van-share-sheet
      v-model="isShare"
      :options="options"
      title="立即分享给好友"
    />
  </div>
</template>

<script>
export default {
  name: "MyNavBar",
  props: ["title"],
  data() {
    return {
      isShare: false,
      options: [
        [
          { name: "微信", icon: "wechat" },
          { name: "朋友圈", icon: "wechat-moments" },
          { name: "微博", icon: "weibo" },
          { name: "QQ", icon: "qq" },
        ],
        [
          { name: "复制链接", icon: "link" },
          { name: "分享海报", icon: "poster" },
          { name: "二维码", icon: "qrcode" },
          { name: "小程序码", icon: "weapp-qrcode" },
        ],
      ],
    };
  },
  methods: {
    handleBack() {
      // 从哪来回哪去即可
      this.$router.back();
    },
  },
};
</script>
<style lang="less" scoped>
.text {
  font-weight: normal;
  font-size: 14px;
}
:deep(.van-nav-bar__title) {
  width: 70%;
  max-width: 70%;
}

.van-nav-bar {
  :deep(.van-icon) {
    color: #000;
    font-size: 18px;
  }
}
</style>
```

浏览器效果如下：

![1698395409232](./assets/1698395409232.png)

现在，在main.js中写了很多代码，把全局相关的代码放到一个单独的JS文件中，如下：

![1698395759827](./assets/1698395759827.png)

### 3，API封装

### 4，登录实现
