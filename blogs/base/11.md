---
title: 11-vue2
date: 2028-12-15
sticky: 1
sidebar: 'auto'
tags:
 - js
categories:
 - base
---

## 一，Hello Vue2

### 1，vue2介绍

特点：

* MVVM框架
* 响应式（声明式）
* 丰富的指令（DOM功能的抽象）
* 基于选项式（template、data、computed、watch、methods....）
* Vue的文档，最好的教程    https://v2.cn.vuejs.org/
* vue的生态丰富且简单
* 渐近式的（可大可小的项目都能做）

vue的开发思想：

当我们需要在交互事件中改变视图时，先在data选项中声明一个合适的变量，再在交互事件中改变这个声明式变量即可，视图自动更新，这是一种间接的操作。

关于vue.js的版本

* **vue2**，经典版本，现在绝大部分的企业项目都是用vue2版本开发。
* vue3，也是主流，后面都会过渡到vue3上。

体验一下vue2，如下：

![1697074083546](./assets/1697074083546.png)

参考代码如下：

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <!-- 引入vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.10/dist/vue.js"></script>
</head>

<body>
    <!-- 这个div叫vm实例对应的模板 -->
    <div id="app">
        <!-- {{}} 叫小胡子语法 -->
        <h2>{{name}}</h2>
        <button @click="changeData">改变数据</button>
    </div>

    <script>
        // Vue是一个构造器   new一个构造器就可以得到一个对象
        // vm也叫根组件   new Vue时，传递一个配置对象
        // 配置对象中需要写很多的选项
        // 所有的响应式数据，都会挂载到vm上。
        // vm代理data中所有的响应式数据
        let vm = new Vue({
            // el表示vm实例与上面的html容器进行关联
            el: "#app",
            // data是一个选项
            // data就是给模板提供数据的，放在data中的数据是响应式数据
            // 所谓的响应式的数据，就是数据变了，模板会自动刷新
            // 现在开发思想就变了：
            //   之前：获取DOM，操作DOM，改变视图
            //   现在：定义响应式数据，改变响应式数据，视图会自动的更新
            data() {
                return {
                    name: "码路", // 响应式数据
                }
            },
            methods: {
                changeData() {
                    // 改变响应式数据
                    // this，表示vm实例
                    this.name = "xxx";
                }
            }
        });
    </script>
</body>

</html>
```

再去体验一下，数据驱动视图，如下：

![1697074443573](./assets/1697074443573.png)

参考代码：

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <!-- 1.引入vue.js文件 -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
</head>

<body>
    <!-- 模板 -->
    <div id="app">
        <h1>欢迎学习Vue.js</h1>
        <div>我叫{{name}}，微信{{wechat}}</div>

        <input type="button" value="点我" @click="clickMe">
    </div>

    <script>
        // 2.创建Vue实例，并且让vm与HTML中的容器进行关联
        let vm = new Vue({
            el: "#app",
            // data是给模板提供数据
            data: {
                name: "wc",
                wechat: "8764567765"
            },
            methods: {
                clickMe() {
                    this.name = "malu";
                    this.wechat = "66666666"
                }
            },
        });
    </script>
</body>

</html>
```

总结一下：

* vue的思想：数据驱动视图
* data  定义响应式数据，所谓的响应式，就是数据变了，视图会自动刷新
* el  让vm实例与某个容器进行关联
* methods   是专门用于定义函数方法的地方

## 二，Vue常见指令

vue中基本上不会再手动操作DOM，vue作者就帮我们封装了很多的指令。什么是指令？就是vue内置的一套“模板（都是以v-），用于在视图节点上动态绑定变量（表达式）的。**指令实际上是DOM功能的抽象，所以指令实际上也是DOM操作。**

**指令分类：**

* 文本相关的指令
* 属性绑定相关的指令
* 事件绑定相关的指令
* 表单相关的指令
* 列表渲染相关的指令
* 条件渲染相关的指令
* 其它指令
* 自定义指令

### 1，文本相关的指令

```html
下面的是文本相关的指令：

- {{}}文本插值、v-text、v-once、v-cloak、v-html
- {{}} 用于绑定节点的文本，它和v-text功能是一样的。区别是{{}}这种绑定值的方式会出现“{{}}一闪而过”的效果，建议使用v-cloak来解决。
- v-text 用于绑定节点的文件，在大多数时候，它和 {{}} 可以相互替换。
- v-once 用于指定节点的动态内容只绑定一次。当前节点中所对应的变量发生变化，视图不更新。一般情况下，v-once只能和{{}}一起用。
- v-once 和 v-cloak 都是不需要接收表达式来做为“值”
- v-html 用于绑定动态的html节点，相当于DOM中的 innerHTML。这个指令默认已经做了“防注入攻击XSS”的处理
```

代码演示：

![1697075930360](./assets/1697075930360.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <style>
        [v-cloak] {
            display: none;
        }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <div>
            <!-- {{}} 小胡子语法仅仅是v-text指令的语法糖 -->
            <h2 v-cloak>{{name}}</h2>
            <!-- v-text "name" 不是字符串，不是字符串，不是字符串 -->
            <!-- 是表达式，后面看到"" 里面放的是表达式 -->
            <h2 v-text="name"></h2>
            <h2 v-text=" '年龄：' + age "></h2>
            <h2 v-text=" `年龄：${age}` "></h2>
            <h2 v-cloak>{{'年龄：' +age}}</h2>
            <div v-text="msg"></div>
            <div v-html="msg"></div>
            <h2 v-once>{{age}}</h2>
            <button @click="changeAage">改变age</button>
        </div>
    </div>
    <script>
        // setTimeout(() => {
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    name: "码路",
                    age: 18,
                    msg: `<a href="http://www.baidu.com">百度一下</a>`,
                }
            },
            methods: {
                changeAage() {
                    this.age++
                }
            }
        });
        // }, 2000);
    </script>
</body>

</html>
```

### 2，属性绑定相关的指令

```html
- v-bind 用于动态绑定节点的属性（比如title、value、class、style等）
- v-bind 用得非常多，所以经常简写成 : &lt; div :id='变量'>&lt; /div>
- 动态class语法（一）：&lt; div :class='`${变量1} ${变量2} `'>&lt; /div>
- 动态class语法（二）：&lt; div :class='[表达式1, 表达式2, ...]'>&lt; /div>
- 动态class语法（三）：&lt; div :class='{ 类名1: 布尔值1, 类名2: 布尔值2, ... }'>&lt; /div>
- 动态style语法（一）：&lt; div :style='`color:red;fontSize:20px`'>&lt; /div>
- 动态style语法（二）：&lt; div :style='[{css键值对}, {css键值对}, ...]'>&lt; /div>
- 动态style语法（三）：&lt; div :style='{css键值对}'>&lt; /div>
```

绑定普通的属性，代码如下：

![1697078074924](./assets/1697078074924.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <h1 title="haha">我是一个孤独的h2</h1>
        <!-- 一个指令后面的""中放的是表达式 -->
        <h1 v-bind:title="a1">我是一个孤独的h2</h1>
        <h1 :title="a1">我是一个孤独的h2</h1>
        <h1 v-bind="{title:a1,class:a2}">我是一个孤独的h2</h1>

        <img :src="imgUrl" alt="">
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    a1: 'ok',
                    a2: 'bad',
                    imgUrl: "https://img0.baidu.com/it/u=1732521231,1421026517&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1697216400&t=407e58ecae68be0e0bbf7d27ac586278",
                }
            },
            methods: {}
        });
    </script>
</body>

</html>
```

绑定class属性，如下：

![1697078618827](./assets/1697078618827.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <h1 class="box">绑定class属性</h1>
        <h1 :class="a1">绑定class属性</h1>
        <h1 :class=" `${a1} ${a2}` ">绑定class属性</h1>
        <h1 :class=" [a1,a2] ">绑定class属性</h1>
        <h1 :class=" [ 1==1 ? a1 : a2 ] ">绑定class属性1111</h1>
        <h1 :class=" {box1:true,box2:true} ">绑定class属性</h1>
        <h1 :class=" obj ">绑定class属性</h1>
        <h1 :class=" {f1:Math.random()>0.5} ">绑定class属性</h1>
        <h1 :class=" {f1:110} ">绑定class属性</h1>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    a1: "info",
                    a2: "danger",
                    clr: "red",
                    size: "19",
                    obj: {
                        box3: true,
                        box4: true
                    }
                }
            },
            methods: {}
        })
    </script>
</body>

</html>
```

还有一个比较特殊，绑定style，如下：

![1697079234029](./assets/1697079234029.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <!-- v-bind是单向绑定：把JS中的数据绑定到HTML上。  修改JS中的响应式数据，HTML也会修改。 -->
        <h1 style="color: red; background-color: pink;">绑定行内样式</h1>
        <h1 :style=" `color:yellowgreen; background-color: pink;` ">绑定行内样式</h1>
        <h1 :style=" `color:${a1}; background-color: ${a2};` ">绑定行内样式</h1>
        <h1 :style=" {color:a2,fontSize:fs+'px'} ">绑定行内样式</h1>
        <h1 :style=" [{color:'red'},{fontSize:fs+'px'},{textDecoration:'line-through'}] ">绑定行内样式</h1>
        <h1 :style=" {[a3]:a1} ">绑定行内样式</h1>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    a1: 'blue',
                    a2: 'gold',
                    fs: "46",
                    a3: 'color'
                }
            },
            methods: {}
        });
    </script>
</body>

</html>
```

### 3，事件绑定相关的指令

```html
- v-on 用于给视图节点绑定各种JS事件，比如click、mouseenter、blur、keyup等
- v-on:click
- v-on:dblclick
- v-on:mouseover，
- v-on:mouseout，
- v-on:change
- v-on:focus
- ...
- v-on 用得非常多, 所以简写成 @ 基本语法: div @事件名. 事件修饰符='事件处理器'
- v-on 上可以使用事件修饰符: .stop阻止冒泡 .prevent阻止默认事件 .enter绑定键盘Enter键盘....
```

直接上代码：

![1697079951910](./assets/1697079951910.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <style>
        .outer {
            width: 200px;
            height: 200px;
            background-color: gold;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .inner {
            width: 100px;
            height: 100px;
            background-color: skyblue;
        }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <button v-on:click="handle">点我</button>
        <button @click="handle">点我</button>

        <!-- 事件相关的修饰符  stop 阻止事件冒泡 -->
        <!-- prevent 阻止默认事件 -->
        <!-- once 只绑定一次 -->
        <!-- 事件修饰符可以连用 -->
        <div class="outer" @click="outerClick">
            <div class="inner" @click.stop.once="innerClick"></div>
        </div>

        <button @click="fn">点我</button>
        <button @click="gn(1,2)">点我</button>
        <!-- 手动的把事件对象传递下面，在模板中有一个$event表示事件对象 -->
        <button @click="kn(1,2,$event)">点我</button>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    // 方法写在data中，也行，不建议
                }
            },
            methods: {
                handle() {
                    console.log("handle...");
                },
                outerClick() {
                    console.log("outerClick...");
                },
                innerClick() {
                    console.log("innerClick...");
                },
                fn(e) {
                    console.log("e:", e);
                },
                gn(a, b) {
                    console.log(a, b);
                },
                kn(a, b, e) {
                    console.log(a, b, e);
                }
            }
        });
    </script>
</body>

</html>
```

### 4，表单相关的指令(v-model)

```html
一般用于在交互的表中中使用，例如：input、select、textarea等。【双向绑定】

- v-model 用于表单取值(表单双向绑定), 比如input/select/textarea等
- 基本语法: input type="text" v-model. 表单修饰符='变量'
- 三个修饰符: .trim自动去除文本首尾空格 .number隐式类型转换变成Number类型 .lazy用于性能, 当表单失焦时再进行双向绑定
- v-model 还有更深的理解, 在组件化中进一步去理解
```

先简单的使用一个v-mdole，如下：

![1697081069123](./assets/1697081069123.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <!-- 姓名：<input type="text" :value="name" @input="fn"> <br> -->

        <!-- 如果方法中只有一行代码，可以把代码直接写在模板中 -->
        <!-- 姓名：<input type="text" :value="name" @input="name = $event.target.value"> <br> -->

        <!-- v-model写在标签上，等价于:value + @input -->
        <!-- 姓名：<input type="text" v-model="name"> <br> -->

        <!-- v-model都有哪些修饰符？答：number trim lazy -->
        <input type="text" v-model.trim="name" @keyup.enter="submit">
        <input type="text" v-model.number="age" @keyup.enter="submit">
        <h1>{{age}}</h1>
        <!-- v-model是双向绑定 默认情况下，v-model等价于： :value+@input-->
        <input type="text" v-model="age" @keyup.enter="submit">
        <!-- lazy 就可以把input事件，变成change事件 -->
        <input type="text" v-model.lazy="age" @keyup.enter="submit">
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    name: "码路",
                    age: 18
                }
            },
            methods: {
                submit(e) {
                    // console.log(this.name);
                    console.log(this.age);
                    // console.log(e.target.value);
                },
                fn(e) {
                    // console.log(e.target.value);
                    this.name = e.target.value;
                }
            }
        });
    </script>
</body>

</html>
```

回顾一下上午的v-model，如下：

![1697090955674](./assets/1697090955674.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <div>
            用户名：<input type="text" v-model="user">
        </div>
        <div>
            密码：<input type="password" v-model="pwd">
        </div>
        <input type="button" value="登录" v-on:click="clickMe" />
        <input type="button" value="重置" v-on:click="resetForm" />
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    user: "",
                    pwd: ""
                }
            },
            methods: {
                clickMe() {
                    console.log(this.user, this.pwd);
                },
                resetForm() {
                    this.user = "";
                    this.pwd = "";
                }
            }
        });
    </script>
</body>

</html>
```

v-model收集其它数据，如下：

![1697091573012](./assets/1697091573012.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <div>
            用户名：<input type="text" v-model="user">
        </div>
        <div>
            密码：<input type="password" v-model="pwd">
        </div>
        <div>
            性别：
            <input type="radio" name="s" v-model="sex" value="1" /> 男
            <input type="radio" name="s" v-model="sex" value="2" /> 女
        </div>
        <div>
            爱好：
            <input type="checkbox" value="11" v-model="hobby"> 篮球1
            <input type="checkbox" value="22" v-model="hobby"> 篮球2
            <input type="checkbox" value="33" v-model="hobby"> 篮球3
        </div>
        <div>
            城市：
            <select v-model="city">
                <option value="sh">上海</option>
                <option value="bj">北京</option>
                <option value="sz">深圳</option>
            </select>
        </div>
        <div>
            部门：
            <select v-model="dept" multiple>
                <option value="js">技术</option>
                <option value="xs">销售</option>
                <option value="yy">运营</option>
            </select>
        </div>
        <div>
            其他：<textarea v-model="more"></textarea>
        </div>
        <input type="button" value="登录" v-on:click="clickMe" />
        <input type="button" value="重置" v-on:click="resetForm" />
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    user: "",
                    pwd: "",
                    sex: "1",
                    hobby: [],
                    city: "sz",
                    dept: [],
                    more: "..."
                }
            },
            methods: {
                clickMe() {
                    console.log(this.user, this.pwd, this.sex, this.hobby, this.city, this.dept, this.more);
                },
                resetForm() {
                    this.user = "";
                    this.pwd = "";
                }
            }
        });
    </script>
</body>

</html>
```

上面每一个响应式数据，都是独立的，可以把这些响应式数据放到对象，如下：

![1697091760790](./assets/1697091760790.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <div>
            用户名：<input type="text" v-model="info.user">
        </div>
        <div>
            密码：<input type="password" v-model="info.pwd">
        </div>
        <div>
            性别：
            <input type="radio" name="s" v-model="info.sex" value="1" /> 男
            <input type="radio" name="s" v-model="info.sex" value="2" /> 女
        </div>
        <div>
            爱好：
            <input type="checkbox" value="11" v-model="info.hobby"> 篮球1
            <input type="checkbox" value="22" v-model="info.hobby"> 篮球2
            <input type="checkbox" value="33" v-model="info.hobby"> 篮球3
        </div>
        <div>
            城市：
            <select v-model="info.city">
                <option value="sh">上海</option>
                <option value="bj">北京</option>
                <option value="sz">深圳</option>
            </select>
        </div>
        <div>
            部门：
            <select v-model="info.dept" multiple>
                <option value="js">技术</option>
                <option value="xs">销售</option>
                <option value="yy">运营</option>
            </select>
        </div>
        <div>
            其他：<textarea v-model="info.more"></textarea>
        </div>
        <input type="button" value="登录" v-on:click="clickMe" />
        <input type="button" value="重置" v-on:click="resetForm" />
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    info: {
                        user: "",
                        pwd: "",
                        sex: "1",
                        hobby: [],
                        city: "sz",
                        dept: [],
                        more: "..."
                    }
                }
            },
            methods: {
                clickMe() {
                    console.log(this.info.user, this.info.pwd, this.info.sex, this.info.hobby, this.info.city, this.info.dept, this.info.more);
                },
                resetForm() {
                    this.user = "";
                    this.pwd = "";
                }
            }
        });
    </script>
</body>

</html>
```

### 5，列表渲染相关的指令

```html
* v-for 用于渲染数月、对象、Number变量等等
* 当 v-for 渲染列表时, 语法是这样的 <div v-for='(item, index) in array'></div>
* 当 v-for 渲染对象时, 语法是这样的 <div v-for='(value, key, index) in obj'></div>
* 当 v-for 渲染Number变量时, 语法是这样的 <div v-for='(num, index) in 5'></div>
* 注意: v-for在循环渲染时要求加key, 为什么呢? 在响应式原理时再解释
```

上代码演示，循环数组，如下：

![1697092402425](./assets/1697092402425.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <!-- v-for循环一个数组 -->
        <div v-for="(item,index) in todolist" :style="{background:(item.done ? 'red':'transparent')}">
            <input type="checkbox" :checked="item.done" @click="fn(item,index)">
            <span>{{item.text}}</span>
            <span>x</span>
        </div>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    todolist: [{
                            id: 1,
                            text: "学习vue1",
                            done: true
                        },
                        {
                            id: 2,
                            text: "学习vue2",
                            done: false
                        },
                        {
                            id: 3,
                            text: "学习vue3",
                            done: false
                        },
                    ],
                }
            },
            methods: {
                fn(item, index) {
                    this.todolist[index].done = !this.todolist[index].done
                }
            }
        });
    </script>
</body>

</html>
```

v-for也可以循环一个对象，如下：

![1697092516483](./assets/1697092516483.png)

也可以循环一个数字，如下：

![1697092572248](./assets/1697092572248.png)

### 6，案例：数据管理案例

数据的管理包括对数据：展示、动态添加、删除、修改。  

先实现展示：

![1697092768942](./assets/1697092768942.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <style>
        .penal {
            border: 1px solid #dddddd;
            margin: 20px 0 0 0;
            padding: 10px;
            border-bottom: 0;
            background-color: #d9d9d9;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            border-spacing: 0;
        }

        .table>tbody>tr>td,
        .table>tbody>tr>th,
        .table>tfoot>tr>td,
        .table>tfoot>tr>th,
        .table>thead>tr>td,
        .table>thead>tr>th {
            padding: 8px;
            vertical-align: top;
            border: 1px solid #ddd;
            text-align: left;
        }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <h3 class="penal">数据列表</h3>
        <table class="table">
            <thead>
                <tr>
                    <td>姓名</td>
                    <td>年龄</td>
                </tr>
            </thead>
            <tbody>
                <tr v-for="(item,index) in dataList">
                    <td>{{item.name}}</td>
                    <td>{{item.age}}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    dataList: [{
                            name: "malu",
                            age: 18
                        },
                        {
                            name: "wc",
                            age: 28
                        },
                    ]
                }
            },
            methods: {}
        });
    </script>
</body>

</html>
```

要实现添加，要通过表单进行添加，就是收集表单中的数据，就要用到v-model，代码如下：

![1697093057087](./assets/1697093057087.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <style>
        .penal {
            border: 1px solid #dddddd;
            margin: 20px 0 0 0;
            padding: 10px;
            border-bottom: 0;
            background-color: #d9d9d9;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            border-spacing: 0;
        }

        .table>tbody>tr>td,
        .table>tbody>tr>th,
        .table>tfoot>tr>td,
        .table>tfoot>tr>th,
        .table>thead>tr>td,
        .table>thead>tr>th {
            padding: 8px;
            vertical-align: top;
            border: 1px solid #ddd;
            text-align: left;
        }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <h3 class="penal">表单区域</h3>
        <div>
            <div>
                <label>姓名</label>
                <input type="text" v-model="user">
            </div>
            <div>
                <label>年龄</label>
                <input type="text" v-model="age">
                <input type="button" value="新增" @click="addUser">
            </div>
        </div>
        <h3 class="penal">数据列表</h3>
        <table class="table">
            <thead>
                <tr>
                    <td>姓名</td>
                    <td>年龄</td>
                </tr>
            </thead>
            <tbody>
                <tr v-for="(item,index) in dataList">
                    <td>{{item.name}}</td>
                    <td>{{item.age}}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    dataList: [{
                            name: "malu",
                            age: 18
                        },
                        {
                            name: "wc",
                            age: 28
                        },
                    ],
                    user: "",
                    age: ""
                }
            },
            methods: {
                addUser() {
                    let row = {
                        name: this.user,
                        age: this.age
                    };
                    console.log(row);
                    this.dataList.push(row);
                    this.user = "";
                    this.age = "";
                }
            }
        });
    </script>
</body>

</html>
```

要实现删除，如下：

![1697093409974](./assets/1697093409974.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <style>
        .penal {
            border: 1px solid #dddddd;
            margin: 20px 0 0 0;
            padding: 10px;
            border-bottom: 0;
            background-color: #d9d9d9;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            border-spacing: 0;
        }

        .table>tbody>tr>td,
        .table>tbody>tr>th,
        .table>tfoot>tr>td,
        .table>tfoot>tr>th,
        .table>thead>tr>td,
        .table>thead>tr>th {
            padding: 8px;
            vertical-align: top;
            border: 1px solid #ddd;
            text-align: left;
        }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <h3 class="penal">表单区域</h3>
        <div>
            <div>
                <label>姓名</label>
                <input type="text" v-model="user">
            </div>
            <div>
                <label>年龄</label>
                <input type="text" v-model="age">
                <input type="button" value="新增" @click="addUser">
            </div>
        </div>
        <h3 class="penal">数据列表</h3>
        <table class="table">
            <thead>
                <tr>
                    <td>姓名</td>
                    <td>年龄</td>
                </tr>
            </thead>
            <tbody>
                <tr v-for="(item,index) in dataList">
                    <td>{{item.name}}</td>
                    <td>{{item.age}}</td>
                    <td>
                        <!-- <input type="button" value="删除" @click="delRow(index)"> -->
                        <input type="button" value="删除" @click="delRow" :data-idx="index">
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    dataList: [{
                            name: "malu",
                            age: 18
                        },
                        {
                            name: "wc",
                            age: 28
                        },
                    ],
                    user: "",
                    age: ""
                }
            },
            methods: {
                addUser() {
                    let row = {
                        name: this.user,
                        age: this.age
                    };
                    console.log(row);
                    this.dataList.push(row);
                    this.user = "";
                    this.age = "";
                },
                // delRow(index){
                delRow(e) {
                    // this.dataList.splice(index,1)

                    console.log(e.target.dataset.idx);
                    let idx = e.target.dataset.idx
                    this.dataList.splice(idx, 1)
                }
            }
        });
    </script>
</body>

</html>
```

最后，要实现编辑（修改），如下：

![1697093951389](./assets/1697093951389.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <style>
        .penal {
            border: 1px solid #dddddd;
            margin: 20px 0 0 0;
            padding: 10px;
            border-bottom: 0;
            background-color: #d9d9d9;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            border-spacing: 0;
        }

        .table>tbody>tr>td,
        .table>tbody>tr>th,
        .table>tfoot>tr>td,
        .table>tfoot>tr>th,
        .table>thead>tr>td,
        .table>thead>tr>th {
            padding: 8px;
            vertical-align: top;
            border: 1px solid #ddd;
            text-align: left;
        }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <h3 class="penal">表单区域</h3>
        <div>
            <div>
                <label>姓名</label>
                <input type="text" v-model="user">
            </div>
            <div>
                <label>年龄</label>
                <input type="text" v-model="age">
                <input type="button" :value="title" @click="addUser">
            </div>
        </div>
        <h3 class="penal">数据列表</h3>
        <table class="table">
            <thead>
                <tr>
                    <td>姓名</td>
                    <td>年龄</td>
                </tr>
            </thead>
            <tbody>
                <tr v-for="(item,index) in dataList">
                    <td>{{item.name}}</td>
                    <td>{{item.age}}</td>
                    <td>
                        <!-- <input type="button" value="删除" @click="delRow(index)"> -->
                        <input type="button" value="删除" @click="delRow" :data-idx="index">
                        <input type="button" value="编辑" @click="editRow" :data-idx="index">
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    dataList: [{
                            name: "malu",
                            age: 18
                        },
                        {
                            name: "wc",
                            age: 28
                        },
                    ],
                    user: "",
                    age: "",
                    title: "新增",
                    editIndex: undefined
                }
            },
            methods: {
                addUser() {
                    if (this.editIndex) {
                        // 编辑
                        this.dataList[this.editIndex].name = this.user;
                        this.dataList[this.editIndex].age = this.age;
                    } else {
                        // 新增
                        let row = {
                            name: this.user,
                            age: this.age
                        };
                        console.log(row);
                        this.dataList.push(row);
                    }
                    this.editIndex = undefined;
                    this.title = "新增"
                    this.user = "";
                    this.age = "";

                },
                // delRow(index){
                delRow(e) {
                    // this.dataList.splice(index,1)

                    console.log(e.target.dataset.idx);
                    let idx = e.target.dataset.idx
                    this.dataList.splice(idx, 1)
                },
                editRow(e) {
                    let idx = e.target.dataset.idx;
                    let {
                        name,
                        age
                    } = this.dataList[idx];
                    this.user = name;
                    this.age = age;

                    this.title = "编辑";
                    this.editIndex = idx;
                }
            }
        });
    </script>
</body>

</html>
```

### 7，条件渲染相关的指令

```text
* v-show 用于显示或隐藏视图节点, 背后使用的 display: 原本的显示模式 / display:none 来实现的
* v-if / v-else-if / v-else 用于显示或隐藏视图节点, 背后是真正地移除或插入视图节点
* v-if 因为是节点插入或移除, 比较耗费性能; v-show只是通过样式来实现显示与隐藏, 性能开销更小.
* v-if, 不建议和 v-for 一起使用; 如果一定要在同一个节点上使用v-if和v-for, v-for优先级更好
```

对于v-if，直接上代码：

![1697094899822](./assets/1697094899822.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <!-- v-if 控制元素的创建或销毁-->
        <div v-if="isShow">我是一个孤独的DIV</div>

        <hr>

        <h1 v-if="row == 1">我是第一行</h1>
        <h2 v-else-if="row==2">我是第二行</h2>
        <h3 v-else-if="row==3">我是第三行</h3>
        <h4 v-else>我是第四行</h4>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    isShow: true,
                    row: 1
                }
            },
            methods: {}
        });
    </script>
</body>

</html>
```

做一个小案例，如下：

![1697095201525](./assets/1697095201525.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <input type="button" value="密码登录" @click="isSms = false" />
        <input type="button" value="短信登录" @click="isSms = true" />

        <div v-if="isSms">
            <p>
                <label>手机号</label>
                <input type="text" placeholder="手机号">
            </p>
            <p>
                <label>验证码</label>
                <input type="text" placeholder="验证码">
            </p>
        </div>
        <div v-else>
            <p>
                <label>用户名</label>
                <input type="text" placeholder="用户名">
            </p>
            <p>
                <label>密码</label>
                <input type="password" placeholder="密码">
            </p>
        </div>

    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    isSms: false
                }
            },
            methods: {}
        });
    </script>
</body>

</html>
```

对于条件渲染，还有一个指令，叫v-show，它也可以控制元素的显示与隐藏，前面讲的v-if是控制元素的创建或销毁。v-show是控制元素的显示与隐藏，是通过样式来控制，元素是已经创建，代码：

![1697095354853](./assets/1697095354853.png)

### 8，案例：小练习

练习一：

![1697095528869](./assets/1697095528869.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        ul {
            width: 150px;
            list-style-type: none;
            background-color: gold;
        }

        li {
            width: 100%;
            height: 50px;
            text-align: center;
            line-height: 50px;
            border-bottom: 1px solid white;
            color: red;
        }

        .active {
            background-color: skyblue;
        }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <ul>
            <li v-for="(item,index) in list" @click="fn(index)" :class="{active:currentIndex == index}">
                {{item.title}} -- {{index}}
            </li>
        </ul>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    currentIndex: -1,
                    list: [{
                            id: 1001,
                            title: '母婴'
                        },
                        {
                            id: 1002,
                            title: '家电'
                        },
                        {
                            id: 1003,
                            title: '医用'
                        },
                        {
                            id: 1004,
                            title: '手机'
                        },
                        {
                            id: 1005,
                            title: '直播'
                        },
                        {
                            id: 1006,
                            title: '游戏'
                        },
                        {
                            id: 1007,
                            title: '酒水'
                        },
                        {
                            id: 1008,
                            title: '娱乐'
                        },
                        {
                            id: 1009,
                            title: '美食'
                        },
                        {
                            id: 1010,
                            title: '财经'
                        }
                    ],
                }
            },
            methods: {
                fn(idx) {
                    console.log(idx);
                    this.currentIndex = idx;
                }
            }
        })
    </script>
</body>

</html>
```

练习二：

![1697095598808](./assets/1697095598808.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <button @click="fs+=5">点击放大P标签中的字体大小</button>
        <p :style="{fontSize:fs+'px'}">任何人都应当有自尊心，自信心，独立性，不然就是奴才</p>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    fs: 16
                }
            },
            methods: {}
        });
    </script>
</body>

</html>
```

练习三：

![1697095660020](./assets/1697095660020.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        .box {
            width: 400px;
            height: 200px;
            background-color: #000;
        }

        input {
            margin: 10px 0px;
        }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <div class="box" :style="{background:`rgb(${r},${g},${b})`}"></div>
        <p>
            R: <input type="range" v-model.number="r" min="0" max="255"> <span>{{r}}</span>
        </p>
        <p>
            G: <input type="range" min="0" max="255" v-model.number="g"><span>{{g}}</span>
        </p>
        <p>
            B: <input type="range" min="0" max="255" v-model.number="b"><span>{{b}}</span>
        </p>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    r: 0,
                    g: 0,
                    b: 0
                }
            },
            methods: {}
        });
    </script>
</body>

</html>
```

练习四：

![1697095726443](./assets/1697095726443.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        .tab-box {
            /* background-color: pink; */
            width: 300px;
            margin: 20px auto;
            box-sizing: border-box;
        }

        .tab-box .tab {
            display: flex;
            position: relative;
            top: 1px;
        }

        .tab-box .tab li {
            list-style: none;
            border: 1px solid #ddd;
            padding: 5px 10px;
            margin-right: 10px;
            background: #eee;
        }

        .tab-box .tab li.active {
            color: lightcoral;
            background-color: #fff;
            border-bottom-color: #fff;
        }

        .tab-box .con {
            display: none;
            box-sizing: border-box;
            padding: 10px;
            height: 100px;
            border: 1px solid #ddd;
        }

        .tab-box .con.active {
            display: block;
        }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app' class="tab-box">
        <ul class="tab">
            <li v-for="(item,index) in list" :class="{active:selected == index}" @click="change(index)">
                {{item.title}}
            </li>
        </ul>
        <div v-for="(item,index) in list" class="con" :class="{active:selected == index}">
            {{item.content}}
        </div>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    list: [{
                            id: 1,
                            title: "音乐",
                            content: "成都-赵雷"
                        },
                        {
                            id: 2,
                            title: "电影",
                            content: "新蝙蝠侠"
                        },
                        {
                            id: 3,
                            title: "电视剧",
                            content: "甄嬛传"
                        },
                    ],
                    selected: 0
                }
            },
            methods: {
                change(idx) {
                    if (idx == this.selected) return;
                    this.selected = idx;
                }
            }
        });
    </script>
</body>

</html>
```

### 9，面试题

* vue核心思想是？
  + 数据驱动视图
* 常用的vue指令都有些？你是怎么理解指令？
  + 文本节点处理的指令   v-text  v-html  {{}}  v-cloak
  + 动态属性绑定指令   v-bind  简写成冒号   动态绑定class  动态绑定style    单向绑定
  + 事件绑定指令   v-on  v-once  简写成@  事件冒泡  事件对象  事件修饰符  按键修饰符  
  + 表单相关的指令  v-model   目的是为了收集表单数据  收集完毕，发ajax请求，把数据扔给服务器
  + 列表渲染  v-for 写在哪个标签上，就循环出多少个这样的标签。可以循环数组，对象，整数。
  + 条件渲染  v-if   v-else-if  v-else     v-show 
  + 其它：v-slot  插槽，后面讲     v-pre 用于调试的.....
  + 自定义指令：上面的指令是内置的指令，除了内置指令，我们也可以自定义指令。后面讲。
  + 指令本质就是对DOM的抽象和封装。之前DOM操作，不同的的人写出的代码，差别很多。指令可以让我们更加规范的操作DOM。使用指令，大家写的代码都差不多。
* 什么是单向数据绑定，什么是双向数据绑定？
  + 单向绑定，修改响应式数据，模板会发生更新。  或者修改了JS，更新了HTML。
  + 双向绑定，一向是修改了响应式数据，模板会发生更新。另一向是修改了模板，响应式数据也会更新。
  + 单向绑定：v-bind   v-text  v-html  {{}}
  + 双向绑定：v-model    也可以使用:value + @input
* v-if和v-show有什么区别？
  + v-if是控制元素（标签，也可以是组件）的创建或销毁，消耗性能大一点。
  + v-show是控制样式，来实现元素的显示或隐藏。通过display属性。消耗性能小一点。
  + 当需要频繁控制元素的显示或隐藏，使用v-show。在vue2中，v-if不能和v-for连用。因为在vue2中v-for的优先级更高。
  + 其它....
* 文本插值有“{{}}一闪而过”问题，怎么处理？
  + 使用v-text
  + 使用v-cloak，还需要配合css
* v-for 可以循环哪些数据类型？v-for列表渲染时为什么加key？
  + 可以循环数组，在项目中最重要就是循环数组，数组这个数据来自ajax请求。
  + 可以循环对象，循环对象，可以对象键，值，索引
  + 可以循环整数
  + v-for，需要加一个key，为什么，后面讲。
* v-model 有哪些修饰符？
  + .trim  收集数据时，去掉左右的空格
  + .number 收集数据时，数据是123abc，收集到的是123
  + .lazy  当失去焦点时，再去收集数据
* vue 中怎么阻止冒泡？怎么阻止默认事件？怎么监听键盘enter键？
  + 通过事件修饰符，或事件对象可以阻止冒泡，也可以阻止默认事件。
  + @keyup.enter = ""  .enter叫按键修饰符，还可以通过事件对象。

### 10，案例：登录

![1697162634192](./assets/1697162634192.png)

这个案例，需要调用接口，接口，我下去，找一个登录接口。我们需要用axios发请求了。

### 11，一些免费的API接口

* https://jsonplaceholder.typicode.com/
* https://reqres.in/
* https://picsum.photos/
* https://dog.ceo/dog-api/
* https://thecatapi.com/

## 三，计算属性

### 1，什么是计算属性

vue2是基于选项式API开发项目，前面我们学习了3个选项：el，data，methods。其实还非常多的选项，再去学习一个选项，叫computed。计算属性是对已有数据再加工，得到一个新的数据，在模板中可以直接使用计算属性。在方法中，也可以通过this来获取计算属性，作用：

* 作用1：当指令的表达式比较复杂时，我们建议使用计算属性来优化，提升视图模板中代码的可阅读性、可维护性。
* 作用2：用于缓存一个复杂的运算，避免组件更新时产生没有必要的性能损耗。计算属性本质上是一个函数，Vue会分析函数体中使用到了哪些声明式变量，有且仅有这些声明式变量发生变化时，计算属性才会重新执行。

直接上代码：

![1697165536020](./assets/1697165536020.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <!-- 在胡子中做了复杂计算 -->
        <h2>{{ "总价$:"+ (num*price).toFixed(2) }}</h2>
        <!-- 虽然在定义时，把计算属性定义成函数，但是在模板中使用时，当成了普通的数据 -->
        <h2 v-text="total"></h2>
        <h2 v-text="total2"></h2>
        <h2 v-text="total3"></h2>
        <button @click="btnClick">修改</button>
        <hr>
        firstName: <input type="text" v-model="firstname">
        lastname: <input type="text" v-model="lastname"> <br>
        全名：<input type="text" disabled :value="firstname+lastname"> <br>
        全名：<input type="text" :value="fullname" @change="fn"> <br>
        <!--  v-model后面可以跟一个计算属性 -->
        <!-- 为什么v-model后面可以跟一个计算属性? -->
        <!-- 答: 原因是计算属性有setter -->
        <!-- 计算属性中不能写异步代码 -->
        全名：<input type="text" v-model.lazy="fullname"> <br>

    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    num: 10,
                    price: 100,
                    msg: "hello vue",
                    firstname: "",
                    lastname: ""
                }
            },
            computed: {
                // 一般情况下，计算属性会写成函数的形式
                // 函数返回值，计算属性的值就是什么
                // 此时，tatal这个计算属性有data有关系，计算属性是由data中的状态计算而来的
                total() {
                    let t = (this.num * this.price).toFixed(2);
                    return '总价:$' + t
                },
                // 计算属性也可以和data没有任何关系
                total2() {
                    return "666"
                },
                // 计算属性还可以写在对象的形式
                // 在模板中使用计算属性时，会自动调用get
                // get的返回值就是计算属性的值
                total3: {
                    get() {
                        console.log("get...");
                        return this.msg
                    },
                    // 当修改计算属性时，就会走set
                    // 在修改时，会把新值传递给val
                    set(val) {
                        console.log("set...");
                        this.msg = val;
                    }
                },
                fullname: {
                    get() {
                        return this.firstname + "." + this.lastname
                    },
                    set(val) {
                        console.log("val:", val);
                        let arr = val.split(".")
                        this.firstname = arr[0]
                        this.lastname = arr[1]
                    }
                }
            },

            methods: {
                btnClick() {
                    this.total3 = "hi vue"
                },
                fn(e) {
                    let arr = e.target.value.split(".");
                    console.log(arr);
                    this.firstname = arr[0]
                    this.lastname = arr[1]
                }
            }
        });
    </script>
</body>

</html>
```

计算属性还有缓存的功能，代码如下：

![1697166011257](./assets/1697166011257.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <div>
            <h2>全名(胡子中计算)：{{firstname+lastname}}</h2>
            firstName: <input type="text" v-model="firstname">
            lastname: <input type="text" v-model="lastname">
        </div>
        <hr>
        <div>
            <h2>全名(函数调用)：{{fullname()}}</h2>
            <h2>全名(函数调用)：{{fullname()}}</h2>
            <h2>全名(函数调用)：{{fullname()}}</h2>
            firstName: <input type="text" v-model="firstname">
            lastname: <input type="text" v-model="lastname">
        </div>
        <hr>
        <div>
            <!-- 第一个肯定要计算，计算的结果会缓存起来 -->
            <!-- 后面如果依赖的数据没有变化，直接从缓存中获取结果，不会重新计算，性能高 -->
            <!-- 在项目中，能使用计算属性的，尽可能使用计算属性，使用计算属性能使用的，使用方法也可以使用 -->
            <h2>全名(计算属性)：{{fullname2}}</h2>
            <h2>全名(计算属性)：{{fullname2}}</h2>
            <h2>全名(计算属性)：{{fullname2}}</h2>
            firstName: <input type="text" v-model="firstname">
            lastname: <input type="text" v-model="lastname">
        </div>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    firstname: "",
                    lastname: ""
                }
            },
            computed: {
                fullname2() {
                    console.log("计算属性...");
                    return this.firstname + this.lastname;
                }
            },
            methods: {
                fullname() {
                    console.log("函数调用了...");
                    return this.firstname + this.lastname
                }
            }
        });
    </script>
</body>

</html>
```

### 2，面试题

* 计算属性有什么作用？（两大作用）
  + 作用1：把胡子语法中复杂的计算逻辑，封装到一个计算属性中。
  + 作用2：第1次计算的缓存，会被缓存起来，如果依赖的数据没有发生变化，直接从缓存中获取结果。
* 计算属性能不能绑定在v-model上？
  + 可以，因为计算属性不只有get，还有set。
* 怎么理解计算属性的缓存功能？
  + 有且仅有被关联的声明式变量变化时，计算属性才会重新计算。

### 3，案例：购物车

![1697166874439](./assets/1697166874439.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        table,
        tr,
        td {
            border: 1px solid skyblue;
            border-collapse: collapse;
        }

        td {
            width: 150px;
            height: 50px;
            text-align: center;
            line-height: 50px;
        }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <table>
            <tr>
                <th>商品名称</th>
                <th>单价</th>
                <th>数量</th>
                <th>总价</th>
            </tr>
            <tr v-for="(item,index) in cart">
                <td>{{item.title}}</td>
                <td>{{item.price}}</td>
                <td>
                    <button @click="minus(item)">减一</button>
                    {{item.count}}
                    <button @click="add(item)">加一</button>
                </td>
                <td>{{ item.price * item.count }}</td>
            </tr>
        </table>
        <h2>所有商品总价：{{total}}</h2>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    cart: [{
                            id: 1,
                            title: "手机",
                            price: 1999,
                            count: 1
                        },
                        {
                            id: 2,
                            title: "电脑",
                            price: 9992,
                            count: 1
                        },
                        {
                            id: 3,
                            title: "衣服",
                            price: 29,
                            count: 1
                        },
                        {
                            id: 4,
                            title: "洗衣机",
                            price: 5321,
                            count: 1
                        },
                        {
                            id: 5,
                            title: "篮球",
                            price: 19,
                            count: 1
                        },
                        {
                            id: 6,
                            title: "球杆",
                            price: 2999,
                            count: 1
                        },
                    ]
                }
            },
            computed: {
                // 计算属性普通写成函数的形式
                total() {
                    // 得到购物车中所有商品的单价 * 数量
                    // 第一种方式
                    // 遍历
                    // let sum = 0;
                    // for (let i = 0; i < this.cart.length; i++) {
                    //   sum += this.cart[i].price * this.cart[i].count;
                    // }
                    // return sum;

                    // 第二种方式
                    // let sum = 0;
                    // this.cart.forEach(item => {
                    //   sum += item.price * item.count;
                    // })
                    // return sum;

                    // 第三种方式
                    return this.cart.reduce((prev, next) => prev + next.price * next.count, 0)
                }
            },
            methods: {
                add(item) {
                    item.count += 1
                },
                minux(item) {
                    if (item.count > 1) {
                        item.count -= 1;
                    }
                }
            }
        });
    </script>
</body>

</html>
```

## 四，侦听器

### 1，什么是侦听器 watch

*  作用：用于监听一个变量的变化，然后去做另一件事儿。
*  特点：当侦听器监听引用数据类型时，默认只能监听引用数据类型的第一层。为什么要这样？监听深度越深，Vue在背后要做的事儿越多，这是一种性能损耗，所以一般不要对一个引用类型的变量进行深度监听。
* 如何监听引用数据类型的每一层（深度监听）？侦听器语法这样写  info: { deep: true, handler() {} }为了避免deep:true深度监听导致性能损耗，我们推荐这种写 'info.child.age' () {}
* 在Vue中，侦听器能够监听哪些性质的变量变化呢？能够监听data、计算属性、vuex数据、$route等，凡是那些带有 _ _ _ob_ _ _ 变量都能被监听到。

直接上代码演示：

![1697181942236](./assets/1697181942236.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <h2>{{name}}</h2>
        <h2>{{num}}</h2>
        <button @click="num++">+1</button>
        <hr>
        <h2>{{info.age}}</h2>
        <button @click="info.age++">+1</button>
        <hr>
        <h2>{{info.child.age}}</h2>
        <button @click="info.child.age++">+1</button>
    </div>
    <script>
        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    name: "码路",
                    num: 100,
                    info: {
                        name: "ml",
                        age: 18,
                        child: {
                            name: "wc",
                            age: 20
                        }
                    }
                }
            },
            // vue2思想：数据驱动视图
            // vue2是选项式API   optionsAPI
            // vue3是组合式API
            // 在watch中可以写异步代码，在computed中不能写异步代码
            watch: {
                // 监听器（侦听器） 写法一：写在函数的形式
                num(newNum, oldNum) {
                    console.log(newNum, oldNum);
                },
                // info整体是一个对象，
                // info.child.age是info这个对象中的属性
                // 当改变info.child.age，info这个地址没有变
                // 什么叫改变info?
                //    vm.info = {a:111}
                // 这个是用来监听整体info是否变化
                // info(newInfo,oldInfo){
                //   console.log("info变化~");
                //   // console.log(newInfo,oldInfo);
                // },

                // 要监听info中属性的变化，监听器就需要写成对象的形式
                // info: {
                //   deep: true,  // 默认情况下，不会深度监听，侦听的层级越深,vue背后做的事情越多,也是一种性能消耗
                //   // 如果是深度监听，获取到的都是新值
                //   handler(newInfo, oldInfo) {
                //     // console.log(newInfo.child.age, oldInfo.child.age);
                //     console.log(newInfo.child.age);
                //     console.log(oldInfo.child.age);
                //   }
                // }

                // 可以直接对某个对象中的某个属性进行监听
                "info.child.age"(newAge, oldAge) {
                    console.log(newAge, oldAge);
                }
            },
            methods: {}
        });
    </script>
</body>

</html>
```

当深度监听时，如何获取旧值，代码如下：

![1697182330269](./assets/1697182330269.png)

### 2，案例：百度联想搜索

直接上代码，如下：

![1697183081563](./assets/1697183081563.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        请你输入搜索的关键字: <input type="text" v-model="keyword.a.b">
        <ul>
            <li v-for="(item,index) in arr">
                {{item.q}}
            </li>
        </ul>
    </div>
    <script>
        // https://www.baidu.com/sugrec?pre=1&p=3&ie=utf-8&json=1&prod=pc&from=pc_web&wd=nba&req=2&csor=1&cb=cb&_=1648605785333

        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    keyword: {
                        a: {
                            b: "vue"
                        }
                    },
                    arr: []
                }
            },
            watch: {
                keyword: {
                    deep: true,
                    immediate: true,
                    handler() {
                        // console.log("xxxxxx");
                        let that = this;

                        window.cb = function(data) {
                            console.log("data:", data.g);
                            console.log(this);
                            that.arr = data.g;
                        }

                        let script = document.createElement("script");
                        script.src = `https://www.baidu.com/sugrec?pre=1&p=3&ie=utf-8&json=1&prod=pc&from=pc_web&wd=${this.keyword.a.b}&req=2&csor=1&cb=cb&_=1648605785333`;
                        document.body.prepend(script);
                    }
                }
            },
            methods: {}
        });
    </script>
</body>

</html>
```

### 3，面试题

* 什么是侦听器？有什么用？
  + 就是vue2中的选项，用于监听一个变量的变化，然后去做另一件事儿。
* 侦听器能不能监听数组/对象的变化？（可以，但默认不监听深层）deep:true
  + 可以的，需要尝试侦听，如果是对象，获取不到旧值，要想获取旧值，需要配合计算属性。
* 侦听器为什么默认不支持深度监听？（性能优化）
  + 监听深度越深，Vue在背后要做的事儿越多，这是一种性能损耗，所以一般不要对一个引用类型的变量进行深度监听。
* 如何监听一个对象中的某个属性变化？（deep:true, 推荐 'obj.key'这种监听写法）
  + “info.child.age”(){}
* 侦听器能监听哪些变量变化？（data、computed、vuex、$route等）
  + data中的数据
  + computed计算属性
  + vuex中的数据
  + $route
  + 其它....

## 五，组件与v-model

### 1，什么是组件化

**Vue核心：**

* 思路：数据驱动视力
* Vue2是选项式API，el，data，methods，computed，watch
* vue是组件化的，一个项目是由N个组件组成的。

**如何理解组件化？**

* 组件是HTML的扩展，使用粒度较小的HTML元素封装成粒度更大的标签（Vue组件）。
* 自定义组件，是前端框架的最重要的技术之一，可以实现快速开发、代码复用、提升可维护性。

**如何自定义组件？**

* 之前new Vue得到的vm，本质也是一个组件，叫根组件，这个组件由一堆选项组件。
* 一个组件，你可以理解成是由一组选项构成的。在封装自定义组件时，你可以使用大多数的Vue选项属性，比如data、template、methods等。
* 对一个组件来讲，最重要的选项是 template选项，用于指定组件的视图结构，在视图结构中你可以使用任意指令。

**如何进行组件注册？**

* 局部注册：components: { 注册名：组件实例 }  局部注册的组件，只能在当前组件作用域中使用。
* 全局注册：Vue.component( 注册名：组件实例)   全局注册的组件，一次注册，在任何其它组件中都可以使用。
* 要注意的是，注册组件时，组件名称名称必须由多个单词用中划线连接。

代码演示：

![1697506107387](./assets/1697506107387.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <h1> =======引入子组件(局部注册)======= </h1>
        <!-- 使用组件时，使用的是注册名，使用组件时，当成html标签来用 -->
        <Demo></Demo>
        <Demo></Demo>
        <Demo></Demo>
        <h1> =======引入子组件(全部注册)======= </h1>
        <!-- 如果注册名是大驼峰，使用时，需要变成中划线命名 -->
        <my-son></my-son>
        <my-son></my-son>
        <my-son></my-son>
    </div>
    <script>
        // 创建一个子组件，是一个对象
        const Demo = {
            // 一个组件通常都是有模板的
            template: `
        <div>
          <h1>{{msg}}</h1>
        </div>
      `,
            // 一个普通的组件，它的data必须是一个函数
            data() {
                return {
                    msg: 'malu 666'
                }
            },
        }

        // 全局注册一个组件
        Vue.component("MySon", {
            template: `
        <div>
            <h1>数据列表</h1>
            <table border="1">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>标题</th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="item in dataList">
                    <td>{{item.id}}</td>
                    <td>{{item.title}}</td>
                </tr>
                </tbody>
            </table>
        </div>
      `,
            data() {
                return {
                    dataList: [{
                            id: "1",
                            title: "xxxxxxxxx"
                        },
                        {
                            id: "2",
                            title: "yyyyyyyyy"
                        },
                    ]
                }
            }
        });

        // vm是一个根组件  el是用来指定根组件对应的模板的
        let vm = new Vue({
            el: '#app',
            // 根组件中的data可以是一个对象，也可以是一个函数，函数要求返回一个对象
            data() {
                return {}
            },
            methods: {},
            // components是用来局部注册组件
            // 前面的Demo叫注册名，后面Demo是组件实例
            // 在根组件中注册的，只能在根组件对应的模板中使用
            components: {
                // Demo: Demo
                Demo
            }
        });
    </script>
</body>

</html>
```

### 2，案例：评分组件（体验一下组件化）

**组件化的三大技术：**

* 自定义属性：把父组件中的数据传递给子组件，子组件通过props选项进行接收，也可以通过this来访问。
* 自定义事件：把子中的数据传递给父组件。
* 自定义插槽：把一片html代码，传递给子组件，决定你的子组件的视图长什么样子。
* 组件封装：使用自定义属性、自定义事件、自定义插槽这三大技术实现组件化。

代码如下：

![1697508082810](./assets/1697508082810.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <style>
        .rate {
            display: flex;
        }

        .rate>span {
            display: inline-block;
            width: 16px;
            height: 16px;
            background: url("./imgs/score.png") center center / 16px 16px;
        }

        .rate>span.on {
            background: url("./imgs/score-on.png") center center / 16px 16px;
        }
    </style>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <!-- :value="xx" 自定义属性 子组件中接收到数据-->
        <!-- <button @click="fn">点我<button>  在button上绑定click事件  vue中的事件绑定 -->
        <!-- <button onclick="fn">点我<button>  原生的DOM的事件绑定 -->
        <!-- <ml-rate @xxx="fn">点我<button>   ml-rate是组件   @xxx叫自定义事件-->
        <!-- click事件，需要手动点击触发。自定义事件，需要写代码触发（this.$emit('xxx')） -->
        <!-- <ml-rate @click="fn">点我<button>   ml-rate是组件   @click叫自定义事件-->
        <!-- @click="fn"  当click事件发生了，会触发fn函数 -->
        <ml-rate :value="num" @click="num=$event"><strong>配送速度：</strong></ml-rate>
        <ml-rate :value="num2" @click="num2=$event">服务态度：</ml-rate>
    </div>

    <script type="x-template" id="rate">
        <div class="rate">
      <!-- slot叫插槽，预留出来的位置,name是用来指定插槽的名字 -->
      <slot name="default"></slot>
      <span v-for="i in 5" :class="{on:value>=i}" @click="kn(i)"></span>
    </div>
  </script>

    <script>
        let rate = {
            template: "#rate",
            // data是给模板提供数据的，props也是给模板提供数据
            // data叫响应式数据，是可以修改的
            // props是接收到的父组件的数据，是不能直接修改
            props: {
                value: {
                    type: Number, // 期望传递的数据类型
                    default: 0 // 没有传递的话，默认值是0
                }
            },
            methods: {
                kn(i) {
                    // console.log("i=",i);
                    // 触发自定义事件，事件名input
                    this.$emit("click", i)
                }
            }
        };

        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    num: 1,
                    num2: 1
                }
            },
            methods: {
                // fn(i){
                //   // console.log("父接收到子的数据：",i);
                //   this.num = i;
                //   // this.num2 = i;
                // }
            },
            components: {
                'ml-rate': rate
            }
        });
    </script>
</body>

</html>
```

### 3，组件化之自定义属性

vue的核心（特点）：

* 数据驱动视图（无需操作DOM，操作数据）
* 基于选项式API，要学习一堆的选项，后期我带大家看vue2的官方文档
* 组件化开发（自定义属性，自定义事件，自定义插槽）

不管是自定义属性，还是自定义事件，还是自定义插槽，都是解决组件通信问题的。现在我们先讲一下自定义属性，它是实现父中的数据传递给子组件的。当然，通过自定义事件，也可以把子组件中的数据传送给父组件，如下：

![1697509633519](./assets/1697509633519.png)

**父组件传递给子组件**

* 父组件有一些数据，需要子组件来进行展示，可以通过props来完成组件之间的通信
* Props是你可以在组件上注册一些自定义的attribute
* 父组件给这些attribute赋值，子组件通过attribute的名称获取到对应的值

直接上代码：

![1697510913960](./assets/1697510913960.png)

参考代码：

```html
<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='UTF-8'>
    <title>Document</title>
    <script src='https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js'></script>
</head>

<body>
    <div id='app'>
        <h1>父组件 --- 王健林</h1>
        <hr>
        <!-- :money="money" 自定义属性，值不是字符串，是data中的状态 -->
        <!-- :changeAppMoney="changeAppMoney"  这里的changeAppMoney是一个方法 -->
        <!-- 换句话，我们可以把data中的状态传递给子组件，也可以把methods中的方法传递给子组件 -->
        <!-- 如果传递方法，在脚手架中是没有问题的 -->
        <my-component1 :money="money" :car="car" :changeAppMoney="changeAppMoney"></my-component1>
    </div>

    <script>
        let MyComponent1 = {
            name: "MyComponent1",
            template: `
        <div>
          <h1>王思聪组件</h1>
           <p>收到父的money ---- {{money}}</p>
           <p>收到父的car ---- {{car}}</p>
           <button @click="updateMoney">修改钱</button>
        </div>
      `,
            // props的写法一：写一个数组，数组中放接收到的状态和方法
            // 接收过来的状态或方法，都会挂载到this上
            // props: ["money", "car", "changeAppMoney"],

            // props的写法一：对象写法
            // type的类型可以是：
            // String
            // Number
            // Boolean
            // Array
            // Object
            // Date
            // Function
            // Symbol
            props: {
                money: {
                    // type:String, // 期望父传递的是字符串类型，如果不是，会发出警告
                    type: Number, // 期望父传递的是数字类型，如果不是，会发出警告
                },
                car: {
                    type: String,
                    required: true, // car是必传项，当你在使用这个组件时，必须给我传递一个car,不传递的话，也是会报警告
                },
                changeAppMoney: {
                    type: Function
                }
            },
            methods: {
                updateMoney() {
                    // 调用父组件传递过来的方法
                    // this 表示当前组件实例
                    // this.changeAppMoney();

                    console.log(this.money);
                    console.log(this.car);
                    // console.log(this.changeAppMoney);
                }
            }
        };

        let vm = new Vue({
            el: '#app',
            data() {
                return {
                    money: 10000000,
                    car: "二八大杠",
                    msg: "hello vue"
                }
            },
            methods: {
                changeAppMoney() {
                    console.log("xxxxxxxxxxxx");
                    this.money = "1个小目标"
                },
            },
            components: {
                MyComponent1
            }
        });
    </script>
</body>

</html>
```

### 4，先说一下脚手架

在真实开发，我们都是使用脚手架的，在脚手架中，会采用单文件组件，也就是一个文件，就是一个组件，这个文件的后缀是.vue。单文件组件的特点：

* 代码的高亮（安装必要插件，安装此插件：Vetur）
* ES6、CommonJS的模块化能力
* 组件作用域的CSS
* 可以使用预处理器来构建更加丰富的组件，比如TypeScript、Babel、Less、Sass等

脚手架就是一人工具，要使用这个工具，需要安装，如下：

```shell
npm i @vue/cli -g     # 全局安装脚手工具
npm update @vue/cli -g   # 升级Vue CLI(如果是比较旧的版本，可以通过下面的命令来升级)
vue create 项目名  # 通过Vue的命令来创建项目
```

我先升级一下脚手架工具，如下：

![1697511244798](./assets/1697511244798.png)

有了脚手架，就可以创建项目了，过程如下：

![1697511508197](./assets/1697511508197.png)

![1697511569507](./assets/1697511569507.png)

![1697511647380](./assets/1697511647380.png)

![1697511710735](./assets/1697511710735.png)

![1697511750108](./assets/1697511750108.png)

![1697511797065](./assets/1697511797065.png)

![1697511838683](./assets/1697511838683.png)

使用vscode打开这个文件夹，如下：

![1697512114008](./assets/1697512114008.png)

分析main.js，main.js是项目的入口，如下：

![1697512370133](./assets/1697512370133.png)

分析一下App.vue，如下：

![1697512504930](./assets/1697512504930.png)

删除一些代码如下：

![1697512548057](./assets/1697512548057.png)

目前项目中有两个组件：

* new Vue  得到的根组件   
* App.vue  App组件

如何把项目运行起来呢？

![1697512638110](./assets/1697512638110.png)

运行项目，如下：

![1697512691226](./assets/1697512691226.png)

运行起来后，它内置了一个服务器，托管项目，如下：

![1697512719499](./assets/1697512719499.png)

浏览器访问之，如下：

![1697512752962](./assets/1697512752962.png)

### 5，通过脚手架演示父传子

再通过脚手架项目，演示一下父传子，如下：

![1697513784204](./assets/1697513784204.png)

代码如下：

![1697514508546](./assets/1697514508546.png)

App.vue，如下：

```vue
<template>
  <div id="app">
    <h1>父组件 --- 王健林</h1>
    <hr />
    <my-component-1
      :money="money"
      :car="car"
      :changeAppMoney="changeAppMoney"
    ></my-component-1>
  </div>
</template>

<script>
import MyComponent1 from "./components/MyComponent1.vue";

export default {
  name: "App",
  data() {
    return {
      money: 10000000,
      car: "二八大杠",
    };
  },
  methods: {
    // 定义修改状态的方法
    changeAppMoney(m) {
      // this.money = "1个小目标";
      this.money = m;
    },
  },
  components: {
    MyComponent1,
  },
};
</script>

<style>
</style>

```

MyComponent1.vue，如下：

```vue
<template>
  <!-- 在vue2中，组件的模板，需要一个唯一的根标签 -->
  <div>
    <h1>王思聪组件</h1>
    <p>收到父的money ---- {{ money }}</p>
    <p>收到父的car ---- {{ car }}</p>
    <!-- <button @click="changeAppMoney">修改钱</button> -->
    <button @click="updateMoney">修改钱</button>
  </div>
</template>

<script>
export default {
  name: "MyComponent1",
  // props的第1种写法：
  // props: ["car", "money", "changeAppMoney"],
  // props的第2种写法：
  props: {
    car: {
      type: String,
      default: "xx",
    },
    money: {
      type: Number,
      required: true,
    },
    changeAppMoney: {
      type: Function,
    },
  },
  data() {
    return {
      wscMoney: "2个小目标",
    };
  },
  methods: {
    updateMoney() {
      // this.changeAppMoney();
      this.changeAppMoney(this.wscMoney);
    },
  },
};
</script>

<style>
</style>

```

总结一把：

* 一般情况下，我们是通过自定义属性实现父传子，也就是把父中的数据传递给子。
* 但是也可以通过自定义属性实现子传父，此时传递就是一个函数，在子中调用函数，把子中的数据传递给父。

### 6，案例：TodoMVC

参考：https://todomvc.com/examples/vue/

### 6，组件化之自定义事件

还可以通过自事件实现子传父。

### 7，组件化之自定义插槽

### 8，封装一个弹窗组件

## 六，生命周期

## 七，动态组件

## 八，过渡动画

## 九，混入

## 十，过滤器

## 十一，自定义指令

## 十二，插件

## 十三，两个API

## 十四，组件通信

## 十五，脚手架

## 十六，路由

## 十七，Vuex

## 十八，项目
