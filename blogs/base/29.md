---
title: 29-小程序项目实战
date: 2028-12-15
sticky: 1
sidebar: 'auto'
tags:
 - js
categories:
 - base
---

## 一，搭建项目环境



### 1，创建项目

![1714357602220](./assets/1714357602220.png)



### 2，配置window和tabbar

准备图片资源：

![1714357715906](./assets/1714357715906.png)



配置window:

![1714357761623](./assets/1714357761623.png)

```json
  "window": {
    "backgroundTextStyle": "dark",
    "navigationBarBackgroundColor": "#fff",
    "navigationBarTitleText": "网易严选",
    "navigationBarTextStyle": "black",
    "enablePullDownRefresh": true
  },
```


配置pages和tabbar：

![1714357838710](./assets/1714357838710.png)

pages：

```json
  "pages": [
    "pages/index/index",
    "pages/topic/topic",
    "pages/catalog/catalog",
    "pages/cart/cart",
    "pages/ucenter/index/index"
  ],
```

tabbar：

```json
 "tabBar": {
    "backgroundColor": "#fafafa",
    "borderStyle": "white",
    "selectedColor": "#b4282d",
    "color": "#666",
    "list": [
      {
        "pagePath": "pages/index/index",
        "iconPath": "static/images/ic_menu_choice_nor.png",
        "selectedIconPath": "static/images/ic_menu_choice_pressed.png",
        "text": "首页"
      },
      {
        "pagePath": "pages/topic/topic",
        "iconPath": "static/images/ic_menu_topic_nor.png",
        "selectedIconPath": "static/images/ic_menu_topic_pressed.png",
        "text": "专题"
      },
      {
        "pagePath": "pages/catalog/catalog",
        "iconPath": "static/images/ic_menu_sort_nor.png",
        "selectedIconPath": "static/images/ic_menu_sort_pressed.png",
        "text": "分类"
      },
      {
        "pagePath": "pages/cart/cart",
        "iconPath": "static/images/ic_menu_shoping_nor.png",
        "selectedIconPath": "static/images/ic_menu_shoping_pressed.png",
        "text": "购物车"
      },
      {
        "pagePath": "pages/ucenter/index/index",
        "iconPath": "static/images/ic_menu_me_nor.png",
        "selectedIconPath": "static/images/ic_menu_me_pressed.png",
        "text": "我的"
      }
    ]
  },
```



app.json的配置如下：

```json
{
  "pages": [
    "pages/index/index",
    "pages/topic/topic",
    "pages/catalog/catalog",
    "pages/cart/cart",
    "pages/ucenter/index/index"
  ],
  "window": {
    "backgroundTextStyle": "dark",
    "navigationBarBackgroundColor": "#fff",
    "navigationBarTitleText": "网易严选",
    "navigationBarTextStyle": "black",
    "enablePullDownRefresh": true
  },
  "tabBar": {
    "backgroundColor": "#fafafa",
    "borderStyle": "white",
    "selectedColor": "#b4282d",
    "color": "#666",
    "list": [
      {
        "pagePath": "pages/index/index",
        "iconPath": "static/images/ic_menu_choice_nor.png",
        "selectedIconPath": "static/images/ic_menu_choice_pressed.png",
        "text": "首页"
      },
      {
        "pagePath": "pages/topic/topic",
        "iconPath": "static/images/ic_menu_topic_nor.png",
        "selectedIconPath": "static/images/ic_menu_topic_pressed.png",
        "text": "专题"
      },
      {
        "pagePath": "pages/catalog/catalog",
        "iconPath": "static/images/ic_menu_sort_nor.png",
        "selectedIconPath": "static/images/ic_menu_sort_pressed.png",
        "text": "分类"
      },
      {
        "pagePath": "pages/cart/cart",
        "iconPath": "static/images/ic_menu_shoping_nor.png",
        "selectedIconPath": "static/images/ic_menu_shoping_pressed.png",
        "text": "购物车"
      },
      {
        "pagePath": "pages/ucenter/index/index",
        "iconPath": "static/images/ic_menu_me_nor.png",
        "selectedIconPath": "static/images/ic_menu_me_pressed.png",
        "text": "我的"
      }
    ]
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json",
  "lazyCodeLoading": "requiredComponents"
}
```



### 3，封装ajax和API



![1714358311007](./assets/1714358311007.png)



参考代码：

```js
// 封装微信的的request
function request(url, data = {}, method = "POST", header = "application/x-www-form-urlencoded") {
  wx.showLoading({
      title: '加载中...',
  });
  return new Promise(function (resolve, reject) {
      wx.request({
          url: url,
          data: data,
          method: method,
          header: {
              'Content-Type': header,
              'token': wx.getStorageSync('token')
          },
          success: function (res) {
              wx.hideLoading();
              if (res.statusCode == 200) {
                  resolve(res.data);
              } else {
                  reject(res.errMsg);
              }

          },
          fail: function (err) {
              reject(err)
          }
      })
  });
}

module.exports = {
  request
}
```



封装API调用：

![1714358735036](./assets/1714358735036.png)

```js
const API_BASE_URL = 'http://localhost:8080/platform-framework/api/';

module.exports = {
  IndexUrlBanner: API_BASE_URL + 'index/banner', //首页banner
  IndexUrlBrand: API_BASE_URL + 'index/brand', //品牌制造商
  IndexUrlTopic: API_BASE_URL + 'index/topic', //专题精选
  IndexUrlNewGoods: API_BASE_URL + 'index/newGoods', //新品首发
  IndexUrlHotGoods: API_BASE_URL + 'index/hotGoods', //热卖商品
  IndexUrlChannel: API_BASE_URL + 'index/channel', //banner下的分类
  IndexUrlCategory: API_BASE_URL + 'index/category', //首页底部的分类及商品列表
}
```



### 4，渲染轮播图

说白了，开始写html+css+js+ajax。先渲染轮播图：

![1714370760190](./assets/1714370760190.png)

获取数据：

![1714359295738](./assets/1714359295738.png)

```js
const util = require('../../utils/utils.js');
const api = require('../../config/api.js');

Page({
  data:{
    banner: [],
  },
  onLoad(){
    this.getIndexData();
  },
  getIndexData(){
    util.request(api.IndexUrlBanner).then(res=>{
      console.log(res)
      if (res.errno === 0) {
        this.setData({
          banner:res.data.banner
        });
      }
    })
  }
})
```



查看数据：

![1714359350033](./assets/1714359350033.png)



渲染数据：

![1714359370364](./assets/1714359370364.png)

```html
<view class="container">
  <swiper class="banner" indicator-dots="true" autoplay="true" interval="3000" duration="1000">
    <swiper-item wx:for="{{banner}}" wx:key="id">
        <image src="{{item.imageUrl}}" background-size="cover"></image>
    </swiper-item>
  </swiper>
</view>
```



写样式：

![1714359537478](./assets/1714359537478.png)

```css
.banner {
  width: 750rpx;
  height: 417rpx;
}
.banner image {
  width: 100%;
  height: 417rpx;
}
```



设置全局样式：

![1714371221075](./assets/1714371221075.png)

```wxss
.container {
  box-sizing: border-box;
  background-color: #f4f4f4;
  font-family: PingFangSC-Light,helvetica,'Heiti SC';
} 

view,image,text,navigator{
  box-sizing: border-box;
  padding:0;
  margin:0;
}

view,text{
  font-family: PingFangSC-Light,helvetica,'Heiti SC';
  font-size: 29rpx;
  color: #333;
}

button::after {
  display: none;
}

.display-none {
  display: none !important;
}
::-webkit-scrollbar {
  width: 5px;
  background-color: #f5f5f5;
}

::-webkit-scrollbar-thumb {
  background-color: #999;
}
```





## 二，首页面

### 1，channel

目标：

![1714371278875](./assets/1714371278875.png)



定义数据和发ajax请求：

![1714371314600](./assets/1714371314600.png)

```js
util.request(api.IndexUrlChannel).then(res=> {
    if (res.errno === 0) {
        this.setData({
            channel: res.data.channel
        });
    }
});
```



查看数据：

![1714371352570](./assets/1714371352570.png)



渲染：

![1714371395459](./assets/1714371395459.png)

```html
 <view class="a-section a-topic" wx:if="{{channel.length > 0}}">
    <view class="m-menu">
      <navigator class="item" url="{{item.url}}" wx:for="{{channel}}" wx:key="id">
        <image src="{{item.iconUrl}}" background-size="cover"></image>
        <text>{{item.name}}</text>
      </navigator>
    </view>
  </view>
```



样式：

![1714371423228](./assets/1714371423228.png)

```css
.m-menu {
  display: flex;
  height: 181rpx;
  width: 750rpx;
  flex-flow: row nowrap;
  align-items: center;
  justify-content: space-between;
  background-color: #fff;
}

.m-menu .item {
  flex: 1;
  display: block;
  padding: 20rpx 0;
}

.m-menu image {
  display: block;
  width: 58rpx;
  height: 58rpx;
  margin: 0 auto;
  margin-bottom: 12rpx;
}

.m-menu text {
  display: block;
  font-size: 24rpx;
  text-align: center;
  margin: 0 auto;
  line-height: 1;
  color: #333;
}

.a-section {
  width: 750rpx;
  height: auto;
  overflow: hidden;
  background: #fff;
  color: #333;
  margin-top: 20rpx;
}
```



### 2，brand



目标：

![1714372480986](./assets/1714372480986.png)



定义数据和发ajax请求：

![1714372517288](./assets/1714372517288.png)

```js
    util.request(api.IndexUrlBrand).then(res=> {
      if (res.errno === 0) {
        this.setData({
          brand: res.data.brandList
        });
      }
    });
```



查看数据：

![1714372545364](./assets/1714372545364.png)



渲染：

![1714372578849](./assets/1714372578849.png)

```html
  <!-- brand -->
  <view class="a-section a-topic" wx:if="{{brand.length > 0}}">
    <view class="a-section a-brand">
      <view class="h">
        <navigator url="../brand/brand">
          <text class="txt">品牌制造商直供</text>
        </navigator>
      </view>
      <view class="b">
        <view class="item item-1" wx:for="{{brand}}" wx:key="id" wx:if="{{item.newPicUrl}}">
          <navigator url="/pages/brandDetail/brandDetail?id={{item.id}}">
            <view class="wrap">
              <image class="img" src="{{item.newPicUrl}}" mode="aspectFill"></image>
              <view class="mt">
                <text class="brand">{{item.name}}</text>
                <text class="price">{{item.floorPrice}}</text>
                <text class="unit">元起</text>
              </view>
            </view>
          </navigator>
        </view>
      </view>
    </view>
  </view>
```



样式：

![1714372644470](./assets/1714372644470.png)

```css
/* =========================== brand start =========================== */
.a-section .h {
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  justify-content: center;
  height: 130rpx;
}

.a-section .h .txt {
  padding-right: 30rpx;
  background-size: 16.656rpx 27rpx;
  display: inline-block;
  height: 36rpx;
  font-size: 33rpx;
  line-height: 36rpx;
}

.a-brand .b {
  width: 750rpx;
  height: auto;
  overflow: hidden;
  position: relative;
}

.a-brand .wrap {
  position: relative;
}

.a-brand .img {
  position: absolute;
  left: 0;
  top: 0;
}

.a-brand .mt {
  position: absolute;
  z-index: 2;
  padding: 27rpx 31rpx;
  left: 0;
  top: 0;
}

.a-brand .mt .brand {
  display: block;
  font-size: 33rpx;
  height: 43rpx;
  color: #333;
}

.a-brand .mt .price, .a-brand .mt .unit {
  font-size: 25rpx;
  color: #999;
}

.a-brand .item-1 {
  float: left;
  width: 375rpx;
  height: 252rpx;
  overflow: hidden;
  border-top: 1rpx solid #fff;
  margin-left: 1rpx;
}

.a-brand .item-1:nth-child(2n+1){
  margin-left: 0;
  width: 374rpx;
}

.a-brand .item-1 .img {
  width: 375rpx;
  height: 253rpx;
}

.a-topic .b {
  height: auto;
  width: 750rpx;
  padding: 0 0 48rpx 0;
}

.a-topic .b .list {
  height: 533rpx;
  width: 750rpx;
  white-space: nowrap;
}

.a-topic .b .item {
  display: inline-block;
  min-height: 400rpx;
  width: 680.5rpx;
  margin-left: 30rpx;
  overflow: hidden;
}

.a-topic .b .item:last-child {
  margin-right: 30rpx;
}

.a-topic .b .img {
  height: 400rpx;
  width: 680.5rpx;
}

.a-topic .b .np {
  height: 35rpx;
  margin-bottom: 13.5rpx;
  color: #333;
  font-size: 30rpx;
}

.a-topic .b .np .price {
  margin-left: 20.8rpx;
  color: #b4282d;
}

.a-topic .b .desc {
  display: block;
  height: 30rpx;
  color: #999;
  font-size: 24rpx;
  white-space: nowrap;
  overflow: hidden;
  text-overflow:ellipsis;
}

/* =========================== brand end =========================== */
```



### 3，topic



目标：

![1714373076202](assets/1714373076202.png)

定义状态和发ajax请求：

![1714372848420](./assets/1714372848420.png)

```js
    util.request(api.IndexUrlTopic).then(res => {
      if (res.errno === 0) {
        this.setData({
          topics: res.data.topicList
        });
      }
    });
```



查看数据：

![1714372872322](./assets/1714372872322.png)

渲染数据：

![1714372931529](./assets/1714372931529.png)

```html
<!-- topic -->
  <view class="a-section a-topic" wx:if="{{topics.length > 0}}">
    <view class="h">
      <view>
        <navigator url="../topic/topic" open-type="switchTab">
          <text class="txt">专题精选</text>
        </navigator>
      </view>
    </view>
    <view class="b">
      <scroll-view scroll-x="true" class="list">
        <view class="item" wx:for="{{topics}}" wx:for-index="index" wx:for-item="item" wx:key="id">
          <navigator url="../topicDetail/topicDetail?id={{item.id}}">
            <image class="img" src="{{item.scenePicUrl}}" background-size="cover"></image>
            <view class="np">
              <text class="name">{{item.title}}</text>
              <text class="price">￥{{item.priceInfo}}元起</text>
            </view>
            <text class="desc">{{item.subtitle}}</text>
          </navigator>
        </view>
      </scroll-view>
    </view>
  </view>
```



样式：在brand模块已经把topic的样式写过了

![1714373000059](./assets/1714373000059.png)



### 4，

目标：



定义状态和发ajax请求：



```js

```



查看数据：



渲染数据：



```html

```



样式：



```css

```

### 5，

目标：



定义状态和发ajax请求：



```js

```



查看数据：



渲染数据：



```html

```



样式：



```css

```

### 6， 

目标：



定义状态和发ajax请求：



```js

```



查看数据：



渲染数据：



```html

```



样式：



```css

```

### 7, 

目标：



定义状态和发ajax请求：



```js

```



查看数据：



渲染数据：



```html

```



样式：



```css

```

### 8，

目标：



定义状态和发ajax请求：



```js

```



查看数据：



渲染数据：



```html

```



样式：



```css

```