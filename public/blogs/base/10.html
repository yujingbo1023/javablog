<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>10-ajax | 全栈开发</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/javablog/public/favicon.ico">
    <meta name="description" content="快来玩java全栈呀">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/javablog/public/assets/css/0.styles.ca9f9cd1.css" as="style"><link rel="preload" href="/javablog/public/assets/js/app.134b6f67.js" as="script"><link rel="preload" href="/javablog/public/assets/js/11.872216ae.js" as="script"><link rel="preload" href="/javablog/public/assets/js/1.4a2aebf2.js" as="script"><link rel="preload" href="/javablog/public/assets/js/7.f81bb9de.js" as="script"><link rel="prefetch" href="/javablog/public/assets/js/10.2ec4c4e1.js"><link rel="prefetch" href="/javablog/public/assets/js/12.2df16185.js"><link rel="prefetch" href="/javablog/public/assets/js/13.61934ba7.js"><link rel="prefetch" href="/javablog/public/assets/js/14.6a7f30f3.js"><link rel="prefetch" href="/javablog/public/assets/js/15.6b8dc805.js"><link rel="prefetch" href="/javablog/public/assets/js/16.465d0fd5.js"><link rel="prefetch" href="/javablog/public/assets/js/17.71fb06dc.js"><link rel="prefetch" href="/javablog/public/assets/js/18.68be56a8.js"><link rel="prefetch" href="/javablog/public/assets/js/19.9f466e56.js"><link rel="prefetch" href="/javablog/public/assets/js/20.78c5300f.js"><link rel="prefetch" href="/javablog/public/assets/js/21.bdc687cc.js"><link rel="prefetch" href="/javablog/public/assets/js/22.0f0cc055.js"><link rel="prefetch" href="/javablog/public/assets/js/23.2a2669db.js"><link rel="prefetch" href="/javablog/public/assets/js/24.a5a044c0.js"><link rel="prefetch" href="/javablog/public/assets/js/25.bced0d0d.js"><link rel="prefetch" href="/javablog/public/assets/js/26.8778a7fb.js"><link rel="prefetch" href="/javablog/public/assets/js/27.23c4115c.js"><link rel="prefetch" href="/javablog/public/assets/js/28.77bc89a1.js"><link rel="prefetch" href="/javablog/public/assets/js/29.896282bd.js"><link rel="prefetch" href="/javablog/public/assets/js/3.bccb6bb8.js"><link rel="prefetch" href="/javablog/public/assets/js/30.5ad44be8.js"><link rel="prefetch" href="/javablog/public/assets/js/31.61b94ab9.js"><link rel="prefetch" href="/javablog/public/assets/js/32.69a076ee.js"><link rel="prefetch" href="/javablog/public/assets/js/4.c5637cd4.js"><link rel="prefetch" href="/javablog/public/assets/js/5.769ee10e.js"><link rel="prefetch" href="/javablog/public/assets/js/6.333c5d17.js"><link rel="prefetch" href="/javablog/public/assets/js/8.02e9889f.js"><link rel="prefetch" href="/javablog/public/assets/js/9.bee12391.js">
    <link rel="stylesheet" href="/javablog/public/assets/css/0.styles.ca9f9cd1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-1c636796><div data-v-1c636796><div class="password-shadow password-wrapper-out" style="display:none;" data-v-2c3e9f55 data-v-1c636796 data-v-1c636796><h3 class="title" data-v-2c3e9f55>全栈开发</h3> <p class="description" data-v-2c3e9f55>快来玩java全栈呀</p> <label id="box" class="inputBox" data-v-2c3e9f55><input type="password" value="" data-v-2c3e9f55> <span data-v-2c3e9f55>Konck! Knock!</span> <button data-v-2c3e9f55>OK</button></label> <div class="footer" data-v-2c3e9f55><span data-v-2c3e9f55><i class="iconfont reco-theme" data-v-2c3e9f55></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-2c3e9f55>vuePress-theme-reco</a></span> <span data-v-2c3e9f55><i class="iconfont reco-copyright" data-v-2c3e9f55></i> <a data-v-2c3e9f55><span data-v-2c3e9f55>码路</span>
          
        <span data-v-2c3e9f55>2017 - </span>
        2023
      </a></span></div></div> <div class="hide" data-v-1c636796><header class="navbar" data-v-1c636796><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/javablog/public/" class="home-link router-link-active"><img src="/javablog/public/logo.png" alt="全栈开发" class="logo"> <span class="site-name">全栈开发</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/javablog/public/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      全栈开发
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javablog/public/categories/base/" class="nav-link"><i class="undefined"></i>
  base
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/javaweb/" class="nav-link"><i class="undefined"></i>
  javaweb
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/jdbc/" class="nav-link"><i class="undefined"></i>
  jdbc
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/jvm/" class="nav-link"><i class="undefined"></i>
  jvm
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/microservices/" class="nav-link"><i class="undefined"></i>
  microservices
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/mysql/" class="nav-link"><i class="undefined"></i>
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/mysqlplus/" class="nav-link"><i class="undefined"></i>
  mysqlplus
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/ssm/" class="nav-link"><i class="undefined"></i>
  ssm
</a></li></ul></div></div><div class="nav-item"><a href="/javablog/public/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/javablog/public/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Docs
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javablog/public/docs/theme-reco/" class="nav-link"><i class="undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/recoluan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1c636796></div> <aside class="sidebar" data-v-1c636796><div class="personal-info-wrapper" data-v-6f92ba70 data-v-1c636796><img src="/javablog/public/avatar.png" alt="author-avatar" class="personal-img" data-v-6f92ba70> <h3 class="name" data-v-6f92ba70>
    码路
  </h3> <div class="num" data-v-6f92ba70><div data-v-6f92ba70><h3 data-v-6f92ba70>22</h3> <h6 data-v-6f92ba70>Articles</h6></div> <div data-v-6f92ba70><h3 data-v-6f92ba70>10</h3> <h6 data-v-6f92ba70>Tags</h6></div></div> <ul class="social-links" data-v-6f92ba70></ul> <hr data-v-6f92ba70></div> <nav class="nav-links"><div class="nav-item"><a href="/javablog/public/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      全栈开发
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javablog/public/categories/base/" class="nav-link"><i class="undefined"></i>
  base
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/javaweb/" class="nav-link"><i class="undefined"></i>
  javaweb
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/jdbc/" class="nav-link"><i class="undefined"></i>
  jdbc
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/jvm/" class="nav-link"><i class="undefined"></i>
  jvm
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/microservices/" class="nav-link"><i class="undefined"></i>
  microservices
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/mysql/" class="nav-link"><i class="undefined"></i>
  mysql
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/mysqlplus/" class="nav-link"><i class="undefined"></i>
  mysqlplus
</a></li><li class="dropdown-item"><!----> <a href="/javablog/public/categories/ssm/" class="nav-link"><i class="undefined"></i>
  ssm
</a></li></ul></div></div><div class="nav-item"><a href="/javablog/public/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/javablog/public/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Docs
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javablog/public/docs/theme-reco/" class="nav-link"><i class="undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/recoluan" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-2c3e9f55 data-v-1c636796><h3 class="title" data-v-2c3e9f55>10-ajax</h3> <!----> <label id="box" class="inputBox" data-v-2c3e9f55><input type="password" value="" data-v-2c3e9f55> <span data-v-2c3e9f55>Konck! Knock!</span> <button data-v-2c3e9f55>OK</button></label> <div class="footer" data-v-2c3e9f55><span data-v-2c3e9f55><i class="iconfont reco-theme" data-v-2c3e9f55></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-2c3e9f55>vuePress-theme-reco</a></span> <span data-v-2c3e9f55><i class="iconfont reco-copyright" data-v-2c3e9f55></i> <a data-v-2c3e9f55><span data-v-2c3e9f55>码路</span>
          
        <span data-v-2c3e9f55>2017 - </span>
        2023
      </a></span></div></div> <div data-v-1c636796><div data-v-1c636796><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">10-ajax</h1> <div data-v-6acedb3b><i class="iconfont reco-account" data-v-6acedb3b><span data-v-6acedb3b>码路</span></i> <i class="iconfont reco-date" data-v-6acedb3b><span data-v-6acedb3b>12/15/2028</span></i> <!----> <i class="tags iconfont reco-tag" data-v-6acedb3b><span class="tag-item" data-v-6acedb3b>js</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="一-ajax初识"><a href="#一-ajax初识" class="header-anchor">#</a> 一，Ajax初识</h2> <h3 id="_0-搭建后端代码"><a href="#_0-搭建后端代码" class="header-anchor">#</a> 0，搭建后端代码</h3> <p>创建一个后端项目，如下：</p> <p><img src="/javablog/public/assets/img/1696813780835.59a60bfa.png" alt="1696813780835"></p> <p>生成一个配置文件，如下：</p> <p><img src="/javablog/public/assets/img/1696813837321.6158a73e.png" alt="1696813837321"></p> <p>后端需要使用到一些依赖，如下：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@koa/router&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^12.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;axios&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.27.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;body-parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.19.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cookie-parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.4.5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;express&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.17.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;express-session&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.17.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;koa&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.13.4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;koa-body&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;koa-logger&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.2.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;koa-static&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;koa2-cors&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.0.6&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;mongodb&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.4.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;nprogress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;qs&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.11.0&quot;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>上面的依赖，就是第三方模块，copy到package.json中，如下：</p> <p><img src="/javablog/public/assets/img/1696813983511.815e622f.png" alt="1696813983511"></p> <p>跑环境，如下：</p> <p><img src="/javablog/public/assets/img/1696814026018.2052fbe3.png" alt="1696814026018"></p> <p>开始书写后端代码，由于大家没有学习过后端，代码直接copy，如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/get&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">&quot;hello Ajax&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>在vodecode中，copy上面的代码，如下：</p> <p><img src="/javablog/public/assets/img/1696814372821.e50c0a41.png" alt="1696814372821"></p> <p>然后，就可以请求服务器，通过浏览器或通过poatman来请求，如下：</p> <p><img src="/javablog/public/assets/img/1696814426243.c760ee7e.png" alt="1696814426243"></p> <p>使用postman试一把，如下：</p> <p><img src="/javablog/public/assets/img/1696814486478.eeba65f1.png" alt="1696814486478"></p> <p>到此，后端服务器就运行起来了，上面的后端代码使用的是JS来的，后面我们会使用JAVA来写。</p> <h3 id="_1-原生ajax经典步骤"><a href="#_1-原生ajax经典步骤" class="header-anchor">#</a> 1，原生Ajax经典步骤</h3> <p>之前我们发请求，可能浏览器发请求，也可以通过postman发请求，我们之前学习的html标签中的link标签的href，img标签的src，script标签的scr，a标签的href... 都是可以发请求的。今天我们学习的ajax也是用来发请求的，非常重要的。<br></p> <p><strong>AJAX</strong>： 全称为Asynchronous Javascript And XML，就是异步的 JS 和 XML。它可以使用 JSON，XML，HTML 和 text 文本等格式发送和接收数据。Ajax不是编程语言，还是原生JS中的内容。<br></p> <p><strong>Ajax发送请求的经典步骤</strong></p> <ul><li>第一步：创建网络请求的AJAX对象（使用XMLHttpRequest）</li> <li>第二步：监听XMLHttpRequest对象状态的变化，或者监听onload事件（请求完成时触发）</li> <li>第三步：配置网络请求（通过open方法）</li> <li>第四步：发送send网络请求</li></ul> <p>在桌面上，再创建一个文件夹，表示前端代码，如下：</p> <p><img src="/javablog/public/assets/img/1696814955827.562a5145.png" alt="1696814955827"></p> <p>代码演示：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 
   HTML:
      &lt;div&gt;  &lt;p&gt;   &lt;span&gt; ... 

   XML:
      &lt;pig&gt;   &lt;dog&gt;   &lt;student&gt;...
      在10年前，是前后端通信的一种数据格式
      现在，前后端通信主要是以json为主

 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// 1）创建一个ajax对象   XMLHttpRequest   属于BOM中的内容</span>
    <span class="token keyword">let</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ajax刚创建出来的时状态是0</span>

    <span class="token comment">// 2）监听ajax对象的状态变化 </span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;==&gt;&quot;</span><span class="token punctuation">,</span> xhr<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// if(xhr.readyState === 4){</span>
        <span class="token comment">//   console.log(&quot;---------------&quot;);</span>
        <span class="token comment">//   console.log(xhr.response);</span>
        <span class="token comment">//   console.log(&quot;---------------&quot;);</span>
        <span class="token comment">// }</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> XMLHttpRequest<span class="token punctuation">.</span><span class="token constant">DONE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;---------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;---------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 3）配置网络请求</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'http://127.0.0.1:3000/get'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用完open方法后,ajax的状态就变成1</span>

    <span class="token comment">// 4）发出请求  send(请求体)  请求体就是给后端传递数据</span>
    <span class="token comment">// get请求没有所谓的请求体  只有post请求才能请求体</span>
    <span class="token comment">// 你发出了get请求,send()  ()中不需要写任何内容 </span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>截个图，如下：</p> <p><img src="/javablog/public/assets/img/1696815654515.7c7b2840.png" alt="1696815654515"></p> <p>上面是前端代码，对应的后端代码第0小节中。<br></p> <p>上面我们说了ajax的状态：</p> <ul><li>0       UNSENT       代理被创建，但尚未调用 open() 方法。</li> <li>1       OPENED       open() 方法已经被调用。</li> <li>2       HEADERS_RECEIVED       send() 方法已经被调用，并且头部和状态已经可获得。</li> <li>3       LOADING       服务器正在给ajax数据, responseText 属性已经包含部分数据。</li> <li>4       DONE       服务器已经完全把数据给了ajax</li></ul> <p>注意：</p> <ul><li>这个状态并非是HTTP的相应状态，而是记录的XMLHttpRequest对象的状态变化</li></ul> <h3 id="_2-xhr对象的load事件"><a href="#_2-xhr对象的load事件" class="header-anchor">#</a> 2，xhr对象的load事件</h3> <p>除了onreadystatechange，还有其他的事件可以监听，如下：</p> <ul><li>loadstart：请求开始</li> <li>progress： 一个响应数据包到达，此时整个 response body 都在 response 中</li> <li>abort：调用 xhr.abort() 取消了请求</li> <li>error：发生连接错误，例如，域错误。不会发生诸如 404 这类的 HTTP 错误</li> <li>load：请求成功完成，我们也可以使用load来获取数据</li> <li>timeout：由于请求超时而取消了该请求（仅发生在设置了 timeout 的情况下）</li> <li>loadend：在 load，error，timeout 或 abort 之后触发</li></ul> <p>我们重点关注load事件，如下:</p> <p><img src="/javablog/public/assets/img/1696816182755.f7a89a64.png" alt="1696816182755"></p> <p>参考代码如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    xhr<span class="token punctuation">.</span><span class="token function-variable function">onloadstart</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;onloadstart...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'http://127.0.0.1:3000/get'</span><span class="token punctuation">)</span>

    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>后端代码也是第0节中的后端代码。</p> <h3 id="_3-响应json数据-指定响应类型"><a href="#_3-响应json数据-指定响应类型" class="header-anchor">#</a> 3，响应JSON数据, 指定响应类型</h3> <p>上面的程序，后端响应的是字符串，我们通过响应头，可以看出来，如下：</p> <p><img src="/javablog/public/assets/img/1696816678371.3e2d7efd.png" alt="1696816678371"></p> <p>再去看一下请求头，如下：</p> <p><img src="/javablog/public/assets/img/1696816996470.9877b2bc.png" alt="1696816996470"></p> <p>通过上面的响应头分析，知道了，上面的案例，后端返回的是纯文本。能不能让后端返回JSON呢？</p> <p>答：肯定可以的。</p> <p>由于上一个服务，监听的端口是3000，一个端口，只能被一个服务监听。也就意味如果再开一个服务，你是不能监听3000端口，你要么换一个端口，要么把上一个服务关掉，通过stop run code，就可以关掉服务，如下：</p> <p><img src="/javablog/public/assets/img/1696818000352.5de059f4.png" alt="1696818000352"></p> <p><img src="/javablog/public/assets/img/1696818026885.a3cd3701.png" alt="1696818026885"></p> <p>创建第二个服务，copy后端代码，如下：</p> <p><img src="/javablog/public/assets/img/1696818064010.b2132a11.png" alt="1696818064010"></p> <p>参考代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/json&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">&quot;json&quot;</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;码路教育&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">culture</span><span class="token operator">:</span> <span class="token string">&quot;为学员服务&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>启动服务，如下：</p> <p><img src="/javablog/public/assets/img/1696818135758.b73aba9b.png" alt="1696818135758"></p> <p>开始写前端代码：</p> <p><img src="/javablog/public/assets/img/1696818286331.eaea5162.png" alt="1696818286331"></p> <p>分析网络面板：</p> <p><img src="/javablog/public/assets/img/1696818350661.5fadf55b.png" alt="1696818350661"></p> <p><img src="/javablog/public/assets/img/1696818394010.11a8666c.png" alt="1696818394010"></p> <p>浏览器的地址栏也可以发get请求，如下：</p> <p><img src="/javablog/public/assets/img/1696818455603.04a25713.png" alt="1696818455603"></p> <p>使用postman也可以发请求，如下：</p> <p><img src="/javablog/public/assets/img/1696818508400.42655095.png" alt="1696818508400"></p> <h3 id="_4-响应xml数据"><a href="#_4-响应xml数据" class="header-anchor">#</a> 4，响应XML数据</h3> <p>关闭上一个服务，如下：</p> <p><img src="/javablog/public/assets/img/1696818573022.bb3330a8.png" alt="1696818573022"></p> <p>重开一个服务，如下：</p> <p><img src="/javablog/public/assets/img/1696818609970.a5897ad7.png" alt="1696818609970"></p> <p>参考代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/xml&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">&quot;xml&quot;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
        &lt;content&gt;
            &lt;name&gt;码路教育&lt;/name&gt;
            &lt;culture&gt;为学员服务&lt;/culture&gt;
        &lt;/content&gt;
    </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>启动服务，如下：</p> <p><img src="/javablog/public/assets/img/1696818659760.2d65530d.png" alt="1696818659760"></p> <p>开始写前端代码：</p> <p><img src="/javablog/public/assets/img/1696818793093.2f51131b.png" alt="1696818793093"></p> <p>分析网络面板，如下：</p> <p><img src="/javablog/public/assets/img/1696818829171.8c5db6df.png" alt="1696818829171"></p> <h3 id="_5-响应的状态status"><a href="#_5-响应的状态status" class="header-anchor">#</a> 5，响应的状态status</h3> <p>看一下我们之前响应的状态码：</p> <p><img src="/javablog/public/assets/img/1696818892073.c268de51.png" alt="1696818892073"></p> <p><img src="/javablog/public/assets/img/1696818910485.fa111315.png" alt="1696818910485"></p> <p>除了200状态吗，还有一些其它的状态码，如下：</p> <p><img src="/javablog/public/assets/img/1696818938009.2c5d0e85.png" alt="1696818938009"></p> <p>演示404，如下：</p> <p><img src="/javablog/public/assets/img/1696819045316.c0455cf2.png" alt="1696819045316"></p> <p><img src="/javablog/public/assets/img/1696819063344.bb12e67b.png" alt="1696819063344"></p> <p>再演示一个500，如下：</p> <p><img src="/javablog/public/assets/img/1696819203540.9c0a284a.png" alt="1696819203540"></p> <p><img src="/javablog/public/assets/img/1696819240405.bfa19b3a.png" alt="1696819240405"></p> <p><img src="/javablog/public/assets/img/1696819269395.2abe3e9c.png" alt="1696819269395"></p> <p>在后端代码中设置的状态码是200，实际上运行程序，得到的状态码，不一定都是200，如下：</p> <p><img src="/javablog/public/assets/img/1696819377974.6d9cd0c5.png" alt="1696819377974"></p> <p>对于http的状态码设置，并没有强制要求，理论上你爱设置什么就设置什么，现实中我们还需要遵循http的规则，测试如下：</p> <p>后面再去演示案例，先停止上一个服务，以后就不说了。后端代码：</p> <p><img src="/javablog/public/assets/img/1696819548517.75e35d6f.png" alt="1696819548517"></p> <p>参考代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/status/500&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/status/503&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">503</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token number">503</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/status/403&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">403</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token number">403</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/status/404&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">404</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">ok</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>启动服务，如下：</p> <p><img src="/javablog/public/assets/img/1696819578945.8b7f8a8a.png" alt="1696819578945"></p> <p>开始写前端代码进行测试，如下：</p> <p><img src="/javablog/public/assets/img/1696819675670.dd9b9c4a.png" alt="1696819675670"></p> <p><img src="/javablog/public/assets/img/1696819688336.2a0e40b2.png" alt="1696819688336"></p> <h3 id="_6-url地址的编码和解码"><a href="#_6-url地址的编码和解码" class="header-anchor">#</a> 6，URL地址的编码和解码</h3> <p><strong>情况1</strong>：基于 encodeURI/decodeURI 对整个URL进行编码解码。</p> <p>特点：只处理了中文和空格等，对于比较特殊的字符（例如：// : ? # &amp; 等）不处理。</p> <p>代码演示：</p> <p><img src="/javablog/public/assets/img/1696831991297.ff130b86.png" alt="1696831991297"></p> <p><strong>情况2</strong>：基于 encodeURIComponent/decodeURIComponent 对URL地址中的某一部分进行编码和解码</p> <p>特点：在encodeURI的基础上，还会对 “// : ? # &amp;” 等特殊符合编码</p> <p>代码演示：</p> <p><img src="/javablog/public/assets/img/1696832143831.8923d34b.png" alt="1696832143831"></p> <p>如果url中有中文件或空格，或特殊符号，我们会对它进行编码，如下：</p> <p><img src="/javablog/public/assets/img/1696832233178.3e893c38.png" alt="1696832233178"></p> <p><strong>总结：</strong></p> <p>还可以基于 escape/unescape 达到类似于 encodeURIComponent 的效果，只不过：escape一般只有前端有，后端语言中很少具备这个API！所以，建议大家还是使用 encodeURIComponent或者encodeURI（因为大部分后端语言，都具备这样的API）！</p> <h2 id="二-给服务器传递参数"><a href="#二-给服务器传递参数" class="header-anchor">#</a> 二，给服务器传递参数</h2> <h3 id="_1-我们可以给服务器传递哪些参数"><a href="#_1-我们可以给服务器传递哪些参数" class="header-anchor">#</a> 1，我们可以给服务器传递哪些参数</h3> <p>我们传递给服务器的参数可以有：</p> <ul><li>查询字符串数据（query参数）  get和post都可以</li> <li>路径参数（params参数）  get和post都可以</li> <li>表单数据（urlencoded格式的字符串）</li> <li>formdata数据</li> <li>文件数据</li> <li>上传JSON数据</li> <li>上传XML数据</li> <li>通过请求头传递数据</li></ul> <h3 id="_2-查询字符串数据-query参数"><a href="#_2-查询字符串数据-query参数" class="header-anchor">#</a> 2，查询字符串数据（query参数）</h3> <p>后端代码如下：</p> <p><img src="/javablog/public/assets/img/1696832485917.67469859.png" alt="1696832485917"></p> <p>参考代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/get&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/get/:name/:age/:address&quot;</span><span class="token punctuation">,</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> ctx<span class="token punctuation">.</span>params<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>运行服务器：</p> <p><img src="/javablog/public/assets/img/1696832524678.6134ccac.png" alt="1696832524678"></p> <p>前端代码，如下：</p> <p><img src="/javablog/public/assets/img/1696832655981.3af89f73.png" alt="1696832655981"></p> <p>分析network面板：</p> <p><img src="/javablog/public/assets/img/1696832806510.89adb977.png" alt="1696832806510"></p> <p>点击view source 和 view URL-encoded，如下：</p> <p><img src="/javablog/public/assets/img/1696832952496.38e7de9c.png" alt="1696832952496"></p> <p>把bj变成“北  京”, 测试如下：</p> <p><img src="/javablog/public/assets/img/1696832997442.776bd16f.png" alt="1696832997442"></p> <p>再查看之，如下：</p> <p><img src="/javablog/public/assets/img/1696833052552.37508ae1.png" alt="1696833052552"></p> <p><img src="/javablog/public/assets/img/1696833118637.55de9e5a.png" alt="1696833118637"></p> <p>现在我们通过postman发请求，如下：</p> <p><img src="/javablog/public/assets/img/1696833228879.b1282a81.png" alt="1696833228879"></p> <h3 id="_3-路径参数-params参数"><a href="#_3-路径参数-params参数" class="header-anchor">#</a> 3，路径参数（params参数）</h3> <p>后端代码同上。</p> <p>上前端代码，如下：</p> <p><img src="/javablog/public/assets/img/1696833349645.51e5c9ba.png" alt="1696833349645"></p> <p>分析network面板，如下：</p> <p><img src="/javablog/public/assets/img/1696833389139.d4660142.png" alt="1696833389139"></p> <p>上面的面板中没有所谓的payload。再通过postman查看之，如下 ：</p> <p><img src="/javablog/public/assets/img/1696833483598.448cdd74.png" alt="1696833483598"></p> <p>测试，使用中文，会不会编码，如下：</p> <p><img src="/javablog/public/assets/img/1696833511055.632dd028.png" alt="1696833511055"></p> <p>浏览器中测试之，如下：</p> <p><img src="/javablog/public/assets/img/1696833544420.5d0db492.png" alt="1696833544420"></p> <h3 id="_4-表单数据"><a href="#_4-表单数据" class="header-anchor">#</a> 4，表单数据</h3> <p>后端代码如下：并运行起来了</p> <p><img src="/javablog/public/assets/img/1696833850477.2436b246.png" alt="1696833850477"></p> <p>参考代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/post&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>前端代码如下：</p> <p><img src="/javablog/public/assets/img/1696833959513.c0a6620a.png" alt="1696833959513"></p> <p>分析面板，如下：</p> <p><img src="/javablog/public/assets/img/1696834022525.cd1ba05f.png" alt="1696834022525"></p> <p><img src="/javablog/public/assets/img/1696834093629.f44b53b6.png" alt="1696834093629"></p> <p><img src="/javablog/public/assets/img/1696834147322.ba6ae8f9.png" alt="1696834147322"></p> <p>现在去看一个请求头，如下：</p> <p><img src="/javablog/public/assets/img/1696834298144.7a231660.png" alt="1696834298144"></p> <p>如果有中文，如下：</p> <p><img src="/javablog/public/assets/img/1696834320409.58fa9565.png" alt="1696834320409"></p> <p><img src="/javablog/public/assets/img/1696834381666.c6428d6b.png" alt="1696834381666"></p> <p>能不能通过ajax发一个表单类型的数据呢？</p> <p>答：能，直接上代码，如下：</p> <p><img src="/javablog/public/assets/img/1696834660258.c669d7bc.png" alt="1696834660258"></p> <p>分析面板，如下：</p> <p><img src="/javablog/public/assets/img/1696834688955.541d2152.png" alt="1696834688955"></p> <p><img src="/javablog/public/assets/img/1696834712600.84ca89f1.png" alt="1696834712600"></p> <p>看请求头，如下：</p> <p><img src="/javablog/public/assets/img/1696834736605.1ab27d48.png" alt="1696834736605"></p> <p>现在使用postman发请求，如下：</p> <p><img src="/javablog/public/assets/img/1696834851707.84ebeeca.png" alt="1696834851707"></p> <h3 id="_5-formdata数据"><a href="#_5-formdata数据" class="header-anchor">#</a> 5，formdata数据</h3> <p>后端代码如下：</p> <p><img src="/javablog/public/assets/img/1696834924454.1baac8fc.png" alt="1696834924454"></p> <p>参考代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 之前: body-parser</span>
<span class="token comment">// 现在: koa-body</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">multipart</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/post&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>前端代码：</p> <p><img src="/javablog/public/assets/img/1696835142854.54177226.png" alt="1696835142854"></p> <p>分析面板：</p> <p><img src="/javablog/public/assets/img/1696835222879.d4b851ea.png" alt="1696835222879"></p> <p>再去看一个请求头，如下：</p> <p><img src="/javablog/public/assets/img/1696835250365.b412df18.png" alt="1696835250365"></p> <p>formData是一个容器，可以直接把一个表单放到这个容器，如下：</p> <p><img src="/javablog/public/assets/img/1696835402350.a73cf646.png" alt="1696835402350"></p> <p>分析面板和上面是一模一样的。</p> <p>在postman中测试之，如下：</p> <p><img src="/javablog/public/assets/img/1696835513462.ee0b70a5.png" alt="1696835513462"></p> <h3 id="_6-上传json数据"><a href="#_6-上传json数据" class="header-anchor">#</a> 6，上传JSON数据</h3> <p>后端代码如下：</p> <p><img src="/javablog/public/assets/img/1696836492141.f47daf3f.png" alt="1696836492141"></p> <p>参考代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 之前: body-parser</span>
<span class="token comment">// 现在: koa-body</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">multipart</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/post&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>前端代码：</p> <p><img src="/javablog/public/assets/img/1696836573978.8b3de3ac.png" alt="1696836573978"></p> <p>分析面板，如下：</p> <p><img src="/javablog/public/assets/img/1696836635021.26da5b8f.png" alt="1696836635021"></p> <p>看一个请求头，如下：</p> <p><img src="/javablog/public/assets/img/1696836654659.c2df05eb.png" alt="1696836654659"></p> <p>使用postman发json数据，如下：</p> <p><img src="/javablog/public/assets/img/1696836737136.a7f28d23.png" alt="1696836737136"></p> <h3 id="_7-文件数据"><a href="#_7-文件数据" class="header-anchor">#</a> 7，文件数据</h3> <p>后端代码如下：</p> <p><img src="/javablog/public/assets/img/1696836876395.186a8737.png" alt="1696836876395"></p> <p>参考代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 之前: body-parser</span>
<span class="token comment">// 现在: koa-body</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">multipart</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> file <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>files<span class="token punctuation">.</span>file<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>

    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'文件上传成功'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>先不使用ajax传文件，先使用传统的表单传文件，如下：</p> <p><img src="/javablog/public/assets/img/1696837333418.67b02f44.png" alt="1696837333418"></p> <p>浏览器测试之，如下：</p> <p><img src="/javablog/public/assets/img/1696837323432.fd2357ed.png" alt="1696837323432"></p> <p>看面板，如下：</p> <p><img src="/javablog/public/assets/img/1696837425284.c981ff15.png" alt="1696837425284"></p> <p>看请求头，如下：</p> <p><img src="/javablog/public/assets/img/1696837450110.51b3725e.png" alt="1696837450110"></p> <p>通过postman上传一个文件，如下：</p> <p><img src="/javablog/public/assets/img/1696837559828.e43957b3.png" alt="1696837559828"></p> <p>现在使用ajax上传文件，如下：</p> <p><img src="/javablog/public/assets/img/1696838004335.d0091267.png" alt="1696838004335"></p> <p>看面板，如下：</p> <p><img src="/javablog/public/assets/img/1696838037243.33bf9061.png" alt="1696838037243"></p> <p>看请求头，如下：</p> <p><img src="/javablog/public/assets/img/1696838055690.c978bd2a.png" alt="1696838055690"></p> <h3 id="_9-通过请求头传递数据"><a href="#_9-通过请求头传递数据" class="header-anchor">#</a> 9，通过请求头传递数据</h3> <p>可以把数据放到请求头，传递给后端，不写后端代码，直接上前端代码，如下：</p> <p><img src="/javablog/public/assets/img/1696838185347.a5da227c.png" alt="1696838185347"></p> <p>面板中看请求头，如下：</p> <p><img src="/javablog/public/assets/img/1696838213893.96f26329.png" alt="1696838213893"></p> <p>后端从请求头中，也可以得到的你传递的数据。</p> <h3 id="_10-延迟时间timeout和取消请求"><a href="#_10-延迟时间timeout和取消请求" class="header-anchor">#</a> 10，延迟时间timeout和取消请求</h3> <p>在网络请求的过程中，为了避免过长的时间服务器无法返回数据，通常我们会为请求设置一个超时时间：timeout</p> <p>自动取消请求，代码如下：</p> <p><img src="/javablog/public/assets/img/1696838434197.2b7d13df.png" alt="1696838434197"></p> <p>浏览器测试之，如下：</p> <p><img src="/javablog/public/assets/img/1696838425002.e492ccc4.png" alt="1696838425002"></p> <p>也可以手动取消请求，如下：</p> <p><img src="/javablog/public/assets/img/1696838500186.635153d5.png" alt="1696838500186"></p> <p>浏览器测试之，如下：</p> <p><img src="/javablog/public/assets/img/1696838538573.ac789b51.png" alt="1696838538573"></p> <h2 id="三-ajax小案例"><a href="#三-ajax小案例" class="header-anchor">#</a> 三，Ajax小案例</h2> <h3 id="_1-检测用户名是否存在"><a href="#_1-检测用户名是否存在" class="header-anchor">#</a> 1，检测用户名是否存在</h3> <p>后端代码如下：</p> <p><img src="/javablog/public/assets/img/1696900114409.d88681f7.png" alt="1696900114409"></p> <p>参考代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 模拟从数据库中取到的用户信息</span>
<span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;wc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;xq&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/check&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> username <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token operator">=&gt;</span> user <span class="token operator">===</span> username<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;对不起,该用户名已经被注册,请换个用户名&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;恭喜你,该用户可以使用&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>前端代码：</p> <p><img src="/javablog/public/assets/img/1696900619556.165ee40c.png" alt="1696900619556"></p> <p>参考代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>用户注册<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>post<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>用户名：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>密码：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pwd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>确认密码：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>repwd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>注册<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">let</span> user <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#user&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> msg <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#msg&quot;</span><span class="token punctuation">)</span>

        user<span class="token punctuation">.</span><span class="token function-variable function">onblur</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// this 表示事件源  this.value 表示输入框中的内容</span>
            <span class="token keyword">let</span> username <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>

            <span class="token keyword">let</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> res <span class="token operator">=</span> xhr<span class="token punctuation">.</span>response<span class="token punctuation">;</span>
                <span class="token comment">// console.log(res);</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    msg<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> res<span class="token punctuation">.</span>msg
                    msg<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    msg<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> res<span class="token punctuation">.</span>msg
                    msg<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'green'</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token string">&quot;json&quot;</span>
            xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://127.0.0.1:3000/check&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/x-www-form-urlencoded&quot;</span><span class="token punctuation">)</span>
            xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">username=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>username<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p>强调：</p> <ul><li>传递给后端的数据格式是 application/x-www-form-urlencoded</li> <li>后端给我们响应的是json格式   xhr.responseType = &quot;json&quot;</li></ul> <p>分析Network面板：</p> <p><img src="/javablog/public/assets/img/1696900797453.d0826acd.png" alt="1696900797453"></p> <p><img src="/javablog/public/assets/img/1696900816438.630e01e5.png" alt="1696900816438"></p> <p>同样上面的接口，让你使用postman发请求，如下：</p> <p><img src="/javablog/public/assets/img/1696900947500.ea9f5be8.png" alt="1696900947500"></p> <h3 id="_2-省市区三级联动"><a href="#_2-省市区三级联动" class="header-anchor">#</a> 2，省市区三级联动</h3> <p>后端代码如下：</p> <p><img src="/javablog/public/assets/img/1696901185241.f980712f.png" alt="1696901185241"></p> <p>参考代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// data表示服务器端的所有的数据</span>
<span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./cityData.min.json&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 响应所有的省份</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/province&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> province <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// item代表每一个省的所有数据</span>
        province<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>n<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// json有两种形式：1）对象的形式 2）数组的形式</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> province<span class="token punctuation">;</span> <span class="token comment">// 响应给xhr一个json字符串  [&quot;北京市&quot;,&quot;河南省&quot;,&quot;河北省&quot;...]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 根据省份，响应对应的市</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/city&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> province <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>province<span class="token punctuation">;</span>
    <span class="token keyword">let</span> cities <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>n <span class="token operator">===</span> province<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            item<span class="token punctuation">.</span>s<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item1</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                cities<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item1<span class="token punctuation">.</span>n<span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> cities
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>前端代码：</p> <p><img src="/javablog/public/assets/img/1696901967460.7a13234b.png" alt="1696901967460"></p> <p>参考代码，如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>省市区三级联动<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>请选择省份：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>province<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>--省份--<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>city<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>--市区--<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>country<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>--区县--<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">let</span> province <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;province&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> city <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;city&quot;</span><span class="token punctuation">)</span>

        <span class="token comment">// 获取所有的省份</span>
        <span class="token keyword">let</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 第一步：创建xhr对象</span>
        xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://127.0.0.1:3000/province&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 第二步：建立连接</span>
        xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 第三步：发出请求  null可写可不写</span>
        xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token string">&quot;json&quot;</span><span class="token punctuation">;</span>
        xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> provinceData <span class="token operator">=</span> xhr<span class="token punctuation">.</span>response<span class="token punctuation">;</span>
            <span class="token comment">// console.log(provinceData);</span>
            <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;option value=&quot;&quot;&gt;--省份--&lt;/option&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
            provinceData<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                str <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;option value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/option&gt;</span><span class="token template-punctuation string">`</span></span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token comment">// console.log(str);</span>
            province<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> str<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        province<span class="token punctuation">.</span><span class="token function-variable function">onchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 叫查询字符串传参，至于如何传参，后端定的。</span>
            xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://127.0.0.1:3000/city?province=&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span>
            xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// send()中放的是请求体   get请求没有请求体</span>
            xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> cityData <span class="token operator">=</span> xhr<span class="token punctuation">.</span>response<span class="token punctuation">;</span>
                <span class="token comment">// console.log(cityData);</span>
                <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;option value=&quot;&quot;&gt;--市区--&lt;/option&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
                cityData<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    str <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;option value=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/option&gt;</span><span class="token template-punctuation string">`</span></span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token comment">// console.log(str);</span>
                city<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> str<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>强调：</p> <ul><li>获取所有的省份时，没有给服务器传递数据，服务器响应了json数据</li> <li>获取所有的市时，给服务器传递了查询字符串，服务器响应了json数据</li></ul> <p>分析Network面板：</p> <p><img src="/javablog/public/assets/img/1696902132682.452bae92.png" alt="1696902132682"></p> <p><img src="/javablog/public/assets/img/1696902203661.3de54a3e.png" alt="1696902203661"></p> <h3 id="_3-传统ajax分页"><a href="#_3-传统ajax分页" class="header-anchor">#</a> 3，传统ajax分页</h3> <p>把mongodb安装到自己的电脑上，软件如下：</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJwAAAB3CAYAAAD2OykMAAAMiklEQVR4nO2db2wT5x3HP27jRHFip6hJYMA6CEkZjEqtwhhNJlGtiCm0i0Co9A2C/lnjvYC6EmrXtJXaqQgxVdWw2qly2q3NRNeuEwNlbfyiaFChhK1qRLsGaHFK1lIiCGkhCXFInNZ7cX7s89mOnUDuYvv3kZBzd49/z3P219/7PX/usDVubwsjCCZxg9UNEPILEZxgKiI4wVREcIKpiOAEUxHBCaYighNMRQQnmIoITjAVEZxgKiI4wVREcIKpiOAEUxHBCaYighNMpcDqBmRCeOIKNzmLrG6GpVweHsNWUGp1M66ZrBDcTc4iQuFiJr773uqmWELBjTcwx2XjctDqllw7WSE4gInvvmc8lJ+CAyjMkeQnawRnNstKOiyp99RIvSX1mkWO/G6EbEEczsDq+d0ANDfvMaW+Dz74AIDOzk4A2n7fCEDj9jZT6jcbcTjBVMTh0mCz/W7GYofDz85Y7NmKOJxgKuJwGdL0UXI36qoFX+Rvd+RVba9U7+2Kf0/LyplzzdmOCG6adNVqrz4Shaa2E4TWZdiRh8glVTAVcbgponc20NzM6Gy14mwpEYcTTEUcLkOSOZvaFmfLHHE4wVTE4TIk1dCHG3G2qSAOJ5hKXjmcmpifjKeeegqA5ubmuP2pxtr07pbO2WojiWAX76ZtR64iDieYSl44XGzJUXPKMjabDYDdu3cnPX49nE0QhxNMJqcdTjnb559/DsADDzyQtFxra2vaWCkn4idxN3G2RMThBFPJSYczOlsqlLPte+MNtqRwvyiRhZgtU2hHPvdGU5F1gstkaEOxdOlSIFF4eqGlIx9X5c4kckkVTCXrHO7ffSuAzIY6FKqzMBVnU3dTCdcXcTjBVLLO4RTK6VINdeiZirOpqS2raGvT7kfdvHkzAOt+/Y6VzbnuiMMJppK1DqdQPdHrRaqprZlmxQrNsbu7tdz06tWrlrRjphGHE0wl6x1OMVlvdSp5mTHOK6+8Mmn5L7/8Mvr3nj3X/jwS5XC5ijicYCo543DXiyeffDJu+9J9VQD4IvPwXYbJ+lWroK/vXgBWrlwZd2zTpk1p66urq5tuU7MScTjBVMThImzbtg2AQ1X3AVDL1G+EefZZbd516NtvAfjDSy8Bia6o58iRI9p7hoamXF82Ig4nmEpeOtxXfX0A3DJ/PgDvHz5M944d2sEu9aIlbbXKnSI5XG1t5EaYJK6lnE3x4osvArBz58647WS4XC4g1qPO1Sdg5pXgjEJT23GoRboGPbkj2z7DIl7VYdCzcNEiANasWRO3/6677krbxlwVmkIuqYKp5JXDGZ1NLczctWsX7QsvANCinC06DBJ/aVVO16RzOnUpNTrbZ599BsC+ffsA2LJlCwAL7szfRZ3icIKp5JTDqUQ+VWJvzOH0S8/Xfz1X+6P2Qtx71D0MqhPRFRncVfvb2mI5nNHZAoHAdE8lZxGHE0wlZxyuq6srwdnUtiJV77S9vT1l3KbIq9ut3XNv7EU2NjZy6tQpIOZsBw4cmMYZ5AficIKp5IzD1dbWTjuHMzohQF+yMboUpHI0tahSsX///oxj5iricIKp5IzDXUsOB+kdTU2yG2cLzp49m1D2+PHjGbY6/xCHE0wlZxzuWnK4ydxNTaqXlmplP/pIe1Lcykjo9oUXYmN4Ee64445pn0euIw4nmErOONx0cjh1g/S8efOor4//r7+VsxmJhozMsbpbuvA1xddjdLwNGzYA+T2HqsgZwU3lkmpcc3b+fGy4IpXQEusjUkct7siMvxKeWgggJCKXVMFUbI3b28JWNyIdZcUhRieKGA99n3BMPUVp3bp1KS+p6oHRimSLHOcMay734IMPxu1XnQVF1Nkik/nuLogZabzTtazUpsOu9VJaaL8Bh32cy8HsvyCJwwmmkvUO1/ZyY8ZxMlm+rZxOsWNH/H2jkzlcbYs7ruz16iSIwwnCNMl6h5tpjI6nSPYMkJka9hCHE4Rpkv0/mRnmkjP580EW3Jn+uSFCIlkjuIIb89eMCwputLoJ142sENzl4THmuGwU5q/muDR0FVtBqdXNuGayQnC2glIuB61uhbXkgthAOg2CyYjgBFMRwQmmIoITTEUEJ5hKVvRSs5XQeJCJsSuExkYAsBeVxI7p9hUUlWIvdFjSRrMRh5tBJsau8H7rn9nw/KMc3nqC4FA/waF+Ft//MIefDzP+tofgUD8TY1esbqppiMPNIMrFFMHh/oQyweF+7EUlFDvNapW1iOBmkATBDSXe6xAcuoDDWWlWkyzHEsHpcxvjl5IMe1FJNNcBkr5XlYnWkSJ2JrGmWqfKwYznNdAXv4RpdPhiQnu+6euGyBJ4Y7xcxBLBTYxdYfH9D+PDTf3px+nwVGsHerzU1zwGewOxffhx29ZzYuNu7EXal33kqzCBDg/Vuph+t43nzj0NwIfvHWZvoANPwBA/WSxXDeE3GqJxerxu3rvHhyfg5uevLsqoToezkomiEkJjIwnx8Hvxpvog6vZyTB/T7+Znf6zQHM81NydFZ43DKZdo8NF6up4lt5dzpuQXBDo8dIQ94Hez5PbznPlkHu1hH772Jn783KfYi0rpXraRcEcDfreNjacewV5UwvHgIgIdYd701vPL18tjFenjJ4nl2vQEYU81freNJ049AkBdcwu+aiAAgwO9WvyqdZPWuXH/T2LlfA3ReKPD/dy9+2A0XhzVHjpavdTbbHy9bC1fzbmXQIePN0/Xs/ndVVqZHBSdJb3UqOB6vGx7rJPQ+Ag/vPRPXvAD+HGvbyE43M+8qv9y0A/ULOfmD9+i+6iNdl8DPd563EfvJhTp3S2d+A/bvD1Ue55h7Se6+xb08Zd9wS5vDzRsYE0k1jOe6rhYobErtKyvx9ujvX1w4AzHDwXT1ll39NWU5fTx4vHjrnmMExXa/+VVNfKvaLyfHtrLwLluvjn3Kd+c647+GxroZXS4n9B49q5ksCyHAyBwko9dcykb032APafpBkYjPbru0z1QEzlWt5waIHCyk9Hh2yhU+dV4kM6TAaCG5XVAJ6njM3ksPUMDvVD3q8zqJH28OCLnqTDGazl6gr2BFqLZAD1462t4r+a1yePOcizvpTpclbgqFifud85NUjqGvbAUV/liyhesmLRcqvjJYmnEEvuEjkSGdaaKl7R9zrm6sjF+UBXmtYea+LvumP0WL/ZJo81+LBecvbA06bCAvscZpfMkAaBmeR0cir/3p255DRDgZGf8W1LFTx1rBbfqc66M68wwnqL6VlYAX+t6100bGqDHyzudQFVik2O95P7kn4+B2djjtXymQRsKKMWe7hIEQAu7vD1Uezr409pjDA30MnCum+NV6+jwVON3r48+zj59/BYO+qHa08pv52mxhgZ6aWr30aB7b/nCY2nrfL2oFIfrYNp48TTga28iOHyBoYFejletw9cA/he0vK7YWZEgqtD4CB0H/sfT/2jm8NYTDA70cuTtEzzx1qNJt2fjLIYlDqf/xRU7K5L+AoudFQn7ysqrOLHrl9hOvkzYFyaWi/fgrbex5/xqysr7GRyIj6Pihw2x/rZ1CfzlC3wdYTyR/X53Pd6aDjxognM453L+9Z3YTv4mZZ03L9DKtm2/E14+ljJe3Dn1eHGffpyLZ2MDLX63jYcOrebm+ZWUL7yNsvLFFOvcWctrD3O6B52Iu9Nszy4suS91aKCXwYHe6HZZJE8ZHOhl8OIZbV9F7JoyePEMofER7IXaL1798jXnKolcarRfssq7VPmyiqqE+KlijQ7388XHF6NjePO3f4qrYjEOZ2V0liBZnan2ae25ok1fRdpiPCeHszKuLIDDNVcTm2FYZHRYm4tNNkWWDIezEoerMk60VmONwxWVxOVV6kvX70uX1yUb8U92XPtCE+Pry6ghkdDYCNRt5p5q8L/Qgr1oLQ5nJWXli6OCSlanqiM0NkJwuD9JudKEc1b169usj2cUW65gieAKikpxuOK3ARwuvePEfxHGfZlMban9yeIDjK9eTyvbuPevPyI43M/ZU0toD3uo7vGyrQWKV1XEvvyog6We2iooCiYthzOxfUYBJ4uX6nPLpMNgPPfZQlY86mEmCI0HGR26wK1bH8WnT3j8bioeOUaxq5LyBVoelWzYQpgeeS+40NgIofGRqCupS6vKo2ZbDpTtWD4ON5vQX/ZUwj3bLknZTt4Kzl7o0CbH1XKiwljONxsHTHOFvBUcaKKzFzryZrXtbMDymQYhvxDBCaYighNMRQQnmIoITjAVEZxgKiI4wVREcIKpiOAEUxHBCabyf0Q/eg56ouwSAAAAAElFTkSuQmCC" alt="1696904660565"></p> <p>安装也是傻瓜式安装，安装后完，你的电脑也可以提供数据库服务了，你电脑上就有这个服务，如下：</p> <p><img src="/javablog/public/assets/img/1696904743721.b84671a7.png" alt="1696904743721"></p> <p>你还需要安装一个软件，去连接Mongodb服务器，如下：</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANUAAADBCAYAAABYB/UOAAAcF0lEQVR4nO2deXhU1d3HP5PEmQzJxBLj+4aEPVuxqGh4QaEIKlQRSvXV2lpwF/JaFNyqorVatRZR3rIjaKsIb11axFILCqi4QassYlHICggJiYZE5pJMZsjy/nHnTiaTmbkzyc12+X2eJ89k7pw558w987vfc8495zuWKXesb0IQBMOI6eoKCILZkKASBIORoBIEg5GgEgSDkaASBIORoBIEg5GgEgSDkaASBIORoBIEg5GgEgSDkaASBIORoBIEg5GgEgSDkaASBIORoBIEg5GgEgSDkaASBIORoBIEg5GgEgSDkaASBIORoBIEg5GgEgSDkaASBIORoBIEg5GgEgSDkaASBIORoBIEg5GgEgSDkaASBIORoBIEg5GgEgSDkaASBIORoBIEg4nr6gq0l34ZqV1dhVOSw8XlXV2FbktszojrHuvqSrSH05MTyeqbyKj0BpriE+SxEx4LKptwVp/o6qbvtlh6+m/+9stIZfKQWN7a1xDV++rrjpOUYO2gWvUMlNqTxNqSonpPVt9ECo+cEKUKQ4/v/gHkK3YguitnUoKVxrgE6ht69DWlzcTFWkhKqKWmPrr35ThcFHZMlUyDKYKqrQ1d39BEff2pGVQAMU2NUb+nLRewUw1TBFVPaejE8rVdUu6J1KsNy0uUSh9TTKnnOFxdXYVTBvUCJoRDlKoTSHdtAWDO3LmdUt4HH3wAwLZt2wB4+u4RAMz8w6ftzluUSh9RKiEqRKn0EaXqAiyW33ZY3k1Nj3ZY3iBKFQmiVEJUiFLpI0rVhczYEVxVdubCCu//ed5H7flw7b07W75n5fCOUz9/RKn0MUVQmaWhd+aqjytoHUza81bBtDPgQAfTUy9gnYkpun/SJek8pKutjyhVN8BfoUBVpUCFyu1ihdIQpdJHlEqIClEqfUSpupBgCqU9724KpSFKpY8olRAVolT6iFJ1IaGmzfPofgqlIUqljyiVEBWiVPqIUrUTbbFsOB566CEA5syZ0+J4qHtR/iqlp1C53oHZTt7SrYcRiFLpI0olRIUolT6iVG3Et50jQH38sVgsADz11FNBXzdCoTobUSp9RKmEqBCl0keUKko0hcrPzwfgpptuCppu1apVunmFXBwbRqW6SqE0RKn0EaUSokKUSh9RqggJVKhQaAq15qWXmBZCxXx4NyuujKIenTXLFwpRKn1MEVTtbehIpsU1cnJy1DIDgss/mPTo6N25HUlPvdHemZii+yddks5Dutr6iFIBpfbxQGTT5BraBEU0CqW5HPVkRKn0EaUSokKUSh9RKj80xQo1Te5PNAqlLVPqKtavXw/AtddeBMCtv/+wzXmJUukjSiVEhSiVPqJUQdBm+Iwi1DKljmbo0KEA7N27F4C6urp25ylKpY8olRAVolT6iFKFIdwsYDTjpMB8li9fHjb9oUOHfP/PNcB/XVMqIxCl0keUSogKUSp9RKk6gQcffLDF8+qfDgZghXdt7M6ABbQjRkBZ2WQAhg8f3uK1q6/W/62pUaNGtbWquohS6SNKJUSFKJU+olQdyI033gjAlsE/BSCX6M1bHn1UXSforKoC4A+LFwOt1c2frVu3qu9xOqMuTw9RKn1EqYSoEKXSR5TKIL4uKwOgf1oaAJvff5+9d96pvrhTe1AHUbmaynjHVLm5XvOWIOqjKZTG/PnzAbj33ntbPA9GUlIS0DxTKb+k2DmYIqi6sqEDg0l73gJts25AzOR5n68I2MyrTVL403fgQADGjh3b4vi4ceN062hEMGl0hwtYd8cU3T/pknQe0tXWR5SqnQQqlLZ58cknn2RD3woAVmoK5ZtCb9kN1BRrhp9iad2+QIXav38/AGvWrAFg2rRpAFwwLfwNZaMQpdJHlEqIClEqfUSpdNAmD0JNJgSOqfy32V9x5D/Vf3IrWrxH86TQJi52em/wasfXr28eUwUqVGFh104TiFLpI0olRIUolT6iVGHYuXNnK4XSnmuEmvXbsGFDyHxneB/z8lRv2sDZuSlTRrBv3z6gWaHWrVvXhk9gPKJU+ohSCVEhSqWPKFUYcnNz2zymClQ0gLJg97BCEEqZtI2HGmvXro04TyMQpdJHlEqIClEqfUSpwtCeMRXoK5O28HXcuBEtjh8+fLhV2t27d0dY645FlEofUSohKkSp9BGlCkN7xlThVEpb6JqYqKbdsUP9parh3qw39K1ovsfl5bzzzmvz5zASUSp9RKmEqBCl0keUKgxtGVNpJpupqamMHj26RVpNoQLxZeldE5i3cicrZrQsJ1C5rrzySqDz1vxpiFLpY4qg6qiGjqb7F7hnqfzzpb40oYKpdXl4y8glz7sKVwsubXFuVyP7qfQxRfdPuiSdh3S19RGlCkMk3b9Qu2oTh81k7VpVrW6++eaWryUG/+E4bbNiHs3bQwIVa+VwdWlTZ3f7NESp9BGlEqJClEofUaogaOoTiQttuK3qicNmAvDii0tbHL/zzsh9+XJXqhtCvA9dplAaolT6iFIJUSFKpY8oVRCMNEqBZsXSWLx4adB0e/c2/6S2NnLramUKRJRKH1EqISpEqfQRpeoCApVL44JhnVyRNiBKpY8pgqqtDR0XazG8Lj2F02JjsDRE31HpaRewrsAUQdWWhlZqT+LodQJrx1Sp22NpiMFZ4yHWFh/V+0Sp9DFFULWloWNtSdQ2dEh1egzRBhSIUkWCKSYqZPDcecikkD6mCCpp6M5DLmD6mCKopKE7D7mA6WOKoJKG7jzkAqaPKYJKGrrzkAuYPqfs7F9PxlN3ArdLwe1SALDZHb7X/I/Z7A6s8YmGli2zf/qIUvVA3C6FXVs2Mn7mVF6dVIKzqgxnVRn9xk/h1ZlNuDcvw1lV5gswIxGl0scUQXWqNbTbpeCudVHfCDS4UKrKUarK1eeNHuqcVShV5R0SVKfaBawtmCKoTrWGdrsUPK46NYjqa1GqylCqyrxB5cZzvBpFlKrLMNWYyn+sEckXSht3aGOSYO/1f90/TVvyirZMbUwU+LnKinZz/Fg1DU1AoxtnVTkA9Q1A00nqjlVQWrwLsERVN71zZI1PlDFVBJgiqLSGdrsU+o2fwpONTzCl+EbW39JfTXDwZSZfPp+Y+//efIwPefC8OeT/8Hrfl23P0Rg2rp7KQL+83/vNaOaXqnZgJV8UcO9fnue2kkeYcmB6+LwSBrJv3hRfPgdfeoLN4x5h+qEnuOqvZ0ZUpiM5DZvdgdultMqPTctZGOqEjFrA1k9mk6k9/+AJJq2Ox5Gs2qll/nhq1OcoKTkNa3ziKTcp1BZMEVRaQ7tditoFGvsIC/ZfxbBx8Xxz+gQ+/tstvLX/BtjyAMPGfc03hwexqvgp5s4fy8hndmG1Oygd8hNKVl/Eu3PO5fr88djsDkpODubd1z9hyR9/zlWrLRw/dhJPI3DxEywo8OYfJK/ek2ez75b+vDvnXB7LHw/AyDvn8+xAoMRFZWkhNruDrzMupWD1mJBl3vCPcvXYwEsoeXS0Lz+lupwxc/6PxZlAUcDJyJzFJ6sWMq53ChXZo3D1vYr31z7CkqKfM/29GgD6NwDjIj9HY5aoYWSzO8hXUhGlCo+pxlS+oCpZwfSHt+N2neD08nUs2AzwDjOvfh6l6ij2hG38fTMwoB+Jn61n33YLz/3uIoqXT+KO9/rj8XaLzlQ+Jm/FAQbdehujd7+Ds/I7tYtVtKg5/5R/M2/5AbjkYkZ487rjlv4t8vK4FF6+8SoWFwP1tVSWFvDVPz0sfXxM2DLP2/4XvvjIFbRua6ZexsLAgALgbfKy7uLLxBQAvndsky+/c/75GpWl+XjqoztH9h3rfRMfMqbSxxRBpTW0x1Xj/dJ/yY6mWDyuE3hcJ9SxR9F+PndW46wux1ldzhf5xb7xx/GM/gwGCv/9EUr1Udx16hXdXVfDZ18VAYPIHlpNjdNFE0Bhy/xPNjQCDXhC5OWuq+Gkq5ZG7xiosqwQV0Y/3TIzMyo4Pqhv0HQhKSpgr99Tt6s5v8EZ1VSWFXKyMbpz5FGqUaqO4nYpp9ykUFswRfev9eA5BscZfUhJzwZA24toibOS1LsPoG7S06hvalL/aXRji3eQkp5Fesb5YIEjMRagqVWZ/vnr5QVQVlyLtiXSU6vgcderuYYps6nJg6e+UTe/YCT17sOZfdW033rza3TXohw7SlMTYIn8HDV6PLi9kyUyptLHVErlwxKHLd6B44w+OM7oQ4wFtJkwq92B1e7A4v/Jt31FIZB5VsvfiQI4LzsDKOKrbS2P++cfWV7ZZGf6Pd2RT1EkZUaan0ZmNmfHWX2f02p38IsrxkPRBv66wy9dFOeo0ePGXavgcdWIUkWAKYKqVUNbYrHaHdji1T99VvLkwiIyZ33E8ov3UVlaSGnRLr5KG8vm2wfx9i+vZaV/cktMmPxX8uZGyJz1EnenqnlVlhbysxee5nJvCmsvB2ek/5NnlpWELXOV3YEj+S3+9nb4/FpyOc+tvwmluozK0kK+ShvLognw9v/+mpL0bPUiYGnLOVKRMZU+puj+aV0Sqz2BuFgAK0nJqVjtCQDqMctp2E7vTVJyKgDWuBiwnEZMLwcpvftQ8MwkUg4upXJhOT/y5XyIZZOymH/4fFLSj+JS7Oq1PMbWIn9LXAwQ68vrjek52F7MZ9Gmcu7w5rRp9mUsHPwOswGbPRFH7zSOvf4wKYW3hiwzPVNVjc33j2NW7NaW+d13FYsz1nGnty6+z1m8nJnF93OkIMOX46b7spj58fmkpHm7dTFAbOTnSDtmtSfIfaoIsEy5Y33rAUMPol9GKll9Eyk8coLKsgIqS5t7/Nr4Q72653uP5fheryzNx+06gc2uLjrV7h1ZvTc73d6ZO2heqKqlT0nPaZV/qLyU6nIO7a3kse3vMLvodjLu309KejaO5D4oVWUhywx1DMDjUnBWHfXVJfAzJSX3aZEW8N2ncrsUX/0iOUfasZT0LG66dAhv7WvgcHF55I10imEqpbLZHTi8V1lo/mL7H/P/vzldgu9/t6vG77i2mqD1647k1KD5q2nUL7E2ne6uVTh5zhQmZcLbz/4Jq/0ydZIgLQubPSFkmf43f9VlRy3TaUEXrHz/VSD++fnXL5pzpH1eUSp9TBFUWkPb7A6SvF8caP7CJHm/nP7H/P8Ptwwp2DKlwOP++QPUDx3Ds42/4WevWXFWHaW8JIO/fjuTzKKF3Paag6QLUnH0TvW9T2+ZkvZ/YDoHqa3qp6XzJ9gypbacI5vdIbN/EWCK7t/kIbG8ta97WCN56k7grCpTlwKN8XthywP0vX0LjuQ00jNzSUnPIiUtu8vq2Va0rrZ0/0JjKqXqTnz5+nNMWqXgdtX4xkTqOCqtRdexpyFKpY8pgqq7N7TWdXKgjk0Cu4s9ie54AetumCKoulNDW+MTSUpO841/rAFjsI7Y4t6ZdPcLWHfAFEHV3RraGp+INT4Rh3e5T7QE7p/qyoAM9MP4p60PnrpT14M+Esy5oqIHo010fFpSw9x5U1m3+H94+pyPu7Qu6ZdO4dVfNuDevIwrhvfrkB3FZsIUQWWmpTNul8KerYdYsvo6Gp+/hpETZ/DLrYO7rD75n/6LTL8dlKs3bu+yuvQUTBFUZlIqt0vBPbAvAznAhtc/xll1tMVN384mZ8RI1j7+DGPu2YNy1gSun3hhl9Wlp2CaMdWXIfwpAmfZwvlL+KcJdTPW//X2+E+EKquytBDngIlk0EBDbQVlRf5eEwm+pUd6n60tXhjBcLsUnFXlVJYWYLMnsmjVWup79QOSgqYXTBJU+Yodt+sIu7Zs5O5XluOzWOBD7h96L9uzL6K0oII5b61h+oHQ/hIARbv2BM3jywuu9X2h96ec3Tb/iYMvM2XyApQLrgXg3Bt+xVMD1nD/u1cw75b+8PUrrCyez4yL1eSzP2liNiU895NJHJyxnrkDXub+98b50l573YvUDJlAYU0fNr0yLWg5vjp/d3rIujiS03weFMG4cNZ85g14gYnj5/PA4rn8bnXXjPF6CqYIqhyHi13AkNtvgIfHMaYml8NflfLgxleZ9/c8Jox6HCdnh/WXGLNE9Y3IyZsWNI+J4+dTlj2GM695mH23DojQf6I/K68+lz/WjqTigJMHN77K+r97mDxxMd8OGomnARgwjXn9H2DkxGocyWkoVXk88OY1VC8cxMLRWTzzbS6O3llMagQG3uBLa7U7sA0cRdGZIzj4woCg5Wh1rhg2lYOLB4asi/LDaUHVSlsipe61UkcKT694BXr167zG7YGYakxVs/VjXqzJpbK0gPqGQu6bvwkG9SOjsoLjlU4aGgnpL5G7Yz1KVRkVb74RNI/BlRUUfNaLWbcOiMB/Yi/33DyGTbNG8vgXcZQW7VTzunUpRYMuZuLAaipLC1SvCDYz8+rnvWOn4LNqHpei2gSwyZdWqSqjaOd+fjV9LO/ccX7Qcq4YUEHBZ4e477axYeviDGO86fP98PoJPnbXjTL7p4MplOoHvT1srVI35Y28ZyWLJvi/upGmeg/1NLbwl0hxqTeL/f0lSot3YYt3MGn++63yqHdW892oQX5+EdnYeqnjikD/ifohs5kwCDIWlXMkSH1LhoC7RPOF2MfnzmqU6qMtFgP7465TvBeE5rQel4PajKlcNhgyl1QFLSfr+/XUNUzm8gzIDFMXDoU+tz7fj6aTuI9XM23GTM4YPJo488wNGY4pgurjgmPs/1cViz5dyQS2MKvPLbwS14sTP16Ia1nr9MH8JRpqFY6VXsCbNUu4TC+PCP0nNuZZuGFDDilp2SQlp3q3cBzFkTwaW3zzglRLnBVH7zRfnQ6cFqset6jHAdRqWnxpbb0cuOLUuocqx1mdRv2AprBpHMmjSUmPfMnU2tXPM+PRlyJOfypiiu7fhHP70HD5GCZwgCUTpvGPM9X7Ov/1/WAmDqH9JeqmTeIyikLnEaX/RNZZo9Tyevnvferj2wvV7pO/t0innETidhdQqFMXmz0h4rWIV18/vb21Nj2mCKq/bc+nvqEJ1darmtKiXVT2v50/zcponTisvwRAZpg8ovSfmP0Jq39cRmVpPpWlBRyIGcEbvxmklt/LoXpFtBFbfCIZ57rDluPonUZaxpc8vaQ4bF2sAdP84Vi7+vm2V/oUwRTdv59cmMP2Z19gwvJ+bH7OTd1zQPFyLp21mXcXBVw3QvhLWOKs2Fb/jB/+YBcfB8mjLf4TEyxPsXmZs3ksc2gN1/x0Gykjf66qVRytPCAAep0WC8QQY+9NksPPf8IvraoyCZSGKSc9axxul8J3f/01E2JD1yXcdLrP98Nb9m33PEr8fwylsR3tZXZMsUkxxabw2c6dVJYWtpqZUgJm1VLSs4P6SyhVR31pHMl9WuWhXs3b5z+hvle9getxqXutAj0g/OukHdfwP6btyaosLQxZjobbVRO2LknJaSEX/2q+H1rZq733qVwuufkbClMo1Q+zz2D/Ac1/oSbsiorATYKaH4MjYBt+YB6B/g5t8Z/wR+t2NdcruOdFKL+Iltvfg5fjGzuFSaNHoAfGynUfYLN/D5d5llsajimC6stqa0i/h0ACl++E2jAYbAkSGOc/EZhvqDqFS6vt3dLzudCehzo32i8xhkML+mvGDeP/tn1Dd9m/1h0xRVDlOFwUtnEPUzTv8dSdwLn3I1748Uv8a6PfC5r/RPaFpHu/5JHuqQr2eqj3hUobSTnB0njqTrD73S94dvNsxgZ709evcd0Nq7GOneH7TJ9/E+Mdf0lQhcIUYyrNjKSj0fYXaZ4T/v4TbpeCIzmNlPSssGOU7kQkP5IXuOhWM9kR45fQmEepuqhsM/lPREJ3si7orpgiqDqroc3uPxEJ3c26oDtiiqDqzIZur/9Ed6Itn0WUSh9TrKgw087f7o6ZrAs6ClGqDiDQgchMXUNRKn1EqToAt0th15Z9zJg3lRnxy3wzhmZAlEofUaoA9KaZw3lMaMeVqjJqjruoB6j9hrKiXXjSm9P4K1ao8oLNIIb6oYRgdfGvq5EqKUqljymCysiGVlVmI7P/vJzbSoL7Wfw790oASr44ydJPH+IS76vv/3Yczx6ehOXCayl5YYB68NlCfgQcfOkmHj2Q06Is7b5XKC+L2nMn4ZhwC+tu6s97vxnNU0Xqzsmvv4rlud2PcMmHT3HVX5KB9nlQREN362p3R0wRVEY2tNul4K51qVvIQ/hZDHt8l+/5wOevYeQbyVjtDsZcmYf9HysoKv6c3g+eyZ+/XQB5Fqa/n8vgs8cyaGhzOVpA7YrvH9LLYuL4+Rwozeee/q/wvzffytyxv+dzhvLYB+u45L2HGPlMJVb7MUqH/ISSxcF9KsJ5ULQFUSp9ZEwVgLpCok4NqhB+FqN3v4NzQDqDgMI971FatJPK0gI+enMH32WNi7icPVu3hvWymDS4GqXqKC9PvY9Ng25h2f0DyLnvWX45aBOzpq7BWXWU4j2HuO+2i9rsQREtMqbSR5QqAI+rhtpat+o5EcLPot5ZjfujV9lQNJNZS6o4UrSIi879NaUuxbvlo5yT9WeELUc1zRwT1ssiewhQAfGOrfz3pUv5/N0tfEQRC0dfxitxOdiqj+LJms6PBrXdgyJaRKn0MUVQdWRDB/OzAIg9bQ+PjEzn0fN/zY7Ns/iwZhaUrGDihAUoCepWCQuA12dC/Wu+yep2KdS5rTpeFhfjSAaqQq+za2hUtwsa5UGhh4yp9DFF968juySh/CzcXvVKrniNsdnD6T17MwzO4+6r6oPm465TUKqPqpv+ygpQqsup363vZWGzO1C++x6/XzkTFo5m9EKYvWoBPzhRqWYcUR6Re1Do0d1uX3RHTBFUHdbQYfws4kYv4PXfngWAcuwoJ9wNQBEFX6hjl9O8TkeZZ41AqVbt07av38P0eVN5dVIJHpdCWsaRsB4TGr/40zruZCk33rWNbXfdyEJms/W1XwCQ3GcPcw30oNBDxlT6mKL7Z2SXxGpPoFcvm+rKGsLPIi6pN/2db/DOWVsp/kJ7ZwmLLxnOgspzsNoTSR1czLS7t1D5h484MgsO/PHnXLakmJKDcClgjXfg6E14L4tzJnH29b9i7thDLL38aQrSs3G4DvLwjKVMfm8RR5Y9wLAnv6Zi9V1MiF3UJg+KaJExlT6ynyqAQE+GYN4RbtcJ1eAlOY2k5FScVeW+PVWa/RjQ6pi2+1brkkF4/wjtdXV8VObrcqqvJ7YqK1geeh4U0SL7qfQRpQog0JMhmHdE4GoG/z1V/r/MoW1kDEak/hHqeCj4mCjSsoxElEofUwSVkQ1t817Z9bwj/Am2rwqC/3yNg9SI/CNaGdbQvmVKRiGzf/qYIqgMHVOF2WMU7d6jSNO3ZX9WpB4WRiNKpU9szojrHuvqSrSH05MTaYpPYFR6gzx2wmOOw0VBZRPOagmsUJhiokLofGSiIjQ9vvsnjSt0N0xx81cQuhMSVIJgMBJUgmAwElSCYDASVIJgMBJUgmAwElSCYDASVIJgMBJUgmAwElSCYDASVIJgMBJUgmAwElSCYDASVIJgMBJUgmAwElSCYDASVIJgMBJUgmAwElSCYDASVIJgMBJUgmAwElSCYDASVIJgMBJUgmAwElSCYDD/D8IlMpp72f7SAAAAAElFTkSuQmCC" alt="1696904765951"></p> <p>双击打开这个软件，如下：</p> <p><img src="/javablog/public/assets/img/1696904839075.d870fd20.png" alt="1696904839075"></p> <p><img src="/javablog/public/assets/img/1696904890347.56066b24.png" alt="1696904890347"></p> <p>使用这个软件去连接mongodb，如下 ：</p> <p><img src="/javablog/public/assets/img/1696904932035.dd77e268.png" alt="1696904932035"></p> <p><img src="/javablog/public/assets/img/1696904962153.c042d1e1.png" alt="1696904962153"></p> <p>创建一个数据库，如下：</p> <p><img src="/javablog/public/assets/img/1696904989363.ef0da809.png" alt="1696904989363"></p> <p><img src="/javablog/public/assets/img/1696905012755.5315d9d6.png" alt="1696905012755"></p> <p>创建一个集合，如下：</p> <p><img src="/javablog/public/assets/img/1696905034453.b2bcb49f.png" alt="1696905034453"></p> <p><img src="/javablog/public/assets/img/1696905057372.f2614839.png" alt="1696905057372"></p> <p>在一个集合中，就可以放很多的数据，如下：</p> <p><img src="/javablog/public/assets/img/1696905108595.f5a13d9f.png" alt="1696905108595"></p> <p><img src="/javablog/public/assets/img/1696905169811.e423b0b1.png" alt="1696905169811"></p> <p>连续添加15个，如下：</p> <p><img src="/javablog/public/assets/img/1696905276045.8ee1b0d8.png" alt="1696905276045"></p> <p>后端代码如下：</p> <p><img src="/javablog/public/assets/img/1696905382086.54cfe067.png" alt="1696905382086"></p> <p>参考代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> MongoClient <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>MongoClient
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// app.use(koaBody());</span>

<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MongoClient</span><span class="token punctuation">(</span><span class="token string">'mongodb://127.0.0.1:27017'</span><span class="token punctuation">)</span>
<span class="token comment">// 链接服务端</span>
client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'链接成功'</span><span class="token punctuation">)</span>

<span class="token comment">// 获取数据库 </span>
<span class="token keyword">const</span> db <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">db</span><span class="token punctuation">(</span><span class="token string">'ajaxtest'</span><span class="token punctuation">)</span>
<span class="token comment">// 获取集合</span>
<span class="token keyword">const</span> grade1 <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'news'</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/news&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> page <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>page <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">(</span>page <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>page <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> pageSize <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">.</span>pageSize<span class="token punctuation">;</span>
    <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token keyword">await</span> grade1
        <span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> pageSize<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token operator">+</span>pageSize<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">let</span> total <span class="token operator">=</span> <span class="token keyword">await</span> grade1<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> size <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>total <span class="token operator">/</span> pageSize<span class="token punctuation">)</span> <span class="token comment">// size表示一共有多少页</span>

    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">news</span><span class="token operator">:</span> r<span class="token punctuation">,</span>
        <span class="token literal-property property">total</span><span class="token operator">:</span> total<span class="token punctuation">,</span>
        pageSize<span class="token punctuation">,</span>
        page<span class="token punctuation">,</span>
        size
    <span class="token punctuation">}</span>
    <span class="token comment">// 关闭客户端的链接</span>
    <span class="token comment">// client.close()</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><p>前端代码：</p> <p><img src="/javablog/public/assets/img/1696906714300.17fcd88d.png" alt="1696906714300"></p> <p>参考代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">*</span> <span class="token punctuation">{</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">li</span> <span class="token punctuation">{</span>
            <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">body</span> <span class="token punctuation">{</span>
            <span class="token property">background</span><span class="token punctuation">:</span> #eee<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">.wrapper</span> <span class="token punctuation">{</span>
            <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
            <span class="token property">width</span><span class="token punctuation">:</span> 970px<span class="token punctuation">;</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 20px auto<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">h1</span> <span class="token punctuation">{</span>
            <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
            <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #ddd<span class="token punctuation">;</span>
            <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">li</span> <span class="token punctuation">{</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 20px 0<span class="token punctuation">;</span>
            <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px dotted #eee<span class="token punctuation">;</span>
            <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">p</span> <span class="token punctuation">{</span>
            <span class="token property">line-height</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>新闻列表(AJAX普通分页)
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
                document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>newsWrap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>总共有<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>total<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>条新闻，每页显示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pagesize<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>条，
                当前是<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>size<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>页
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>prev<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>上一页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>next<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>下一页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">let</span> ul <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;newsWrap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> total <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;total&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> pagesize <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;pagesize&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> currentpage <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;page&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> size <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;size&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> prev <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;prev&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> next <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;next&quot;</span><span class="token punctuation">)</span>

        <span class="token keyword">let</span> page <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> pageSize <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

        <span class="token keyword">function</span> <span class="token function">getNewsList</span><span class="token punctuation">(</span><span class="token parameter">page<span class="token punctuation">,</span> pageSize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://127.0.0.1:3000/news?page=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>page<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;pageSize=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageSize<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 第二步：建立连接</span>
            xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 第三步：发出请求  null可写可不写</span>
            xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token string">&quot;json&quot;</span><span class="token punctuation">;</span>

            xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> res <span class="token operator">=</span> xhr<span class="token punctuation">.</span>response<span class="token punctuation">;</span>
                <span class="token comment">// console.log(res);</span>
                <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
                res<span class="token punctuation">.</span>news<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    str <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
             &lt;li&gt;
                  &lt;h2&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h2&gt;
                  &lt;p class=&quot;time&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>time<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;
                  &lt;p class=&quot;summary&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>summary<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;
              &lt;/li&gt;
          </span><span class="token template-punctuation string">`</span></span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                ul<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> str<span class="token punctuation">;</span>
                total<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> res<span class="token punctuation">.</span>total<span class="token punctuation">;</span>
                pagesize<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> res<span class="token punctuation">.</span>pageSize<span class="token punctuation">;</span>
                currentpage<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> res<span class="token punctuation">.</span>page<span class="token punctuation">;</span>
                size<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> res<span class="token punctuation">.</span>size<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">getNewsList</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        prev<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>page <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">getNewsList</span><span class="token punctuation">(</span><span class="token operator">--</span>page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        next<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>page <span class="token operator">&lt;</span> <span class="token operator">+</span>size<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">getNewsList</span><span class="token punctuation">(</span><span class="token operator">++</span>page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br></div></div><p>分析Network面板：</p> <h3 id="_4-点击加载更多"><a href="#_4-点击加载更多" class="header-anchor">#</a> 4，点击加载更多</h3> <p>后端代码同上   <br></p> <p>前端代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">*</span> <span class="token punctuation">{</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">li</span> <span class="token punctuation">{</span>
            <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">body</span> <span class="token punctuation">{</span>
            <span class="token property">background</span><span class="token punctuation">:</span> #eee<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">.wrapper</span> <span class="token punctuation">{</span>
            <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
            <span class="token property">width</span><span class="token punctuation">:</span> 970px<span class="token punctuation">;</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 20px auto<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">h1</span> <span class="token punctuation">{</span>
            <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
            <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #ddd<span class="token punctuation">;</span>
            <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">li</span> <span class="token punctuation">{</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 20px 0<span class="token punctuation">;</span>
            <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px dotted #eee<span class="token punctuation">;</span>
            <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">p</span> <span class="token punctuation">{</span>
            <span class="token property">line-height</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/axios/0.21.1/axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>新闻列表(ajax点击加载更多分页)
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
                document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span> <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>加载更多<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">let</span> page <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> pageSize <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> ul <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;ul&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;button&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getNewsList</span><span class="token punctuation">(</span><span class="token parameter">page<span class="token punctuation">,</span> pageSize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> <span class="token punctuation">{</span>
                data
            <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:3000/news&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    page<span class="token punctuation">,</span>
                    pageSize
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>news<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
                data<span class="token punctuation">.</span>news<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    str <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
                  &lt;li&gt;
                      &lt;h2&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h2&gt;
                      &lt;p class=&quot;time&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>time<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;
                      &lt;p class=&quot;summary&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>summary<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;
                  &lt;/li&gt;
            </span><span class="token template-punctuation string">`</span></span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token comment">// ul.innerHTML = str;</span>
                ul<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> ul<span class="token punctuation">.</span>innerHTML <span class="token operator">+</span> str<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;没有数据了...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                button<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                button<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;没有更多数据了...&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">getNewsList</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        button<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">getNewsList</span><span class="token punctuation">(</span><span class="token operator">++</span>page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br></div></div><p>浏览器效果：</p> <p><img src="/javablog/public/assets/img/1696991368600.40979576.png" alt="1696991368600"></p> <p>大家，多看看network面板。</p> <h3 id="_5-滚动加载更多"><a href="#_5-滚动加载更多" class="header-anchor">#</a> 5，滚动加载更多</h3> <p>后端代码同上 <br></p> <p>前端代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">*</span> <span class="token punctuation">{</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">li</span> <span class="token punctuation">{</span>
            <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">body</span> <span class="token punctuation">{</span>
            <span class="token property">background</span><span class="token punctuation">:</span> #eee<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">.wrapper</span> <span class="token punctuation">{</span>
            <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
            <span class="token property">width</span><span class="token punctuation">:</span> 970px<span class="token punctuation">;</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 20px auto<span class="token punctuation">;</span>
            <span class="token property">padding</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">h1</span> <span class="token punctuation">{</span>
            <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
            <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #ddd<span class="token punctuation">;</span>
            <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">li</span> <span class="token punctuation">{</span>
            <span class="token property">margin</span><span class="token punctuation">:</span> 20px 0<span class="token punctuation">;</span>
            <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px dotted #eee<span class="token punctuation">;</span>
            <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">p</span> <span class="token punctuation">{</span>
            <span class="token property">line-height</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/axios/0.21.1/axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>新闻列表(ajax滚动加载更多分页)
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
                document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>footer<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>40px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">let</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;img&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> ul <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;ul&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> footer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&quot;footer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

        <span class="token keyword">let</span> page <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> pageSize <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> load <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

        <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getNewsList</span><span class="token punctuation">(</span><span class="token parameter">page<span class="token punctuation">,</span> pageSize</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            img<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;src&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./imgs/timg.gif&quot;</span><span class="token punctuation">)</span>

            <span class="token keyword">let</span> <span class="token punctuation">{</span>
                data
            <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:3000/news&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    page<span class="token punctuation">,</span>
                    pageSize
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>news<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
                data<span class="token punctuation">.</span>news<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    str <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
                  &lt;li&gt;
                      &lt;h2&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h2&gt;
                      &lt;p class=&quot;time&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>time<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;
                      &lt;p class=&quot;summary&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token punctuation">.</span>summary<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/p&gt;
                  &lt;/li&gt;
            </span><span class="token template-punctuation string">`</span></span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token comment">// ul.innerHTML = str;</span>
                ul<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> ul<span class="token punctuation">.</span>innerHTML <span class="token operator">+</span> str<span class="token punctuation">;</span>
                load <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                footer<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;-----------我是有底线的-----------&quot;</span>
                load <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span>
        <span class="token function">getNewsList</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;scroll&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> st <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span> <span class="token comment">// // 卷上去的高度</span>
            <span class="token keyword">let</span> ch <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span> <span class="token comment">// 一屏的高度</span>
            <span class="token keyword">let</span> dh <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollHeight<span class="token punctuation">;</span> <span class="token comment">// 整体内容的高度</span>
            <span class="token comment">// console.log(&quot;st:&quot;,st);</span>
            <span class="token comment">// console.log(&quot;ch:&quot;,ch);</span>
            <span class="token comment">// console.log(&quot;dh:&quot;,dh);</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>st <span class="token operator">+</span> ch<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token punctuation">(</span>dh <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> load<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;到底了~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">getNewsList</span><span class="token punctuation">(</span><span class="token operator">++</span>page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br></div></div><p>浏览器效果：</p> <p><img src="/javablog/public/assets/img/1696992469163.240ac996.png" alt="1696992469163"></p> <p>大家自己分析Network面板。</p> <h2 id="四-axios"><a href="#四-axios" class="header-anchor">#</a> 四，Axios</h2> <h3 id="_1-认识axios"><a href="#_1-认识axios" class="header-anchor">#</a> 1，认识axios</h3> <p><strong>axios是什么?</strong></p> <ul><li>前端最流行的ajax请求库</li> <li>react/vue官方都推荐使用axios发ajax请求</li> <li>文档: https://github.com/axios/axios</li></ul> <p><strong>功能特点</strong></p> <ul><li>基于xhr + promise的异步ajax请求库</li> <li>浏览器端/node端都可以使用</li> <li>支持 Promise API</li> <li>拦截请求和响应</li> <li>转换请求和响应数据</li> <li>支持请求取消</li> <li>批量发送多个请求</li></ul> <p><strong>axios请求方式</strong></p> <ul><li>axios(config): 通用/最本质的发任意类型请求的方式</li> <li>axios(url[, config]): 可以只指定url发get请求</li> <li>axios.request(config): 等同于axios(config)</li> <li>axios.get(url[, config]): 发get请求</li> <li>axios.delete(url[, config]): 发delete请求</li> <li>axios.post(url[, data, config]): 发post请求</li> <li>axios.put(url[, data, config]): 发put请求</li> <li>axios.defaults.xxx: 请求的默认全局配置</li> <li>axios.interceptors.request.use(): 添加请求拦截器</li> <li>axios.interceptors.response.use(): 添加响应拦截器</li> <li>axios.create(config): 创建一个新的axios(它没有下面的功能)</li> <li>axios. Cancel(): 用于创建取消请求的错误对象</li> <li>axios. CancelToken(): 用于创建取消请求的token对象</li> <li>axios.isCancel(): 是否是一个取消请求的错误</li> <li>axios.all(promises): 用于批量执行多个异步请求</li> <li>axios.spread(): 用来指定接收所有成功数据的回调函数的方法</li></ul> <p><strong>常见的配置选项</strong></p> <ul><li>请求地址      url: '/user'</li> <li>请求类型      method: 'get'</li> <li>根求路径      baseURL: 'http://www.mt.com/api'</li> <li>请求前的数据处理      transformRequest:function(data){}</li> <li>请求后的数据处理      transformResponse: function(data){}</li> <li>自定义的请求头      headers:{'x-Requested-With':'XMLHttpRequest'}</li> <li>URL查询对象      params:{ id: 12 }</li> <li>查询对象序列化函数      paramsSerializer: function(params){ }</li> <li>request body      data: { key: 'aa'}</li> <li>超时设置      timeout: 1000</li></ul> <p>准备后端代码：</p> <p><img src="/javablog/public/assets/img/1696918972938.908d08eb.png" alt="1696918972938"></p> <p>参考代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/get&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">&quot;hello axios&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>前端代码演示：</p> <p><img src="/javablog/public/assets/img/1696919311031.b14a8135.png" alt="1696919311031"></p> <p>参考代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/axios/0.21.1/axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token comment">// 利用axios发请求，得到的结果是一个promise</span>
        axios<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;http://127.0.0.1:3000/get&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;get&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;res:&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;服务器响应的数据：&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>network面板分析：</p> <p><img src="/javablog/public/assets/img/1696919446366.77f6b36c.png" alt="1696919446366"></p> <h3 id="_2-发get请求"><a href="#_2-发get请求" class="header-anchor">#</a> 2，发get请求</h3> <p>后端代码同上。<br></p> <p>前端代码演示：</p> <p><img src="/javablog/public/assets/img/1696919642462.f960f0c4.png" alt="1696919642462"></p> <p>network面板大家自己点开看看。</p> <h3 id="_3-get请求传参"><a href="#_3-get请求传参" class="header-anchor">#</a> 3，get请求传参</h3> <p>准备后端代码：</p> <p><img src="/javablog/public/assets/img/1696919712693.bee2bfa8.png" alt="1696919712693"></p> <p>参考代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/get&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> ctx<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/get/:name/:age/:address&quot;</span><span class="token punctuation">,</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> ctx<span class="token punctuation">.</span>params<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>前端代码演示通过查询字符串传参：</p> <p><img src="/javablog/public/assets/img/1696919820889.c99333e8.png" alt="1696919820889"></p> <p>network面板分析：</p> <p><img src="/javablog/public/assets/img/1696919853391.0df47f03.png" alt="1696919853391"></p> <p><img src="/javablog/public/assets/img/1696919882050.185bd675.png" alt="1696919882050"></p> <p>通过查询字符串传参，还有一种写法，如下：</p> <p><img src="/javablog/public/assets/img/1696920170274.25b45332.png" alt="1696920170274"></p> <p>前端代码演示通过路径传参：</p> <p><img src="/javablog/public/assets/img/1696919951796.b72a1423.png" alt="1696919951796"></p> <p>看network面板，如下：</p> <p><img src="/javablog/public/assets/img/1696920017623.26b74895.png" alt="1696920017623"></p> <h3 id="_4-发post请求"><a href="#_4-发post请求" class="header-anchor">#</a> 4，发post请求</h3> <p>准备后端代码：</p> <p><img src="/javablog/public/assets/img/1696920227620.4ee336b9.png" alt="1696920227620"></p> <p>参考代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa2-cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-logger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@koa/router&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> koaBody <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa-body&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">koaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/post&quot;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;running in http://127.0.0.1:3000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>前端代码演示以Json的形式把数据给服务器：</p> <p><img src="/javablog/public/assets/img/1696920437445.d3dae671.png" alt="1696920437445"></p> <p>前端代码演示以表单的形式把数据给服务器：</p> <p><img src="/javablog/public/assets/img/1696921507947.29863991.png" alt="1696921507947"></p> <h3 id="_5-其它"><a href="#_5-其它" class="header-anchor">#</a> 5，其它</h3> <p>axios发送多个请求，如下：</p> <p><img src="/javablog/public/assets/img/1696921635065.960aef4e.png" alt="1696921635065"></p> <p>axios是一个实例，是一个对象，可以做一些默认配置，如下 ：</p> <p><img src="/javablog/public/assets/img/1696921776752.9bbee48c.png" alt="1696921776752"></p> <p>还可以配置其它的，如下：</p> <p><img src="/javablog/public/assets/img/1696921844747.7ff217d4.png" alt="1696921844747"></p> <h3 id="_6-axios创建实例"><a href="#_6-axios创建实例" class="header-anchor">#</a> 6，axios创建实例</h3> <p>前面使用的axios，是默认的实例，引入axios.js，就有默认的实例。前面我们讲了，可以给这个默认实例作一些配置。当给该实例设置一些默认配置时, 这些配置就被固定下来了，但是后续开发中, 某些配置可能会不太一样，比如，我们要向两台服务器发出请求，如下：</p> <p><img src="/javablog/public/assets/img/1696923828175.7ee1e974.png" alt="1696923828175"></p> <p><strong>面试题</strong></p> <ul><li>需求: 项目中有部分接口需要的配置与另一部分接口需要的配置不太一样, 如何处理</li> <li>解决: 创建2个新axios, 每个都有自己特有的配置, 分别应用到不同要求的接口请求中</li></ul> <p>创建axios实例，如下：</p> <p><img src="/javablog/public/assets/img/1696924003284.603bdc56.png" alt="1696924003284"></p> <p>创建出来的axios实例和默认axios实例的区别：</p> <ul><li>新axios只是没有取消请求和批量发请求的方法, 其它所有语法都是一致的</li> <li>根据指定配置创建一个新的axios, 也就就每个新axios都有自己的配置</li></ul> <h3 id="_7-请求和响应拦截器"><a href="#_7-请求和响应拦截器" class="header-anchor">#</a> 7，请求和响应拦截器</h3> <p><strong>axios的也可以设置拦截器：拦截每次请求和响应</strong></p> <ul><li>axios.interceptors.request.use(请求成功拦截, 请求失败拦截)</li> <li>axios.interceptors.response.use(响应成功拦截, 响应失败拦截)</li></ul> <p><img src="/javablog/public/assets/img/1696924188471.5e3ac033.png" alt="1696924188471"></p> <p>直接上代码：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/axios/0.21.1/axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/nprogress/0.2.0/nprogress.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/nprogress/0.2.0/nprogress.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>发送请求<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&quot;button&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// 给默认实例添加请求拦截器</span>
    <span class="token comment">// config就是实例的配置</span>
    <span class="token comment">// 这样写，相当于，这个拦截器什么也没有做</span>
    <span class="token comment">// axios.interceptors.request.use(config =&gt; {</span>
    <span class="token comment">//   // todo...</span>
    <span class="token comment">//   return config;</span>
    <span class="token comment">// })</span>

    <span class="token comment">// 所谓的做一些事，就是做一些配置</span>
    axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 添加请求头</span>
        config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>Authorization <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">abc123</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

        NProgress<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 显示进度条</span>

        <span class="token keyword">return</span> config<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

        NProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关闭进度条</span>

        <span class="token comment">// 在响应拦截器中过滤出data数据  data才是服务器给你的数据</span>
        <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 失败的回调，直接响应失败的promsie</span>
        <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;http://httpbin.org/delay/5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>浏览器效果如下：</p> <p><img src="/javablog/public/assets/img/1696924744436.8465b278.png" alt="1696924744436"></p> <h3 id="_8-取消请求"><a href="#_8-取消请求" class="header-anchor">#</a> 8，取消请求</h3> <p><strong>基本流程</strong></p> <ul><li>配置cancelToken对象</li> <li>缓存用于取消请求的cancel函数</li> <li>在后面特定时机调用cancel函数取消请求</li> <li>在错误回调中判断如果error是cancel, 做相应处理</li></ul> <p><strong>实现功能：点击按钮, 取消某个正在请求中的请求</strong></p> <ul><li>在请求一个接口前, 取消前面一个未完成的请求</li></ul> <p>直接上代码：</p> <p><img src="/javablog/public/assets/img/1696925283186.ebf1aa51.png" alt="1696925283186"></p> <h3 id="_9-简单二次封装"><a href="#_9-简单二次封装" class="header-anchor">#</a> 9，简单二次封装</h3> <p><strong>功能点</strong></p> <ol><li>统一进行请求配置: 基础路径/超时时间等</li> <li>请求过程中loading提示</li> <li>请求可能需要携带token数据</li> <li>请求成功的value不再是response, 而是response.data</li> <li>请求失败/出错统一进行处理, 每个请求可以不用单独处理</li></ol> <p>直接上代码，如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/axios/0.21.1/axios.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/nprogress/0.2.0/nprogress.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/nprogress/0.2.0/nprogress.min.css<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token comment">// 一般会自己创建一个axios实例    instance是实例的意思</span>
        <span class="token keyword">let</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token comment">// 在这里，可以做很多配置</span>
            <span class="token comment">// baseURL是配置基础路径</span>
            <span class="token literal-property property">baseURL</span><span class="token operator">:</span> <span class="token string">&quot;http://127.0.0.1:3000&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">8000</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token comment">// 目前在请求拦截器中配置了：</span>
        <span class="token comment">//    1）开启Nprogress进度条</span>
        <span class="token comment">//    2）在请求头中添加token</span>
        instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&quot;fasdfasdfsadf&quot;</span><span class="token punctuation">;</span>
            config<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> token<span class="token punctuation">;</span>

            NProgress<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> config<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token comment">// 目前在响应拦截器中配置了：</span>
        <span class="token comment">//    1）关闭Nprogress进度条</span>
        <span class="token comment">//    2）过滤出data数据</span>
        instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

            NProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> response<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            NProgress<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token comment">// 后面发请求，就可以使用自己的实例</span>
        instance<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;http://httpbin.org/delay/5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><h2 id="五-jsonp"><a href="#五-jsonp" class="header-anchor">#</a> 五，JSONP</h2> <h3 id="_1-jsonp原理"><a href="#_1-jsonp原理" class="header-anchor">#</a> 1，JSONP原理</h3> <p>发送http请求的方式：</p> <ul><li>浏览器的地址栏，只能发送get请求</li> <li>postman软件，可以各种请求，类似postman这样的软件有很多</li> <li>html中有些标签也会发请求，如img, link, script, a, form....</li> <li>ajax可以发各位请求，最大的特点：局部刷新，提升用户体验</li> <li>.....</li></ul> <p>JSONP不是ajax，JSONP发请求本质是利用script标签的src发的请求，先准备后端代码：</p> <p><img src="/javablog/public/assets/img/1696987193636.5e2c2fd6.png" alt="1696987193636"></p> <p>写前端代码，如下：</p> <p><img src="/javablog/public/assets/img/1696987711484.01c188cf.png" alt="1696987711484"></p> <p>参考代码如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>发送ajax请求<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;btn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">jsonp</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> callName <span class="token operator">=</span> <span class="token string">&quot;fn&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// data就是服务器响应的数据</span>
        window<span class="token punctuation">[</span>callName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fn函数执行了。。。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                options<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                options<span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> url <span class="token operator">=</span> options<span class="token punctuation">.</span>url <span class="token operator">+</span> <span class="token string">&quot;?callBack=&quot;</span> <span class="token operator">+</span> callName<span class="token punctuation">;</span>
        <span class="token keyword">let</span> scriptEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        scriptEle<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>scriptEle<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">jsonp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:3000/&quot;</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;data:&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;数据请求失败了&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h3 id="_2-jsonp案例"><a href="#_2-jsonp案例" class="header-anchor">#</a> 2，JSONP案例</h3> <p>做一个百度联想搜索的案例：</p> <p><img src="/javablog/public/assets/img/1696987798894.fad4cc9f.png" alt="1696987798894"></p> <p>直接上代码：</p> <p><img src="/javablog/public/assets/img/1696988911308.6754d451.png" alt="1696988911308"></p> <p>HTML结构如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>百度联想词<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>css/index.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search-wrap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input-wrap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search-input J_searchInput<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list-wrap<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wd-list J_wdList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>js/index.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>CSS样式如下：</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">div,
input,
li</span> <span class="token punctuation">{</span>
    <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
    <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">ul</span> <span class="token punctuation">{</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">a</span> <span class="token punctuation">{</span>
    <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.search-wrap</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 536px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 200px auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.search-wrap .search-input</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
    <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #b8b8b8<span class="token punctuation">;</span>
    <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span>
    <span class="token property">text-indent</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 18px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.search-wrap .search-input:hover</span> <span class="token punctuation">{</span>
    <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #999<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.search-wrap .search-input:focus</span> <span class="token punctuation">{</span>
    <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #38f<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.search-wrap .list-wrap</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.search-wrap .list-wrap .wd-item</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
    <span class="token property">padding-left</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.search-wrap .list-wrap .wd-item:hover</span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #efefef<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.search-wrap .list-wrap .wd-lk</span> <span class="token punctuation">{</span>
    <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #000<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.search-wrap .list-wrap .wd-lk .font-normal</span> <span class="token punctuation">{</span>
    <span class="token property">font-weight</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><p>JS功能如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 接口地址：https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=</span>
    <span class="token comment">// &quot;https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=&quot; + value + &quot;&amp;cb=&quot; + callbackName</span>

    <span class="token comment">// &lt;li class=&quot;wd-item&quot;&gt;</span>
    <span class="token comment">//     &lt;a href=&quot;https://www.baidu.com/s?wd={{wdLink}}&quot; target=&quot;_blank&quot; class=&quot;wd-lk&quot;&gt;{{wd}}&lt;/a&gt;</span>
    <span class="token comment">// &lt;/li&gt; </span>

    <span class="token keyword">let</span> searchInput <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&quot;J_searchInput&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> wdList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&quot;J_wdList&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> listWrap <span class="token operator">=</span> wdList<span class="token punctuation">.</span>parentNode<span class="token punctuation">;</span>

    searchInput<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;input&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">getDatas</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> <span class="token string">'fn'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            wdList<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
            listWrap<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    window<span class="token punctuation">.</span><span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// console.log(&quot;data:&quot;, data);</span>
        <span class="token function">renderList</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 调接口，获取数据</span>
    <span class="token keyword">function</span> <span class="token function">getDatas</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> callbackName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> oScript <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        oScript<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=&quot;</span> <span class="token operator">+</span> value <span class="token operator">+</span> <span class="token string">&quot;&amp;cb=&quot;</span> <span class="token operator">+</span> callbackName
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>oScript<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 渲染数据</span>
    <span class="token keyword">function</span> <span class="token function">renderList</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> data <span class="token operator">=</span> d<span class="token punctuation">.</span>s<span class="token punctuation">;</span>
        <span class="token keyword">let</span> len <span class="token operator">=</span> data<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                str <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
                    &lt;li class=&quot;wd-item&quot;&gt;
                        &lt;a href=&quot;https://www.baidu.com/s?wd={{wdLink}}&quot; target=&quot;_blank&quot; class=&quot;wd-lk&quot;&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/a&gt;
                    &lt;/li&gt; 
                </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            wdList<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> str<span class="token punctuation">;</span>
            listWrap<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            wdList<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
            listWrap<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h2 id="六-网络理论补充"><a href="#六-网络理论补充" class="header-anchor">#</a> 六，网络理论补充</h2> <h3 id="_1-从输入url地址到看到页面-中间都经历了啥"><a href="#_1-从输入url地址到看到页面-中间都经历了啥" class="header-anchor">#</a> 1，从输入URL地址到看到页面，中间都经历了啥？</h3> <p>先上图：</p> <p><img src="/javablog/public/assets/img/1696828328502.fdf498da.png" alt="1696828328502"></p> <h4 id="第一步-url地址解析"><a href="#第一步-url地址解析" class="header-anchor">#</a> 第一步：URL地址解析</h4> <p>有如下的URL： http://www.xxx.com:80/index.html?lx=1&amp;from=weixin#video</p> <p>url的格式：</p> <ul><li>传输协议（负责客户端和服务器端之间信息的传输（可以理解为快递小哥））
<ul><li>http（Hypertext Transfer Protocol）：超文本传输协议（除传输文本内容外，还可传输图片和音视频等）</li> <li>https（Hypertext Transfer Protocol Secure）：HTTP + SSL 更安全的传输协议（经过加密处理）</li> <li>ftp（File Transfer Protocol）：文件传输协议，主要用于往服务器上，上传和下载内容</li></ul></li> <li>域名</li> <li>端口号
<ul><li>作用：区分相同服务器上部署的不同项目的，取值范围 0~65535 之间</li> <li>浏览器有默认端口号机制：我们在地址栏中输入URL地址，如果没有写端口号，则浏览器会根据当前的传输协议，自动把端口号加上！！
<ul><li>http -&gt; 80</li> <li>https -&gt; 443</li> <li>ftp -&gt; 21</li></ul></li></ul></li> <li>请求资源的路径名称</li> <li>问号传参信息</li> <li>哈希值「Hash值」</li></ul> <h4 id="第二步-缓存检查"><a href="#第二步-缓存检查" class="header-anchor">#</a> 第二步：缓存检查</h4> <p>针对静态资源文件（例如：html、css、js、图片、音视频...）：强缓存和协商缓存</p> <p>缓存存储的位置：虚拟内存（Memory Cache）、物理内存（Disk Cache）</p> <ul><li>正常刷新页面：先从虚拟内存中获取，如果不存在，再去物理内存中查找</li> <li>关闭页面重新打开，直接去物理内存中查找</li> <li>强制刷新页面（CTRL+F5），直接去服务器获取最新的</li></ul> <p>不论是强缓存还是协商缓存，都是由服务器进行设置，浏览器自动配合完成相应的缓存机制！</p> <p><strong>强缓存介绍：</strong></p> <ul><li>第一次访问网站，本地没有任何的缓存，需要向服务器发送请求；服务器在返回相应资源信息的时候，如果想开启强缓存机制，会在响应头中设置相关的字段：
<ul><li>Expires：存储缓存过期的具体时间「HTTP/1.0」</li> <li>Cache-Control：存储过多久缓存将过期（单位：秒）或者其它信息「HTTP/1.1」</li></ul></li> <li>当浏览器获取到服务器返回的资源信息，除了正常的渲染以外，还会去看响应头中是否有 Expires/Cache-Control 字段，如果没有，则啥都不处理，如果有，则把本次获取的资源信息和这两个响应头信息，缓存在客户端本地！第二次及以后访问这个网站，首先看本地是否有”具备有效期的缓存信息“
<ul><li>没有/过期了：重新向服务器发送请求，来获取最新的资源</li> <li>有：则直接渲染缓存中的信息，无需再向服务器发送请求了</li></ul></li></ul> <p><strong>强缓存的特点：</strong></p> <ul><li>不论从服务器还是缓存中获取，只要可以拿到，HTTP状态码都是200</li> <li>“html页面千万不要做强缓存”，以此来保证，即便本地有生效的缓存，但是只要服务器资源更新了，也要从服务器实时获取最新的资源进行渲染！！
<ul><li>我们平时开发的时候，需要基于 webpack/vite 等前端工具，对代码进行编译打包，把编译后的内容部署到服务器上！</li> <li>在webpack编译的时候，我们可以设置一个规则：根据文件的内容，让生成的文件名带唯一的HASH值（例如 main.sare3fd9jk.js）；这样只要代码修改了，每次打包都会创建不同的文件出来，而html页面中导入的也是最新的文件！</li> <li>这样只要html不做强缓存，就可保证，服务器资源一但更新，我们获取的是最新资源，而不是本地缓存！</li></ul></li></ul> <p><strong>协商缓存介绍：</strong></p> <ul><li>协商缓存是强缓存的一种补充「如果强缓存还在有效期，即便服务器设置了协商缓存，那么协商缓存的机制也不会触发；只有没有强缓存或者强缓存失效了，设置的协商缓存机制才会生效！！」</li> <li>第一次访问网站，本地啥缓存都没有，需要从服务器获取；如果服务器想对当前的资源设置协商缓存，则在响应头中返回/设置相关的字段：
<ul><li>Last-Modified：存储该资源在服务器最后一次修改的时间「HTTP/1.0」</li> <li>ETag：存储该资源在服务器最后一次修改的标识(唯一的)「HTTP/1.1」</li></ul></li> <li>浏览器获取资源信息的同时，观察响应头信息，如果具备这两个字段，则把资源和标识都缓存在本地！</li> <li>第二次访问网站，不论本地缓存是否生效（前提：强缓存肯定是没有或者失效了），都需要重新向服务器发送请求，并且在请求头中携带两个字段：
<ul><li>If-Modified-Since：存储的值是Last-Modified的值</li> <li>If-None-Match：存储的值是ETag的值</li></ul></li> <li>服务器接收传递的信息及标识，用 If-Modified-Since/If-None-Match 和当前服务器上最新的资源进行对比
<ul><li>对比后是一样的：说明服务器上的这个资源没有更改过，则服务器直接返回 304 「Not-Modified」，浏览器接收到这个状态码，则从本地缓存中获取资源信息进行渲染</li> <li>对比后是不一样的：说明服务器上的这个资源更改过，此时服务器返回 状态码200、最新的资源信息、最新的Last-Modified/ETag值 ！浏览器获取最新的信息后，除了渲染，再把最新的信息和标识缓存在本地！</li></ul></li></ul> <p><strong>ajax获取的数据不能缓存：</strong></p> <ul><li>基于ajax/fetch从服务器获取的数据，不能设置强缓存和协商缓存，如果需要对不经常更新的数据进行缓存，需要开发者基于本地存储进行处理！</li> <li>最好的数据缓存方案是：vuex/redux「既可以避免频繁向服务器发送请求，也可以保证在用户刷新后，可以及时从服务器获取到最新的信息」</li> <li>但是对于一些不经常更新的数据，基于localStorage来存储（自己设定时效性）也是不错的选择！</li></ul> <p>参考代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">query</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 执行QUERY方法的第一件事情：先看本地是否有此数据的缓存</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> storage<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'CACHE'</span><span class="token punctuation">,</span> <span class="token number">7</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 本地是具备有效缓存的，则停止向服务器发送请求</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'请求成功：'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 数据没有缓存过：则向服务器发送请求</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/list'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">params</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">lx</span><span class="token operator">:</span> <span class="token string">'my'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'请求成功：'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
        <span class="token comment">// 请求成功：把请求的结果存储到本地</span>
        storage<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'CACHE'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="第三步-dns解析"><a href="#第三步-dns解析" class="header-anchor">#</a> 第三步：DNS解析</h4> <p>所谓DNS解析，就是去DNS服务器上，基于域名获取服务器的外网IP地址(主机地址)，DNS解析也是有缓存机制的「比如谷歌浏览器记录“DNS解析”的缓存时间，大概是1分钟左右」。</p> <p>流程：</p> <ul><li>基于“递归查询”在本地缓存中查找DNS解析记录
<ul><li>浏览器DNS解析缓存 -&gt; 本地Host文件 -&gt; 本地DNS解析器缓存 -&gt; 本地DNS服务器</li></ul></li> <li>基于“迭代查询”在DNS服务器上查找DNS解析记录
<ul><li>根域名服务器 / 顶级域名服务器 / 权威域名服务器</li> <li>每一次DNS解析的时间，大概在 20~120 毫秒左右</li></ul></li></ul> <p>单纯这样看，减少DNS的解析次数，会提高页面的加载速度！想要减少DNS的解析次数，需要把所有的资源，部署在相同服务器的相同服务下！！但是在真实的项目中，我们往往要把不同的资源部署到不同的服务器上「例如：静态资源服务器、图片和音视频服务器、数据请求服务器...」，这样会导致网站中出现多个域名请求，也就需要多个DNS解析！！</p> <ul><li>资源的合理利用</li> <li>降低单一服务器的压力，提高并发上限</li> <li>...</li></ul> <p>在DNS解析次数增加的情况下，我们可以基于 dns-prefetch 「DNS预解析」，来提高网站的加载速度！</p> <ul><li></li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dns-prefetch<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>//static.360buyimg.com<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>DNS预解析的原理：就是利用浏览器的多线程机制，在GUI渲染的同时，开辟新的线程去解析域名(解析的结果会缓存在浏览器中)，这样当GUI渲染到一定的阶段，遇到新的资源请求的时候，可能域名已经解析过了，直接用缓存中存储的外网IP，去服务器发送请求即可，不用再解析了！！</li></ul> <h4 id="第四步-tcp三次握手"><a href="#第四步-tcp三次握手" class="header-anchor">#</a> 第四步：TCP三次握手</h4> <p>目的：根据DNS解析出来的服务器主机地址，建立起和服务器之间的传输通道，为了保证传输通道的稳定性，需要进行“三次握手”</p> <h4 id="第五步-客户端和服务器之间的数据通信"><a href="#第五步-客户端和服务器之间的数据通信" class="header-anchor">#</a> 第五步：客户端和服务器之间的数据通信</h4> <p>客户端向服务器发送请求，把一些信息传递给服务器「Request请求阶段」</p> <ul><li>请求起始行：请求方式、请求地址(包括问号传参信息)、HTTP协议的版本</li> <li>请求头(首部)：各种各样的键值对  Content-Type、Cookie、User-Agent、Authorization...</li> <li>请求主体(Request Payload)：请求主体中的数据格式是有限制的
<ul><li>支持字符串
<ul><li>JSON格式的字符串  Content-Type:application/json</li> <li>urlencoded格式的字符串  xxx=xxx&amp;xxx=xxx   Content-Type:application/x-www-form-urlencoded</li> <li>普通字符串  Content-Type:text/plain</li></ul></li> <li>支持 FormData 格式对象「主要用于文件上传」   Content-Type:multipart/form-data</li> <li>支持 Buffer/二进制 等格式数据</li> <li>...</li> <li>不支持其余的对象格式
<ul><li>如果请求主体中，我们传递的是普通对象，则浏览器默认会把其变为普通字符串（例如：“[object Object]”）传递给服务器</li> <li>在Axios内部，如果我们传递的是普通对象，其内部会默认把普通对象变为JSON格式字符串，基于请求主体传递给服务器！</li></ul></li></ul></li></ul> <p>服务器接收客户端的请求，把客户端需要的信息返回给客户端「Response响应阶段」</p> <ul><li>响应起始行：HTTP协议的版本、HTTP响应状态码</li> <li>响应头：Connection: keep-alive、Date「服务器时间」...</li> <li>响应主体：一般返回的都是JSON格式字符串，但也有可能是其它的格式（例如 xml、buffer...）</li></ul> <p>HTTP事务：Request + Response  <br></p> <p>HTTP报文：请求(响应)起始行/头/主体，统称为HTTP报文！「在控制台的Network中可查看详细的报文信息」</p> <h4 id="第六步-tcp四次挥手"><a href="#第六步-tcp四次挥手" class="header-anchor">#</a> 第六步：TCP四次挥手</h4> <p>上一个课件中讲过了。需要说明的是，如果每一次请求都重新的“三握四挥”，这样太浪费性能和时间了。我们期望第一次请求，把传输通道建立好后，当本次HTTP事物完成后，这个通道先不要关闭，保留一段时间，让后面的请求，继续基于这个通道通信即可！解决方案：请求/响应头中设置 Connection: keep-alive , 保持TCP通道的长链接即可「HTTP/1.1版本中，自动就设置了keep-alive长链接机制，服务器端可以修改长链接的时间或者次数」</p> <h4 id="第七步-客户端渲染"><a href="#第七步-客户端渲染" class="header-anchor">#</a> 第七步：客户端渲染</h4> <p>浏览器把服务器返回的信息(包括html/css/js/图片/数据等)进行渲染，最后绘制出对应的页面！！</p> <p>A）构建 DOM-Tree「DOM树」，从服务器获取HTML页面后，浏览器会分配 GUI渲染线程，自上而下进行解析！</p> <ul><li>遇到 link标签 ：分配一个新的HTTP网络线程去服务器获取样式资源，同时GUI继续向下渲染</li> <li>遇到 style：虽然不需要去服务器获取样式，但是此时的样式是不渲染的，只有等待DOM-Tree构建完毕后，并且其余基于link获取的样式也回来了，才会按照原定的顺序(编写的顺序)进行渲染！</li> <li>遇到 @import：也会分配一个HTTP线程去服务器获取样式资源，只不过其会阻碍GUI的渲染，只有等待样式资源获取完毕后，GUI才会继续向下渲染！</li> <li>遇到 img标签，audio标签，video标签：和 link标签 一致，但是对于音视频来讲，如果设置了 preload=&quot;none&quot; 属性，则开始渲染页面的时候，并不会去服务器获取音视频资源！</li> <li>遇到 script标签 ... script标签：立即把JS代码执行（交给JS引擎线程渲染，但是GUI会暂定，也相当于阻碍了GUI渲染）</li> <li>遇到 script src='' 标签：阻碍GUI渲染，分配一个新的HTTP线程去服务器获取JS资源，等待JS代码获取到之后，交由JS引擎线程去渲染，只有JS代码执行完毕，才会继续GUI的渲染！</li> <li>遇到 script src='' async 标签：分配HTTP线程去获取JS资源，此时GUI会继续渲染，但是等到JS代码获取到之后，会立即停止GUI的渲染，先把JS执行！</li> <li>遇到 script src='' defer 标签：和link 标签一致了，会分配HTTP线程去获取JS资源，GUI继续向下渲染，等待DOM-Tree渲染完毕，并且其它设置defer的JS资源也获取到了，再按照编写的顺序，依次执行JS！</li> <li>当把所有的HTML结构解析完毕后，会构建出DOM元素之间的层级关系，这就是DOM树！在DOM树构建完毕后，会触发一个事件：DOMContentLoaded</li></ul> <p>B）构建 CSSOM-Tree「样式树」</p> <ul><li>等待样式资源从服务器获取到之后，会按照既定的顺序，开始渲染CSS样式，最后生成 CSSOM-Tree！</li> <li>CSS样式被称之为“层叠样式表”，就是因为其实具备：层级、权重、继承的</li></ul> <p>C）把 DOM-Tree和CSSOM-Tree 合并在一起，创建 Render-Tree「渲染树」</p> <ul><li>渲染树中，已经非常清楚的知道了：DOM元素的层级和每一个元素的样式</li></ul> <p>D）Layout 布局排列计算「回流/重排 Reflow」</p> <ul><li>根据当前视口的大小，计算元素在视口中的位置以及相关的样式</li></ul> <p>E）分层</p> <ul><li>在一个页面中，不仅仅只有一层，它是一个3D空间，会存在很多层「所谓的脱离文档流」</li> <li>而分层的目的就是：把每一层及每一层中的元素样式都详细的规划好，包括具体的绘制步骤</li></ul> <p>F）Painting 绘制「重绘 Repainting」</p> <ul><li>开始一层层的，按照规划好的步骤进行绘制，直到整个页面都被绘制完毕！</li></ul> <h4 id="基于上面知识点总结平时项目开发中的一些优化技巧"><a href="#基于上面知识点总结平时项目开发中的一些优化技巧" class="header-anchor">#</a> 基于上面知识点总结平时项目开发中的一些优化技巧</h4> <ul><li>建议把 script 都放在页面的底部，防止其阻碍GUI的渲染，而且在JS中也可以获取到渲染后的DOM元素了</li> <li>如果我把 script放在了页面顶部，此时在JS中是拿不到DOM元素的，该如何解决？
<ul><li>设置 defer 属性</li> <li>可以监听 DOMContentLoaded/load 事件，在事件中去获取DOM元素
<ul><li>DOMContentLoaded：只要DOM-Tree构建完毕后就触发</li> <li>load：只有所有资源都加载完毕才会触发</li></ul></li></ul></li> <li>平时开发的时候，如果把 script都放在了页面底部，那么 defer/async 可以不加；如果没有都放在底部，我们可以设置 defer/async 来减轻对GUI渲染的阻碍！
<ul><li>如果JS之间没有依赖关系，设置 async 即可，谁先获取到资源，就先把谁执行！</li> <li>如果之间是存在依赖的，那么只能设置 defer，要等待所有JS资源都获取到，再按照编写的顺序依次执行！</li></ul></li> <li>对于样式的处理，坚决不用 @import 导入式「除less/sass中的@import」</li> <li>剩下的情况，如果样式代码比较少，建议我们使用内嵌样式（尤其是移动端），样式代码较多的情况下，还是使用外链式更好一些！！</li> <li>而且要把 link 放在页面头部，让GUI和HTTP同时工作，加快页面的整体渲染进度！</li> <li>同源下，我们可以同时分配的HTTP线程数量，最多是5~7个
<ul><li>CSS和JS建议进行合并压缩</li> <li>第一此渲染页面的时候，对于图片/音视频等资源，一定要开启懒加载，不要让这些资源，占据有限的HTTP线程数，并且第一次渲染如果不渲染图片，页面绘制的速度会更快！！</li></ul></li></ul> <h3 id="_2-常见的http状态码"><a href="#_2-常见的http状态码" class="header-anchor">#</a> 2，常见的HTTP状态码</h3> <ul><li>200 成功</li> <li>206 断点续传</li> <li>301 永久重定向「一般用于域名迁移」</li> <li>302/307 临时转移/重定向「一般用于服务器的负载均衡」</li> <li>304 协商缓存「服务器资源没有更新」</li> <li>400 请求参数有误</li> <li>401 无权限访问</li> <li>403 服务器拒绝访问「原因没有告知」</li> <li>404 请求地址不存在</li> <li>405 请求方式不被允许</li> <li>408 请求超时</li> <li>500 未知的服务器错误</li> <li>502 服务器网关错误</li> <li>503 服务器超负荷</li></ul> <h3 id="_3-常见的请求方式"><a href="#_3-常见的请求方式" class="header-anchor">#</a> 3，常见的请求方式</h3> <ul><li>GET系列：GET、HEAD、DELETE、OPTIONS</li> <li>POST系列：POST、PUT、PATCH</li></ul> <p>平时开发的时候，大家约定俗成的规范：基于GET系列发送请求，我们把传递的信息以“问号传参”的方式发送给服务器，如果是基于POST系列发送请求，则我们把传递的信息，基于“请求主体”发送给服务器！</p> <ul><li><p>浏览器对于URL地址的长度是有限制的「IE 2KB、谷歌 8KB」, 而基于GET方式发送请求，需要把传递的信息，以问号传参的方式，拼接到URL的末尾，这样对于传递信息的大小就有了限制！而POST系列请求，是基于请求主体把信息给服务器，请求主体理论上是没有大小限制的（实际开发中我们会自行限制）！</p></li> <li><p>GET请求容易产生缓存，而POST请求不会</p> <ul><li><p>问题描述：如果很短的时间内，向服务器发送多个请求，这些请求的地址及传参信息都一模一样，那么后面请求很有可能获取的是第一个请求缓存的信息！</p></li> <li><p>解决方案：只要保证每一次请求传递的参数不完全一致即可「多加一个参数 _=随机数/时间戳 」</p></li> <li><p>xhr.open('GET',   <code>/api/list?lx=1&amp;name=AA&amp;_=${+new Date()}</code>)</p></li></ul></li> <li><p>GET请求相对于POST请求来讲，是不安全的「但是POST也不安全，互联网面前人人都在裸奔」</p></li></ul> <h3 id="_4-tcp和udp"><a href="#_4-tcp和udp" class="header-anchor">#</a> 4，TCP和UDP</h3> <ul><li>TCP经过三次握手，建立起一个“稳定可靠”的传输通道；但是因为每一次的通信，都需要经过三次握手，确保通道稳定后再传输，这样导致传输效率慢！</li> <li>UDP是不需要经过三次握手的，每一次的传输都是直接进行，这样保证传输的效率，但是不能保证传输的稳定性！</li></ul></div></section> <footer class="page-edit"><!----> <!----></footer> <!----> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-7115df4a data-v-1c636796><li class="level-2" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#一-ajax初识" class="sidebar-link reco-side-一-ajax初识" data-v-7115df4a>一，Ajax初识</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_0-搭建后端代码" class="sidebar-link reco-side-_0-搭建后端代码" data-v-7115df4a>0，搭建后端代码</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_1-原生ajax经典步骤" class="sidebar-link reco-side-_1-原生ajax经典步骤" data-v-7115df4a>1，原生Ajax经典步骤</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_2-xhr对象的load事件" class="sidebar-link reco-side-_2-xhr对象的load事件" data-v-7115df4a>2，xhr对象的load事件</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_3-响应json数据-指定响应类型" class="sidebar-link reco-side-_3-响应json数据-指定响应类型" data-v-7115df4a>3，响应JSON数据, 指定响应类型</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_4-响应xml数据" class="sidebar-link reco-side-_4-响应xml数据" data-v-7115df4a>4，响应XML数据</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_5-响应的状态status" class="sidebar-link reco-side-_5-响应的状态status" data-v-7115df4a>5，响应的状态status</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_6-url地址的编码和解码" class="sidebar-link reco-side-_6-url地址的编码和解码" data-v-7115df4a>6，URL地址的编码和解码</a></li><li class="level-2" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#二-给服务器传递参数" class="sidebar-link reco-side-二-给服务器传递参数" data-v-7115df4a>二，给服务器传递参数</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_1-我们可以给服务器传递哪些参数" class="sidebar-link reco-side-_1-我们可以给服务器传递哪些参数" data-v-7115df4a>1，我们可以给服务器传递哪些参数</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_2-查询字符串数据-query参数" class="sidebar-link reco-side-_2-查询字符串数据-query参数" data-v-7115df4a>2，查询字符串数据（query参数）</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_3-路径参数-params参数" class="sidebar-link reco-side-_3-路径参数-params参数" data-v-7115df4a>3，路径参数（params参数）</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_4-表单数据" class="sidebar-link reco-side-_4-表单数据" data-v-7115df4a>4，表单数据</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_5-formdata数据" class="sidebar-link reco-side-_5-formdata数据" data-v-7115df4a>5，formdata数据</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_6-上传json数据" class="sidebar-link reco-side-_6-上传json数据" data-v-7115df4a>6，上传JSON数据</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_7-文件数据" class="sidebar-link reco-side-_7-文件数据" data-v-7115df4a>7，文件数据</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_9-通过请求头传递数据" class="sidebar-link reco-side-_9-通过请求头传递数据" data-v-7115df4a>9，通过请求头传递数据</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_10-延迟时间timeout和取消请求" class="sidebar-link reco-side-_10-延迟时间timeout和取消请求" data-v-7115df4a>10，延迟时间timeout和取消请求</a></li><li class="level-2" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#三-ajax小案例" class="sidebar-link reco-side-三-ajax小案例" data-v-7115df4a>三，Ajax小案例</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_1-检测用户名是否存在" class="sidebar-link reco-side-_1-检测用户名是否存在" data-v-7115df4a>1，检测用户名是否存在</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_2-省市区三级联动" class="sidebar-link reco-side-_2-省市区三级联动" data-v-7115df4a>2，省市区三级联动</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_3-传统ajax分页" class="sidebar-link reco-side-_3-传统ajax分页" data-v-7115df4a>3，传统ajax分页</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_4-点击加载更多" class="sidebar-link reco-side-_4-点击加载更多" data-v-7115df4a>4，点击加载更多</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_5-滚动加载更多" class="sidebar-link reco-side-_5-滚动加载更多" data-v-7115df4a>5，滚动加载更多</a></li><li class="level-2" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#四-axios" class="sidebar-link reco-side-四-axios" data-v-7115df4a>四，Axios</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_1-认识axios" class="sidebar-link reco-side-_1-认识axios" data-v-7115df4a>1，认识axios</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_2-发get请求" class="sidebar-link reco-side-_2-发get请求" data-v-7115df4a>2，发get请求</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_3-get请求传参" class="sidebar-link reco-side-_3-get请求传参" data-v-7115df4a>3，get请求传参</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_4-发post请求" class="sidebar-link reco-side-_4-发post请求" data-v-7115df4a>4，发post请求</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_5-其它" class="sidebar-link reco-side-_5-其它" data-v-7115df4a>5，其它</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_6-axios创建实例" class="sidebar-link reco-side-_6-axios创建实例" data-v-7115df4a>6，axios创建实例</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_7-请求和响应拦截器" class="sidebar-link reco-side-_7-请求和响应拦截器" data-v-7115df4a>7，请求和响应拦截器</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_8-取消请求" class="sidebar-link reco-side-_8-取消请求" data-v-7115df4a>8，取消请求</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_9-简单二次封装" class="sidebar-link reco-side-_9-简单二次封装" data-v-7115df4a>9，简单二次封装</a></li><li class="level-2" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#五-jsonp" class="sidebar-link reco-side-五-jsonp" data-v-7115df4a>五，JSONP</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_1-jsonp原理" class="sidebar-link reco-side-_1-jsonp原理" data-v-7115df4a>1，JSONP原理</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_2-jsonp案例" class="sidebar-link reco-side-_2-jsonp案例" data-v-7115df4a>2，JSONP案例</a></li><li class="level-2" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#六-网络理论补充" class="sidebar-link reco-side-六-网络理论补充" data-v-7115df4a>六，网络理论补充</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_1-从输入url地址到看到页面-中间都经历了啥" class="sidebar-link reco-side-_1-从输入url地址到看到页面-中间都经历了啥" data-v-7115df4a>1，从输入URL地址到看到页面，中间都经历了啥？</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_2-常见的http状态码" class="sidebar-link reco-side-_2-常见的http状态码" data-v-7115df4a>2，常见的HTTP状态码</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_3-常见的请求方式" class="sidebar-link reco-side-_3-常见的请求方式" data-v-7115df4a>3，常见的请求方式</a></li><li class="level-3" data-v-7115df4a><a href="/javablog/public/blogs/base/10.html#_4-tcp和udp" class="sidebar-link reco-side-_4-tcp和udp" data-v-7115df4a>4，TCP和UDP</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-65133105 data-v-65133105><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-65133105><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-65133105></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-65133105></path></svg></div></div></div>
    <script src="/javablog/public/assets/js/app.134b6f67.js" defer></script><script src="/javablog/public/assets/js/11.872216ae.js" defer></script><script src="/javablog/public/assets/js/1.4a2aebf2.js" defer></script><script src="/javablog/public/assets/js/7.f81bb9de.js" defer></script>
  </body>
</html>
