(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{10179:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h3",{attrs:{id:"_1-认识分布式流量防护"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-认识分布式流量防护"}},[s._v("#")]),s._v(" 1, 认识分布式流量防护")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8931),alt:"1717038176870"}})]),s._v(" "),t("p",[s._v("在分布式系统中，服务之间的相互调用会生成分布式流量。如何通过组件进行流量防护，并有效控制流量，是分布式系统的技术挑战之一。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8932),alt:"1717038345718"}})]),s._v(" "),t("p",[t("strong",[s._v("什么是服务雪崩：")])]),s._v(" "),t("p",[s._v("假设我有一个微服务系统，这个系统内包含了 ABCD 四个微服务，这四个服务都是以集群模式构建的。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8933),alt:"1717038022938"}})]),s._v(" "),t("p",[t("strong",[s._v("雪崩问题：")])]),s._v(" "),t("p",[s._v("微服务之间相互调用，因为调用链中的一个服务故障，引起整个链路都无法访问的情况。")]),s._v(" "),t("p",[t("strong",[s._v("解决方案：")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("超时机制")])]),s._v(" "),t("li",[t("p",[s._v("舱壁模式")])]),s._v(" "),t("li",[t("p",[s._v("熔断器")])]),s._v(" "),t("li",[t("p",[s._v("流量控制")])])]),s._v(" "),t("p",[t("strong",[s._v("服务保护技术：")])]),s._v(" "),t("ul",[t("li",[s._v("Hystrix")]),s._v(" "),t("li",[s._v("Sentinel")]),s._v(" "),t("li",[s._v("Resilience4J")])]),s._v(" "),t("p",[t("strong",[s._v("Sentinel 服务容错的思路：")])]),s._v(" "),t("p",[s._v("Sentinel 是 Spring Cloud Alibaba 的⼀款服务容错组件，我们也经常把它叫做“防流量哨兵”。它是阿里巴巴双十一促核心场景的保护神，内置了丰富的服务容错应用场景。它以流 量作为切入点，通过各种内外防控手段达到维持服务稳定性的目的。")]),s._v(" "),t("p",[t("strong",[s._v("内部异常治理：")])]),s._v(" "),t("p",[s._v("在 Sentinel 中，我们可以采用降级和熔断的方式处理内部的异常。 所谓降级，是指当服务调用发生了响应超时、服务异常等情况时，我们在服务内部可以执行一段“降级逻辑”。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8934),alt:"1717038210022"}})]),s._v(" "),t("p",[s._v("而所谓熔断，是指当异常调用量达到一定的判定条件，比如在异常降级和慢调用请求的比例达到⼀个阈值、窗口时间内降级请求达到⼀定数量的情况下，微服务在一段时间内停止对⽬标服务发起调用，所有来访请求直接执行降级逻辑。所以，熔断是“多次服务调用异常”累积的结果。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8935),alt:"1717038246854"}})]),s._v(" "),t("p",[t("strong",[s._v("外部流量控制：")])]),s._v(" "),t("p",[s._v("限流是流量整形流控方案的一种。在 Sentinel 中我们可以根据集群的处理能力，为每个服务设置⼀个限流规则，从 QPS 维度或者并发线程数的维度控制外部的访问流量。⼀旦访问量超过阈值，后续的请求就会被 “fast fail”，这是最为常用的⼀种限流手段。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8936),alt:"1717038320081"}})]),s._v(" "),t("h3",{attrs:{id:"_2-认识sentinel"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-认识sentinel"}},[s._v("#")]),s._v(" 2, 认识Sentinel")]),s._v(" "),t("p",[s._v("官网：https://sentinelguard.io/zh-cn/")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8937),alt:"1717038384151"}})]),s._v(" "),t("p",[s._v("Sentinel是阿里开源的项目，提供了流量控制、熔断降级、系统负载保护等多个维度来保障服务之间的稳定性。")]),s._v(" "),t("p",[t("strong",[s._v("Sentinel 的历史：")])]),s._v(" "),t("ul",[t("li",[s._v("2012 年，Sentinel 诞生，主要功能为入口流量控制。")]),s._v(" "),t("li",[s._v("2013-2017 年，Sentinel 在阿里巴巴集团内部迅速发展，成为基础技术模块，覆盖了所有的核心场景。")]),s._v(" "),t("li",[s._v("2018 年，Sentinel 开源，并持续演进。")]),s._v(" "),t("li",[s._v("2019 年，Sentinel 朝着多语言扩展的方向不断探索，推出 "),t("a",{attrs:{href:"https://github.com/alibaba/sentinel-cpp",target:"_blank",rel:"noopener noreferrer"}},[s._v("C++ 原生版本"),t("OutboundLink")],1),s._v("，同时针对 Service Mesh 场景也推出了 "),t("a",{attrs:{href:"https://github.com/alibaba/Sentinel/tree/master/sentinel-cluster/sentinel-cluster-server-envoy-rls",target:"_blank",rel:"noopener noreferrer"}},[s._v("Envoy 集群流量控制支持"),t("OutboundLink")],1),s._v("，以解决 Service Mesh 架构下多语言限流的问题。")]),s._v(" "),t("li",[s._v("2020 年，推出 "),t("a",{attrs:{href:"https://github.com/alibaba/sentinel-golang",target:"_blank",rel:"noopener noreferrer"}},[s._v("Sentinel Go 版本"),t("OutboundLink")],1),s._v("，继续朝着云原生方向演进。")]),s._v(" "),t("li",[s._v("2021 年，Sentinel 正在朝着 2.0 云原生高可用决策中心组件进行演进；同时推出了 "),t("a",{attrs:{href:"https://github.com/sentinel-group/sentinel-rust",target:"_blank",rel:"noopener noreferrer"}},[s._v("Sentinel Rust 原生版本"),t("OutboundLink")],1),s._v("。同时我们也在 Rust 社区进行了 Envoy WASM extension 及 eBPF extension 等场景探索。")]),s._v(" "),t("li",[s._v("2022 年，Sentinel 品牌升级为流量治理，领域涵盖流量路由/调度、流量染色、流控降级、过载保护/实例摘除等；同时社区将流量治理相关标准抽出到 "),t("a",{attrs:{href:"https://opensergo.io/zh-cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("OpenSergo 标准"),t("OutboundLink")],1),s._v("中，Sentinel 作为流量治理标准实现。")])]),s._v(" "),t("p",[t("strong",[s._v("Sentinel 基本概念之资源：")])]),s._v(" "),t("p",[s._v("资源是 Sentinel 的关键概念。它可以是 Java 应用程序中的任何内容，例如，由应用程序提供的服务，或由应用程序调用的其它应用提供的服务，甚至可以是一段代码。只要通过 Sentinel API 定义的代码，就是资源，能够被 Sentinel 保护起来。大部分情况下，可以使用方法签名，URL，甚至服务名称作为资源名来标示资源。")]),s._v(" "),t("p",[t("strong",[s._v("Sentinel 基本概念之规则：")])]),s._v(" "),t("p",[s._v("围绕资源的实时状态设定的规则，可以包括流量控制规则、熔断降级规则以及系统保护规则。所有规则可以动态实时调整。")]),s._v(" "),t("p",[t("strong",[s._v("Sentinel 的主要特性：")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(8938),alt:"1717038652667"}})]),s._v(" "),t("p",[t("strong",[s._v("特性：")])]),s._v(" "),t("ul",[t("li",[s._v("丰富的应用场景：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀(即突发流量控制在系统容量可以承受的范围)、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等。")]),s._v(" "),t("li",[s._v("完备的实时监控：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况。")]),s._v(" "),t("li",[s._v("广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Dubbo、gRPC 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。")]),s._v(" "),t("li",[s._v("完善的 SPI 扩展点：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等。")])]),s._v(" "),t("p",[t("strong",[s._v("Sentinel 分为两个部分：")])]),s._v(" "),t("ul",[t("li",[s._v("控制台（Dashboard）：Dashboard 主要负责管理推送规则、监控、管理机器信息等。")]),s._v(" "),t("li",[s._v("核心库（Java 客户端）：不依赖任何框架/库，能够运行于 Java 8 及以上的版本的运行时环境，同时对 Dubbo / Spring Cloud 等框架也有较好的支持。")])]),s._v(" "),t("p",[s._v("Sentinel 可以简单的分为 Sentinel 核心库和 Dashboard。核心库不依赖 Dashboard，但是结合 Dashboard 可以取得最好的效果。")]),s._v(" "),t("p",[t("strong",[s._v("Sentinel 的主要工作机制如下：")])]),s._v(" "),t("ul",[t("li",[s._v("对主流框架提供适配或者显示的 API，来定义需要保护的资源，并提供设施对资源进行实时统计和调用链路分析。")]),s._v(" "),t("li",[s._v("根据预设的规则，结合对资源的实时统计信息，对流量进行控制。同时，Sentinel 提供开放的接口，方便您定义及改变规则。")]),s._v(" "),t("li",[s._v("Sentinel 提供实时的监控系统，方便您快速了解目前系统的状态。")])]),s._v(" "),t("p",[t("strong",[s._v("Sentinel 与 Hystrix、resilience4j 的对比：")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("Sentinel")]),s._v(" "),t("th",[s._v("Hystrix")]),s._v(" "),t("th",[s._v("resilience4j")]),s._v(" "),t("th")])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("隔离策略")]),s._v(" "),t("td",[s._v("信号量隔离（并发线程数限流）")]),s._v(" "),t("td",[s._v("线程池隔离/信号量隔离")]),s._v(" "),t("td",[s._v("线程池隔离/信号量隔离")])]),s._v(" "),t("tr",[t("td",[s._v("熔断降级策略")]),s._v(" "),t("td",[s._v("基于响应时间、异常比率、异常数")]),s._v(" "),t("td",[s._v("基于异常比率")]),s._v(" "),t("td",[s._v("基于异常比率、响应时间")])]),s._v(" "),t("tr",[t("td",[s._v("实时统计实现")]),s._v(" "),t("td",[s._v("滑动窗口（LeapArray）")]),s._v(" "),t("td",[s._v("滑动窗口（基于 RxJava）")]),s._v(" "),t("td",[s._v("Ring Bit Buffer")])]),s._v(" "),t("tr",[t("td",[s._v("动态规则配置")]),s._v(" "),t("td",[s._v("支持多种数据源")]),s._v(" "),t("td",[s._v("支持多种数据源")]),s._v(" "),t("td",[s._v("有限支持")])]),s._v(" "),t("tr",[t("td",[s._v("扩展性")]),s._v(" "),t("td",[s._v("多个扩展点")]),s._v(" "),t("td",[s._v("插件的形式")]),s._v(" "),t("td",[s._v("接口的形式")])]),s._v(" "),t("tr",[t("td",[s._v("基于注解的支持")]),s._v(" "),t("td",[s._v("支持")]),s._v(" "),t("td",[s._v("支持")]),s._v(" "),t("td",[s._v("支持")])]),s._v(" "),t("tr",[t("td",[s._v("限流")]),s._v(" "),t("td",[s._v("基于 QPS，支持基于调用关系的限流")]),s._v(" "),t("td",[s._v("有限的支持")]),s._v(" "),t("td",[s._v("Rate Limiter")])]),s._v(" "),t("tr",[t("td",[s._v("流量整形")]),s._v(" "),t("td",[s._v("支持预热模式、匀速器模式、预热排队模式")]),s._v(" "),t("td",[s._v("不支持")]),s._v(" "),t("td",[s._v("简单的 Rate Limiter 模式")])]),s._v(" "),t("tr",[t("td",[s._v("系统自适应保护")]),s._v(" "),t("td",[s._v("支持")]),s._v(" "),t("td",[s._v("不支持")]),s._v(" "),t("td",[s._v("不支持")])]),s._v(" "),t("tr",[t("td",[s._v("控制台")]),s._v(" "),t("td",[s._v("提供开箱即用的控制台，可配置规则、查看秒级监控、机器发现等")]),s._v(" "),t("td",[s._v("简单的监控查看")]),s._v(" "),t("td",[s._v("不提供控制台，可对接其它监控系统")])])])]),s._v(" "),t("h3",{attrs:{id:"_3-安装sentinel控制台"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装sentinel控制台"}},[s._v("#")]),s._v(" 3, 安装Sentinel控制台")]),s._v(" "),t("p",[s._v("Sentinel 提供一个轻量级的开源控制台，它提供机器发现以及健康情况管理、监控（单机和集群），规则管理和推送的功能。")]),s._v(" "),t("p",[t("strong",[s._v("Sentinel 控制台包含如下功能：")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("查看机器列表以及健康情况：收集 Sentinel 客户端发送的心跳包，用于判断机器是否在线。")])]),s._v(" "),t("li",[t("p",[s._v("监控 (单机和集群聚合**)**：通过 Sentinel 客户端暴露的监控 API，定期拉取并且聚合应用监控信息，最终可以实现秒级的实时监控。")])]),s._v(" "),t("li",[t("p",[s._v("规则管理和推送：统一管理推送规则。")])]),s._v(" "),t("li",[t("p",[s._v("鉴权：生产环境中鉴权非常重要。这里每个开发者需要根据自己的实际情况进行定制。")])])]),s._v(" "),t("p",[s._v("注意：Sentinel 控制台目前仅支持单机部署。Sentinel 控制台项目提供 Sentinel 功能全集示例，不作为开箱即用的生产环境控制台，若希望在生产环境使用请根据"),t("a",{attrs:{href:"https://github.com/alibaba/Sentinel/wiki/%E5%9C%A8%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E4%B8%AD%E4%BD%BF%E7%94%A8-Sentinel",target:"_blank",rel:"noopener noreferrer"}},[s._v("文档"),t("OutboundLink")],1),s._v("自行进行定制和改造。")]),s._v(" "),t("p",[t("strong",[s._v("获取 Sentinel 控制台：")])]),s._v(" "),t("p",[s._v("您可以从"),t("a",{attrs:{href:"https://github.com/alibaba/Sentinel/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/alibaba/Sentinel/releases"),t("OutboundLink")],1),s._v("下载最新版本的控制台 jar 包。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8939),alt:"1717038967908"}})]),s._v(" "),t("p",[s._v("把jar包扔到服务器上：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8940),alt:"1717039165624"}})]),s._v(" "),t("p",[s._v("关掉网关：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8941),alt:"1717039266189"}})]),s._v(" "),t("p",[s._v("**启动 Sentinel 控制台：**启动 Sentinel 控制台需要 JDK 版本为 1.8 及以上版本。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("#前台运行\njava -Dserver.port=8081 -Dcsp.sentinel.dashboard.server=103.38.81.223:8081 -Dproject.name=sentinel-dashboard -jar sentinel-dashboard-1.8.6.jar\n\n#后台运行\nnohup java  -Dserver.port=8480 -Dcsp.sentinel.dashboard.server=103.38.81.223:8480 -Dproject.name=sentinel-dashboard -jar sentinel-dashboard-1.8.6.jar >> /opt/sentinel.log 2>&1 &\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[t("img",{attrs:{src:a(8942),alt:"1717040108390"}})]),s._v(" "),t("p",[t("strong",[s._v("访问 Sentinel 控制台:")])]),s._v(" "),t("p",[s._v("在浏览器输入http://103.38.81.223:8480/即可，登录用户名密码都是sentinel。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8943),alt:"1717040128143"}})]),s._v(" "),t("h3",{attrs:{id:"_4-将应用接入sentinel"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-将应用接入sentinel"}},[s._v("#")]),s._v(" 4, 将应用接入Sentinel")]),s._v(" "),t("p",[s._v("创建新模块：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8944),alt:"1717040935169"}})]),s._v(" "),t("p",[s._v("依赖：")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependencies")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!-- nacos依赖包  --\x3e")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--<dependency>--\x3e")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--    <groupId>com.alibaba.cloud</groupId>--\x3e")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--    <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>--\x3e")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--</dependency>--\x3e")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!-- sentinel依赖--\x3e")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("com.alibaba.cloud"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-cloud-starter-alibaba-sentinel"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-web"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--借用监控开放端口--\x3e")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-actuator"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.projectlombok"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("lombok"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependencies")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br")])]),t("p",[s._v("编写YML配置文件:")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8945),alt:"1717040528415"}})]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8787")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#应用名字")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" payment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("sentinel\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sentinel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("transport")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Sentinel 控制台地址")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dashboard")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 103.38.81.223"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8480")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("启动类：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8946),alt:"1717040629285"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ityls")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("lombok"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("extern"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("slf4j"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Slf4j")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("boot"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpringApplication")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("boot"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("autoconfigure"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpringBootApplication")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SpringBootApplication")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Slf4j")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PaymentSentinelApplication")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SpringApplication")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PaymentSentinelApplication")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("info")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"************ PaymentSentinelApplication 启动成功 **********"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("编写controller:")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8947),alt:"1717040762735"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ityls"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("controller")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bind"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GetMapping")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bind"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("annotation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RestController")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PaymentController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/testA"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testA")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"------------testA"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8948),alt:"1717040950347"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8949),alt:"1717041007683"}})]),s._v(" "),t("p",[s._v("打包，扔到服务器上：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8950),alt:"1717047269951"}})]),s._v(" "),t("p",[s._v("再测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8951),alt:"1717047724905"}})]),s._v(" "),t("h3",{attrs:{id:"_5-流量控制概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-流量控制概述"}},[s._v("#")]),s._v(" 5, 流量控制概述")]),s._v(" "),t("p",[s._v("监控应用流量的 QPS 或并发线程数，当达到指定的阈值时对流量进行控制，以避免被瞬时的流量高峰冲垮，从而保障应用的高可用性。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8952),alt:"1717046685390"}})]),s._v(" "),t("p",[s._v("流量控制有以下几个角度:")]),s._v(" "),t("ul",[t("li",[s._v("资源的调用关系：例如资源的调用链路，资源和资源之间的关系；")]),s._v(" "),t("li",[s._v("运行指标：例如 QPS、线程池、系统负载等；")]),s._v(" "),t("li",[s._v("控制的效果：例如直接限流、冷启动、排队等。")])]),s._v(" "),t("p",[s._v("注意：Sentinel 的设计理念是让您自由选择控制的角度，并进行灵活组合，从而达到想要的效果。")]),s._v(" "),t("p",[t("strong",[s._v("流控规则：")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(8953),alt:"1717048028857"}})]),s._v(" "),t("p",[t("strong",[s._v("参数：")])]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("资源名")]),s._v("：其实就是我们请求的资源路径")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("针对来源")]),s._v('：这个是此流控规则对应那些微服务进行流控管理，一般填写调用方的微服务名称，多个用","分割')])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("阈值类型")]),s._v("：一般有2中类型，QPS（每秒的最大请求数2）和线程数（并发线程数）")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("单机阈值")]),s._v("：单机状态下的最大限制值")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("是否集群")]),s._v("：根据实际情况选择")])])]),s._v(" "),t("p",[t("strong",[s._v("流控模式：")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(8954),alt:"1717048212202"}})]),s._v(" "),t("p",[t("strong",[s._v("参数：")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("直接")]),s._v("：直接作用于当前资源，如果访问压力大于某个阈值，后续请求将被直接拦下来；")]),s._v(" "),t("li",[t("strong",[s._v("关联")]),s._v("：统计与当前资源相关的另一个资源，触发阈值时，对当前资源限流")]),s._v(" "),t("li",[t("strong",[s._v("链路")]),s._v("：当指定链路上的访问量⼤于某个阈值时，对当前资源进⾏限流，这⾥的“指定链 路”是细化到 API 级别的限流维度。")])]),s._v(" "),t("p",[t("strong",[s._v("流控效果：")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(8955),alt:"1717048282382"}})]),s._v(" "),t("p",[t("strong",[s._v("参数：")])]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("快速失败")]),s._v("：默认的流量控制方式，当QPS超过任意规则的阈值后，新的请求就会被立即拒绝，拒绝方式为抛出"),t("code",[s._v("FlowException")]),s._v("。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("Warm Up")]),s._v('：即预热/冷启动方式。当系统长期处于低水位的情况下，当流量突然增加时，直接把系统拉升到高水位可能瞬间把系统压垮。通过"冷启动"，让通过的流量缓慢增加，在一定时间内逐渐增加到阈值上限，给冷系统一个预热的时间，避免冷系统被压。')])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("排队等待")]),s._v("：匀速排队方式会严格控制请求通过的间隔时间，也即是让请求以均匀的速度通过，对应的是漏桶算法 。这种方式主要用于处理间隔性突发的流量。")])])]),s._v(" "),t("h3",{attrs:{id:"_6-流控模式之直接模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-流控模式之直接模式"}},[s._v("#")]),s._v(" 6, 流控模式之直接模式")]),s._v(" "),t("p",[s._v("当 QPS 超过某个阈值的时候，则采取措施进行流量控制。若使用除了直接拒绝之外的流量控制效果，则调用关系限流策略（strategy）会被忽略。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8956),alt:"1717049085818"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8957),alt:"1717049111242"}})]),s._v(" "),t("p",[s._v("表示1秒钟内查询1次就ok，若超过1次，就直接快速失败，报默认错误。")]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8958),alt:"1717049173154"}})]),s._v(" "),t("h3",{attrs:{id:"_7-流控模式之关联模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-流控模式之关联模式"}},[s._v("#")]),s._v(" 7, 流控模式之关联模式")]),s._v(" "),t("p",[s._v("当关联的资源达到阈值时，就限流自己。比如有两个接口，是存在竞争关系的，当请求1个接口时，会影响另一个接口的性能。定义如下两个接口：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8959),alt:"1717049510151"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//  /query和/update就存在竞争关系   当大量请求/update时，就会影响/query")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("query")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"订单内容"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/update"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"更新订单"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("打包，传到服务器上，如下：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8960),alt:"1717049659295"}})]),s._v(" "),t("p",[s._v("查看：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8961),alt:"1717049764257"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8962),alt:"1717049788021"}})]),s._v(" "),t("p",[s._v("配置：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8963),alt:"1717049867592"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8964),alt:"1717050021807"}})]),s._v(" "),t("h3",{attrs:{id:"_8-流控模式之链路模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-流控模式之链路模式"}},[s._v("#")]),s._v(" 8, 流控模式之链路模式")]),s._v(" "),t("p",[s._v("链路流控模式指的是，当从某个接口过来的资源达到限流条件时，开启限流。它的功能有点类似于针对来源配置项，区别在于："),t("strong",[s._v("针对来源是针对上级微服务，而链路流控是针对上级接口，也就是说它的粒度更细。")])]),s._v(" "),t("p",[t("strong",[s._v("配置示例")]),s._v("：")]),s._v(" "),t("p",[s._v("例如有两条请求链路：")]),s._v(" "),t("ul",[t("li",[s._v("/test1 --\x3e /common")]),s._v(" "),t("li",[s._v("/test2 --\x3e /common")])]),s._v(" "),t("p",[s._v("如果只希望统计从/test2进入到/common的请求，则可以这样配置：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8965),alt:"1717051831920"}})]),s._v(" "),t("p",[s._v("需求：有查询订单和创建订单业务，两者都需要查询商品。针对从查询订单进入到查询商品的请求统计，并设置限流。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8966),alt:"1717051904005"}})]),s._v(" "),t("p",[s._v("添加订单：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8967),alt:"1717052010683"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8968),alt:"1717052226543"}})]),s._v(" "),t("p",[s._v("如果想让service中的方法，出现在簇点链路中，只需要添加一个注解（表示它是一个资源）：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8969),alt:"1717052341697"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GoodsService")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SentinelResource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/goods"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryGoods")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"商品信息"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("在controller中注入：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8970),alt:"1717052471371"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PaymentController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GoodsService")]),s._v(" goodsService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/testA"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testA")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"------------testA"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/query"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("query")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("goodsService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryGoods")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"订单内容"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/update"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("update")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"更新订单"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/save"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("save")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("goodsService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("queryGoods")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"添加订单"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("p",[s._v("还需要做一个配置：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8971),alt:"1717052551565"}})]),s._v(" "),t("p",[s._v("重新打包，上线，部署：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8972),alt:"1717052700562"}})]),s._v(" "),t("p",[s._v("查看：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8973),alt:"1717052925934"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8974),alt:"1717053027702"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8975),alt:"1717053084370"}})]),s._v(" "),t("h3",{attrs:{id:"_9-流控效果之预热"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-流控效果之预热"}},[s._v("#")]),s._v(" 9, 流控效果之预热")]),s._v(" "),t("p",[s._v("warm up也叫预热模式**，**是应对服务冷启动的一种方案。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8976),alt:"1717062000546"}})]),s._v(" "),t("p",[s._v("QPS为10.刚刚启动时，大部分请求失败，成功的只有3个，说明QPS被限定在3，随着时间推移，成功比例越来越高。")]),s._v(" "),t("p",[s._v("有如下接口：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8977),alt:"1717062271101"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8978),alt:"1717062334818"}})]),s._v(" "),t("p",[s._v("配置：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8979),alt:"1717062427848"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8980),alt:"1717062712035"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8981),alt:"1717062596036"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8982),alt:"1717062842425"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8983),alt:"1717062901312"}})]),s._v(" "),t("h3",{attrs:{id:"_10-热点参数限流"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-热点参数限流"}},[s._v("#")]),s._v(" 10, 热点参数限流")]),s._v(" "),t("p",[t("strong",[s._v("什么是热点：")])]),s._v(" "),t("p",[s._v("热点即经常访问的数据。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8984),alt:"1717062957599"}})]),s._v(" "),t("p",[t("strong",[s._v("例子：")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("手机热点： 华为手机、苹果手机等")])]),s._v(" "),t("li",[t("p",[s._v("化妆品热点： 迪奥口红、香奈儿香水等")])])]),s._v(" "),t("p",[t("strong",[s._v("热点参数限流")]),s._v("，给/findById这个资源添加热点参数限流，规则如下：")]),s._v(" "),t("ul",[t("li",[s._v("默认的热点参数规则是每1秒请求量不超过2")]),s._v(" "),t("li",[s._v("给102这个参数设置例外：每1秒请求量不超过4")]),s._v(" "),t("li",[s._v("给103这个参数设置例外：每1秒请求量不超过10")])]),s._v(" "),t("p",[s._v("热点参数限流对默认的SpringMVC资源无效，需要利用@SentinelResource注解标记资源。")]),s._v(" "),t("p",[s._v("再写一个接口：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8985),alt:"1717063426243"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/goods"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GoodsController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SentinelResource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hot"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/getGoods"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("goods")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" goodsName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" goodsName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("打包，上线，部署，如下：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8986),alt:"1717063688044"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8987),alt:"1717063679706"}})]),s._v(" "),t("p",[s._v("配置：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8988),alt:"1717063826155"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8989),alt:"1717063901679"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8990),alt:"1717063999199"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8991),alt:"1717064032226"}})]),s._v(" "),t("h3",{attrs:{id:"_11-线程隔离"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_11-线程隔离"}},[s._v("#")]),s._v(" 11, 线程隔离")]),s._v(" "),t("p",[s._v("限流是一种预防措施，虽然限流可以尽量避免因高并发而引起的服务故障，但服务还会因为其它原因而故障。而要将这些故障控制在一定范围，避免雪崩，就要靠"),t("strong",[s._v("线程隔离")]),s._v("（舱壁模式）和"),t("strong",[s._v("熔断降级")]),s._v("手段了。")]),s._v(" "),t("p",[t("strong",[s._v("线程隔离（舱壁模式）：")])]),s._v(" "),t("ul",[t("li",[s._v("线程池隔离")]),s._v(" "),t("li",[s._v("信号量隔离（Sentinel默认采用）")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(8992),alt:"1717064174868"}})]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("线程池隔离")]),s._v("：给每个服务调用业务分配一个线程池，利用线程池本身实现隔离效果")]),s._v(" "),t("li",[t("strong",[s._v("信号量隔离")]),s._v("：不创建线程池，而是计数器模式，记录业务使用的线程数量，达到信号量上限时，禁止新的请求。")])]),s._v(" "),t("p",[s._v("在添加限流规则时，可以选择两种阈值类型：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8993),alt:"1717064260574"}})]),s._v(" "),t("ul",[t("li",[s._v("QPS：每秒的请求数")]),s._v(" "),t("li",[s._v("线程数：该资源能使用用的Tomcat线程数的最大值。也就是通过限制线程数量，实现线程隔离（舱壁模式）。")])]),s._v(" "),t("p",[s._v("配置：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8994),alt:"1717064427361"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(8995),alt:"1717064436847"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8996),alt:"1717064683724"}})]),s._v(" "),t("h3",{attrs:{id:"_12-熔断降级"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_12-熔断降级"}},[s._v("#")]),s._v(" 12, 熔断降级")]),s._v(" "),t("p",[t("img",{attrs:{src:a(8997),alt:"1717064751365"}})]),s._v(" "),t("p",[s._v("熔断降级是解决雪崩问题的重要手段。其思路是由断路器统计服务调用的异常比例、慢请求比例，如果超出阈值则会熔断该服务。即拦截访问该服务的一切请求；而当服务恢复时，断路器会放行访问该服务的请求。")]),s._v(" "),t("p",[t("strong",[s._v("断路器控制熔断和放行是通过状态机来完成的：")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(8998),alt:"1717064722556"}})]),s._v(" "),t("p",[t("strong",[s._v("状态机包括三个状态：")])]),s._v(" "),t("ul",[t("li",[s._v("closed：关闭状态，断路器放行所有请求，并开始统计异常比例、慢请求比例。超过阈值则切换到open状态")]),s._v(" "),t("li",[s._v("open：打开状态，服务调用被熔断，访问被熔断服务的请求会被拒绝，快速失败，直接走降级逻辑。Open状态5秒后会进入half-open状态")]),s._v(" "),t("li",[s._v("half-open：半开状态，放行一次请求，根据执行结果来判断接下来的操作。 请求成功：则切换到closed状态 请求失败：则切换到open状态")])]),s._v(" "),t("p",[t("strong",[s._v("熔断降级策略：")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("慢调用：业务的响应时长（RT）大于指定时长的请求认定为慢调用请求。在指定时间内，如果请求数量超过设定的最小数量，慢调用比例大于设定的阈值，则触发熔断。")])]),s._v(" "),t("li",[t("p",[s._v("异常比例、异常数：统计指定时间内的调用，如果调用次数超过指定请求数，并且出现异常的比例达到设定的比例阈值（或超过指定异常数），则触发熔断。")])])]),s._v(" "),t("p",[t("img",{attrs:{src:a(8999),alt:"1717064926252"}})]),s._v(" "),t("h3",{attrs:{id:"_13-熔断降级之慢调用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_13-熔断降级之慢调用"}},[s._v("#")]),s._v(" 13, 熔断降级之慢调用")]),s._v(" "),t("p",[s._v("平均响应时间当1s内持续进入5个请求，对应时刻的平均响应时间(秒级)均超过阈值，那么在接下的时间窗口之内，对这个方法的调用都会自动地熔断(抛出DegradeException )。")]),s._v(" "),t("p",[s._v("新接口：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9e3),alt:"1717065070849"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/testC"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"------------testC"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("打包，上传，部署，测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9001),alt:"1717065227797"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(9002),alt:"1717065285633"}})]),s._v(" "),t("p",[s._v("配置：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9003),alt:"1717065488309"}})]),s._v(" "),t("p",[s._v("超过50ms的请求都会被认为是慢请求，当异常比例达到百分之40，断路器打开(保险丝跳闸)微服务不可用，保险丝跳闸断电了。过5秒钟由断路器又打开状态变为半开状态放一部分请求进来。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9004),alt:"1717065496048"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9005),alt:"1717065631511"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(9006),alt:"1717065660711"}})]),s._v(" "),t("h3",{attrs:{id:"_14-熔断降级之异常比例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_14-熔断降级之异常比例"}},[s._v("#")]),s._v(" 14, 熔断降级之异常比例")]),s._v(" "),t("p",[s._v("当资源每秒异常总数占通过量的比值超过阈值之后，资源进入降级状态。异常比率的阈值范围是 [0.0,1.0]。")]),s._v(" "),t("p",[s._v("新建一个接口：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9007),alt:"1717065788305"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/testD"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testD")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RuntimeException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"故意抛出异常，触发异常比例熔断"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"------------testD"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("打包，部署：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9008),alt:"1717065922921"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9009),alt:"1717065946258"}})]),s._v(" "),t("p",[s._v("配置：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9010),alt:"1717066007476"}})]),s._v(" "),t("p",[s._v("在5次请求中，"),t("strong",[s._v("只要异常比例超过0.4，也就是有2次以上的异常，就会触发熔断")]),s._v("。")]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9011),alt:"1717066068977"}})]),s._v(" "),t("h3",{attrs:{id:"_15-熔断降级之异常数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-熔断降级之异常数"}},[s._v("#")]),s._v(" 15, 熔断降级之异常数")]),s._v(" "),t("p",[s._v("异常数：当资源近1分钟的异常数目超过阈值之后会进行熔断。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9012),alt:"1717066176421"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/testF"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" age "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"------------testF"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("打包，部署：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9013),alt:"1717066331524"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9014),alt:"1717066343764"}})]),s._v(" "),t("p",[s._v("配置：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9015),alt:"1717066382665"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9016),alt:"1717066435412"}})]),s._v(" "),t("h3",{attrs:{id:"_16-授权规则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_16-授权规则"}},[s._v("#")]),s._v(" 16, 授权规则")]),s._v(" "),t("p",[s._v("授权规则可以对调用方的来源做控制，有白名单和黑名单两种方式。")]),s._v(" "),t("ul",[t("li",[s._v("白名单：来源（origin）在白名单内的调用者允许访问")]),s._v(" "),t("li",[s._v("黑名单：来源（origin）在黑名单内的调用者不允许访问")])]),s._v(" "),t("p",[s._v("点击左侧菜单的授权，可以看到授权规则：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9017),alt:"1717066498099"}})]),s._v(" "),t("ul",[t("li",[s._v("资源名：就是受保护的资源，例如/payment/{query}")]),s._v(" "),t("li",[s._v("流控应用：是来源者的名单，\n"),t("ul",[t("li",[s._v("如果是勾选白名单，则名单中的来源被许可访问。")]),s._v(" "),t("li",[s._v("如果是勾选黑名单，则名单中的来源被禁止访问。")])])])]),s._v(" "),t("p",[t("img",{attrs:{src:a(9018),alt:"1717066529490"}})]),s._v(" "),t("p",[s._v("我们允许请求从gateway到payment服务，不允许浏览器访问payment，那么白名单中就要填写"),t("strong",[s._v("网关的来源名称（origin）")]),s._v("。")]),s._v(" "),t("p",[s._v("打开网关：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9019),alt:"1717066680064"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9020),alt:"1717066748834"}})]),s._v(" "),t("p",[s._v("添加依赖：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9021),alt:"1717066795978"}})]),s._v(" "),t("p",[s._v("配置：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9022),alt:"1717066862966"}})]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8787")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#应用名字")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" payment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("sentinel\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nacos")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("discovery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server-addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 103.38.81.223"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8848")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sentinel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("transport")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Sentinel 控制台地址")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dashboard")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 103.38.81.223"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8480")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭context整合")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web-context-unify")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("添加接口：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9023),alt:"1717066943648"}})]),s._v(" "),t("p",[s._v("根据origin来判断请求是从哪里过来的：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9024),alt:"1717067095720"}})]),s._v(" "),t("p",[s._v("从请求头中获取origin:")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9025),alt:"1717067034082"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ityls"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("config")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("alibaba"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("csp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sentinel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("adapter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("spring"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("webmvc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("callback"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RequestOriginParser")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("alibaba"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nacos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("common"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("utils"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("jakarta"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("servlet"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stereotype"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Component")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 从请求头中获取origin值")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Component")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GetParseOrigin")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("implements")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RequestOriginParser")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 从请求头中获取origin值\n     * @param httpServletRequest\n     * @return\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("parseOrigin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HttpServletRequest")]),s._v(" httpServletRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" origin "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" httpServletRequest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getHeader")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"origin"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringUtils")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isEmpty")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("origin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            origin "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"blank"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" origin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("p",[s._v("这个方法的作用就是从request对象中，获取请求者的origin值并返回。默认情况下，sentinel不管请求者从哪里来，返回值永远是default，也就是说一切请求的来源都被认为是一样的值default。因此，我们需要自定义这个接口的实现，让不同的请求，返回不同的origin。")]),s._v(" "),t("p",[s._v("项目打包，部署：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9026),alt:"1717067340487"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9027),alt:"1717067358364"}})]),s._v(" "),t("p",[s._v("添加授权规则：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9028),alt:"1717067393121"}})]),s._v(" "),t("p",[s._v("再次测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9029),alt:"1717067406709"}})]),s._v(" "),t("p",[s._v("打开网关：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9030),alt:"1717067468480"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(9031),alt:"1717067495332"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(9032),alt:"1717067517640"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(9033),alt:"1717067560181"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(9034),alt:"1717067613395"}})]),s._v(" "),t("h3",{attrs:{id:"_17-系统自适应限流"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_17-系统自适应限流"}},[s._v("#")]),s._v(" 17, 系统自适应限流")]),s._v(" "),t("p",[t("strong",[s._v("引入系统自适应限流的主要的目的：")])]),s._v(" "),t("ul",[t("li",[s._v("保证系统不被拖垮")]),s._v(" "),t("li",[s._v("在系统稳定的前提下保证系统的吞吐量。")])]),s._v(" "),t("p",[t("strong",[s._v("系统规则：")])]),s._v(" "),t("p",[s._v("Sentinel的系统保护规则是从应用级别的入口流量进行控制，从单台机器的 load、CPU 使用率、平均 RT、入口 QPS 和并发线程数等几个维度监控应用指标，让系统尽可能跑在最大吞吐量的同时保证系统整体的稳定性。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9035),alt:"1717067737709"}})]),s._v(" "),t("p",[s._v("系统保护规则是应用整体维度的，而不是资源维度的，并且"),t("strong",[s._v("仅对入口流量生效")]),s._v("。入口流量指的是进入应用的流量（"),t("code",[s._v("EntryType.IN")]),s._v("），比如 Web 服务或 Dubbo 服务端接收的请求，都属于入口流量。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9036),alt:"1717067780089"}})]),s._v(" "),t("p",[t("strong",[s._v("系统规则支持以下的模式：")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Load 自适应")]),s._v("（仅对 Linux/Unix-like 机器生效）：系统的 load1 作为启发指标，进行自适应系统保护。当系统 load1 超过设定的启发值，且系统当前的并发线程数超过估算的系统容量时才会触发系统保护（BBR 阶段）。系统容量由系统的 "),t("code",[s._v("maxQps * minRt")]),s._v(" 估算得出。设定参考值一般是 "),t("code",[s._v("CPU cores * 2.5")]),s._v("。")]),s._v(" "),t("li",[t("strong",[s._v("CPU usage")]),s._v("：当系统 CPU 使用率超过阈值即触发系统保护（取值范围 0.0-1.0），比较灵敏。")]),s._v(" "),t("li",[t("strong",[s._v("平均 RT")]),s._v("：当单台机器上所有入口流量的平均 RT 达到阈值即触发系统保护，单位是毫秒。")]),s._v(" "),t("li",[t("strong",[s._v("并发线程数")]),s._v("：当单台机器上所有入口流量的并发线程数达到阈值即触发系统保护。")]),s._v(" "),t("li",[t("strong",[s._v("入口 QPS")]),s._v("：当单台机器上所有入口流量的 QPS 达到阈值即触发系统保护。")])]),s._v(" "),t("p",[t("strong",[s._v("查看cpu核数")])]),s._v(" "),t("blockquote",[t("p",[s._v('cat /proc/cpuinfo | grep "processor" | wc -l')])]),s._v(" "),t("h3",{attrs:{id:"_18-sentinelresource注解配置详解之只配置fallback"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_18-sentinelresource注解配置详解之只配置fallback"}},[s._v("#")]),s._v(" 18, SentinelResource注解配置详解之只配置fallback")]),s._v(" "),t("p",[s._v("服务降级功能，但是只是限制后，返回不可控的结果肯定是不行的，我们还要保证调用者在调用那些被限制的服务时候，不管是不是被限制，都要让他们拿到一个合理的结果，而不是扔回去一个异常就完事了。")]),s._v(" "),t("p",[s._v("Sentinel提供了这样的功能，让我们可以另外定义一个方法来代替被限制或异常服务返回数据，这就是"),t("strong",[s._v("fallback和blockHandler")]),s._v("。")]),s._v(" "),t("ul",[t("li",[s._v("fallback：针对Java本身出现的异常进行处理的对应属性。")]),s._v(" "),t("li",[s._v("blockHandler：针对违反Sentinel控制台配置规则时触发BlockException异常时对应处理的属性")])]),s._v(" "),t("p",[s._v("@SentinelResource注解用于定义资源，并提供可选的 BlockException 异常处理（仅处理Sentinel控制台配置相关异常） 和 fallback 配置项（运行时异常以及自定义异常）。")]),s._v(" "),t("p",[t("strong",[s._v("注解属性:")])]),s._v(" "),t("ul",[t("li",[t("code",[s._v("value")]),s._v("：资源名称，必需项（不能为空）")]),s._v(" "),t("li",[t("code",[s._v("entryType")]),s._v("：entry 类型，可选项（默认为 "),t("code",[s._v("EntryType.OUT")]),s._v("）")]),s._v(" "),t("li",[t("code",[s._v("blockHandler")]),s._v(" / "),t("code",[s._v("blockHandlerClass")]),s._v(": "),t("code",[s._v("blockHandler")]),s._v(" 对应处理 "),t("code",[s._v("BlockException")]),s._v(" 的函数名称，可选项。blockHandler 函数访问范围需要是 "),t("code",[s._v("public")]),s._v("，返回类型需要与原方法相匹配，参数类型需要和原方法相匹配并且最后加一个额外的参数，类型为 "),t("code",[s._v("BlockException")]),s._v("。blockHandler 函数默认需要和原方法在同一个类中。若希望使用其他类的函数，则可以指定 "),t("code",[s._v("blockHandlerClass")]),s._v(" 为对应的类的 "),t("code",[s._v("Class")]),s._v(" 对象，注意对应的函数必需为 static 函数，否则无法解析。")]),s._v(" "),t("li",[t("code",[s._v("fallback / fallbackClass")]),s._v(" ：fallback 函数名称,可选项，通常用于通用的 fallback 逻辑（即可以用于很多服务或方法）。默认 fallback 函数可以针对所有类型的异常（除了 "),t("code",[s._v("exceptionsToIgnore")]),s._v(" 里面排除掉的异常类型）进行处理。若同时配置了 fallback 和 defaultFallback，则只有 fallback 会生效。")]),s._v(" "),t("li",[t("code",[s._v("defaultFallback")]),s._v("（since 1.6.0）：默认的 fallback 函数名称")]),s._v(" "),t("li",[t("code",[s._v("exceptionsToIgnore")]),s._v("（since 1.6.0）：用于指定哪些异常被排除掉，不会计入异常统计中，也不会进入 fallback 逻辑中，而是会原样抛出。")])]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9037),alt:"1717068004178"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(9038),alt:"1717068018324"}})]),s._v(" "),t("p",[s._v("上面的提示并不优雅。添加测试接口：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9039),alt:"1717068359577"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SentinelResource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"testFallback"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fallback "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"testFallback"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"findById"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("findById")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RuntimeException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"出异常了"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"支付信息"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 降级")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testFallback")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Throwable")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"系统异常了"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("打包，部署，测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9040),alt:"1717068465441"}})]),s._v(" "),t("p",[s._v("浏览器测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9041),alt:"1717068517587"}})]),s._v(" "),t("p",[s._v("之前显示的信息如下：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9042),alt:"1717068534971"}})]),s._v(" "),t("p",[s._v("fallback 函数位置是有要求的，必须和原方法在同一个类中，但在实际需求中，我们需要放在其他类中。@SentinelResource提供了"),t("strong",[s._v("通过fallbackClass指定对应的类的Class对象")]),s._v("，添加一个static，否则无法解析。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9043),alt:"1717068585479"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ityls"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fallback")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stereotype"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Service")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PaymentFallback")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 降级方法\n     * @param id\n     * @param e\n     * @return\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("findById")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Throwable")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"服务繁忙稍等一会~~~~"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("修改注解：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9044),alt:"1717068760756"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SentinelResource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"testFallback"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fallbackClass "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PaymentFallback")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fallback "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"findById"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"findById"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("findById")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RuntimeException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"出异常了"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"支付信息"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"_19-sentinelresource配置详解之只配置blockhandler"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_19-sentinelresource配置详解之只配置blockhandler"}},[s._v("#")]),s._v(" 19, SentinelResource配置详解之只配置blockHandler")]),s._v(" "),t("p",[s._v("超出流量限制的部分是否会进入到blockHandler的方法，要注意是超出流量限制的请求调用，会进入blockHandler方法。")]),s._v(" "),t("p",[s._v("新建接口：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9045),alt:"1717069305629"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SentinelResource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"block"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("blockHandler "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"testblockHandler"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/block"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("block")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"支付信息"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testblockHandler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BlockException")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"限流降级处理，服务繁忙！"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("打包，部署，测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9046),alt:"1717069401856"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(9047),alt:"1717069445994"}})]),s._v(" "),t("p",[s._v("配置熔断：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9048),alt:"1717069490114"}})]),s._v(" "),t("p",[s._v("测试：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9049),alt:"1717070021161"}})]),s._v(" "),t("p",[t("img",{attrs:{src:a(9050),alt:"1717069954053"}})]),s._v(" "),t("p",[s._v("外置类：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(9051),alt:"1717070112615"}})]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ityls"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("blockhandler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("alibaba"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("csp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sentinel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("slots"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("block"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BlockException")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("springframework"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stereotype"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Service")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Service")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PaymentBlockHandler")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//处理sentinel熔断异常")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("blockHandler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BlockException")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"服务繁忙稍等一会~~~~"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("使用：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SentinelResource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"block"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("blockHandlerClass "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PaymentBlockHandler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("blockHandler "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"blockHandler"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/block"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("block")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"block"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[t("strong",[s._v("总结:")])]),s._v(" "),t("ul",[t("li",[s._v("流控的blockHandler自定义资源必须为public static 函数 @SentinelResource注解的value与@RequestMapping的value不一样")]),s._v(" "),t("li",[s._v("流控规则配置的资源名与@SentinelResource注解的value保持一致，才会执行@SentinelResource注解里定义的兜底方法")]),s._v(" "),t("li",[s._v("注意blockHandler 是对应处理 BlockException 的函数，而不是BlockedException")])]),s._v(" "),t("h3",{attrs:{id:"_20-sentinelresource配置详解之fallback和blockhandler配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_20-sentinelresource配置详解之fallback和blockhandler配置"}},[s._v("#")]),s._v(" 20, SentinelResource配置详解之fallback和blockHandler配置")]),s._v(" "),t("p",[s._v("配置如下：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SentinelResource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"findByPaymenId"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fallback "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fallbackHandler"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("blockHandler "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"blockHandler"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GetMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"findByPaymenId"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("findByPaymenId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"支付记录查询成功"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 处理java异常")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("fallbackHandler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Throwable")]),s._v(" throwable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"处理java异常"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 处理sentienl 限流或者熔断")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("blockHandler")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("BlockException")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"处理sentienl"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("p",[t("strong",[s._v("总结:")])]),s._v(" "),t("ul",[t("li",[s._v("fallback是针对方法出现异常了，则会进入fallback方法。")]),s._v(" "),t("li",[s._v("blockhandler是针对流控设置，超出规则，则会进入blockhandler方法。")]),s._v(" "),t("li",[s._v("blockHandler 和 fallback 都进行了配置，则被限流降级而抛出BlockException时只会进入 blockHandler 处理逻辑。")]),s._v(" "),t("li",[s._v("若未配置 blockHandler、fallback 和 defaultFallback，则被限流降级时会将 BlockException 直接抛出。")])])])}),[],!1,null,null,null);t.default=e.exports},8931:function(s,t,a){s.exports=a.p+"assets/img/1717038176870.d8e1b347.png"},8932:function(s,t,a){s.exports=a.p+"assets/img/1717038345718.bc01fb90.png"},8933:function(s,t,a){s.exports=a.p+"assets/img/1717038022938.3068e92f.png"},8934:function(s,t,a){s.exports=a.p+"assets/img/1717038210022.70305b6d.png"},8935:function(s,t,a){s.exports=a.p+"assets/img/1717038246854.75fe4eb6.png"},8936:function(s,t,a){s.exports=a.p+"assets/img/1717038320081.295d03fe.png"},8937:function(s,t,a){s.exports=a.p+"assets/img/1717038384151.0924af35.png"},8938:function(s,t,a){s.exports=a.p+"assets/img/1717038652667.fae0a780.png"},8939:function(s,t,a){s.exports=a.p+"assets/img/1717038967908.a1d8c731.png"},8940:function(s,t,a){s.exports=a.p+"assets/img/1717039165624.748c294d.png"},8941:function(s,t,a){s.exports=a.p+"assets/img/1717039266189.5d0e5437.png"},8942:function(s,t,a){s.exports=a.p+"assets/img/1717040108390.72b178fe.png"},8943:function(s,t,a){s.exports=a.p+"assets/img/1717040128143.3bf8b560.png"},8944:function(s,t,a){s.exports=a.p+"assets/img/1717040935169.d1d636b1.png"},8945:function(s,t,a){s.exports=a.p+"assets/img/1717040528415.df0a2b6e.png"},8946:function(s,t,a){s.exports=a.p+"assets/img/1717040629285.06a8482e.png"},8947:function(s,t,a){s.exports=a.p+"assets/img/1717040762735.bc0dd1ca.png"},8948:function(s,t,a){s.exports=a.p+"assets/img/1717040950347.984e2329.png"},8949:function(s,t,a){s.exports=a.p+"assets/img/1717041007683.e4c6ca5b.png"},8950:function(s,t,a){s.exports=a.p+"assets/img/1717047269951.edf91bbf.png"},8951:function(s,t,a){s.exports=a.p+"assets/img/1717047724905.77cb9ae4.png"},8952:function(s,t,a){s.exports=a.p+"assets/img/1717046685390.49f6222e.png"},8953:function(s,t,a){s.exports=a.p+"assets/img/1717048028857.973c9ea9.png"},8954:function(s,t,a){s.exports=a.p+"assets/img/1717048212202.e18709dc.png"},8955:function(s,t,a){s.exports=a.p+"assets/img/1717048282382.31758ae9.png"},8956:function(s,t,a){s.exports=a.p+"assets/img/1717049085818.cf32a7fa.png"},8957:function(s,t,a){s.exports=a.p+"assets/img/1717049111242.e67f96af.png"},8958:function(s,t,a){s.exports=a.p+"assets/img/1717049173154.a0603145.png"},8959:function(s,t,a){s.exports=a.p+"assets/img/1717049510151.b64605be.png"},8960:function(s,t,a){s.exports=a.p+"assets/img/1717049659295.a23355c1.png"},8961:function(s,t,a){s.exports=a.p+"assets/img/1717049764257.fb698d35.png"},8962:function(s,t,a){s.exports=a.p+"assets/img/1717049788021.e4b7c259.png"},8963:function(s,t,a){s.exports=a.p+"assets/img/1717049867592.c82e705f.png"},8964:function(s,t,a){s.exports=a.p+"assets/img/1717050021807.99004bce.png"},8965:function(s,t,a){s.exports=a.p+"assets/img/1717051831920.27648bd8.png"},8966:function(s,t,a){s.exports=a.p+"assets/img/1717051904005.0b983721.png"},8967:function(s,t,a){s.exports=a.p+"assets/img/1717052010683.1e941bb8.png"},8968:function(s,t,a){s.exports=a.p+"assets/img/1717052226543.f5977137.png"},8969:function(s,t,a){s.exports=a.p+"assets/img/1717052341697.9ada1740.png"},8970:function(s,t,a){s.exports=a.p+"assets/img/1717052471371.1a61c043.png"},8971:function(s,t,a){s.exports=a.p+"assets/img/1717052551565.a91fa1c4.png"},8972:function(s,t,a){s.exports=a.p+"assets/img/1717052700562.13106b86.png"},8973:function(s,t,a){s.exports=a.p+"assets/img/1717052925934.e15e1323.png"},8974:function(s,t,a){s.exports=a.p+"assets/img/1717053027702.181fe289.png"},8975:function(s,t,a){s.exports=a.p+"assets/img/1717053084370.f64c663d.png"},8976:function(s,t,a){s.exports=a.p+"assets/img/1717062000546.996d307d.png"},8977:function(s,t,a){s.exports=a.p+"assets/img/1717062271101.4564bc9c.png"},8978:function(s,t,a){s.exports=a.p+"assets/img/1717062334818.a6f91e1f.png"},8979:function(s,t,a){s.exports=a.p+"assets/img/1717062427848.c806cb40.png"},8980:function(s,t,a){s.exports=a.p+"assets/img/1717062712035.229a8d0a.png"},8981:function(s,t,a){s.exports=a.p+"assets/img/1717062596036.5d341240.png"},8982:function(s,t,a){s.exports=a.p+"assets/img/1717062842425.77d1ce89.png"},8983:function(s,t,a){s.exports=a.p+"assets/img/1717062901312.36b313cd.png"},8984:function(s,t,a){s.exports=a.p+"assets/img/1717062957599.a46266ab.png"},8985:function(s,t,a){s.exports=a.p+"assets/img/1717063426243.d4626c41.png"},8986:function(s,t,a){s.exports=a.p+"assets/img/1717063688044.f877ff6f.png"},8987:function(s,t,a){s.exports=a.p+"assets/img/1717063679706.a28f801c.png"},8988:function(s,t,a){s.exports=a.p+"assets/img/1717063826155.1ec2fcd4.png"},8989:function(s,t,a){s.exports=a.p+"assets/img/1717063901679.830f3004.png"},8990:function(s,t,a){s.exports=a.p+"assets/img/1717063999199.c02334e6.png"},8991:function(s,t,a){s.exports=a.p+"assets/img/1717064032226.61c96f7d.png"},8992:function(s,t,a){s.exports=a.p+"assets/img/1717064174868.7c503c6d.png"},8993:function(s,t,a){s.exports=a.p+"assets/img/1717064260574.c928d0df.png"},8994:function(s,t,a){s.exports=a.p+"assets/img/1717064427361.4b7582a9.png"},8995:function(s,t,a){s.exports=a.p+"assets/img/1717064436847.ba973a31.png"},8996:function(s,t,a){s.exports=a.p+"assets/img/1717064683724.258f3293.png"},8997:function(s,t,a){s.exports=a.p+"assets/img/1717064751365.aac4d378.png"},8998:function(s,t,a){s.exports=a.p+"assets/img/1717064722556.6764e133.png"},8999:function(s,t,a){s.exports=a.p+"assets/img/1717064926252.704b50c1.png"},9e3:function(s,t,a){s.exports=a.p+"assets/img/1717065070849.531edd82.png"},9001:function(s,t,a){s.exports=a.p+"assets/img/1717065227797.593b7169.png"},9002:function(s,t,a){s.exports=a.p+"assets/img/1717065285633.ef401673.png"},9003:function(s,t,a){s.exports=a.p+"assets/img/1717065488309.1878f842.png"},9004:function(s,t,a){s.exports=a.p+"assets/img/1717065496048.144269dc.png"},9005:function(s,t,a){s.exports=a.p+"assets/img/1717065631511.8287b495.png"},9006:function(s,t,a){s.exports=a.p+"assets/img/1717065660711.61e62f9b.png"},9007:function(s,t,a){s.exports=a.p+"assets/img/1717065788305.34037353.png"},9008:function(s,t,a){s.exports=a.p+"assets/img/1717065922921.c8ff6489.png"},9009:function(s,t){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABDAAAAD2CAYAAAAganesAAAgAElEQVR4nO3df3BU5d338c9CYoKNDBkEA+qUMEgCo0PQMi3Og410KgkOt4poAugtN6FEB58KBE2cUqe9C/ckSiS22IKTWKpg4Kbyo5bsttY0bWY0ikDUCoHaJGMtYcJDExRMhJB9/tg9m/29+bWbS/J+zezI7jnnOt9d+ed8uK7vZevo6HAKw5rT6Qz4b6g/e/8XAAAAAIBYiRvqAjC0woUW3q+RI0cqISFBI0eO1IgRI2Sz2WSz2YaydAAAAADAMEKAMYyFCyycTqdsNpsSEhJ01VVXacSIEUNcLQAAAABgOCPAGKbCzbjo7u5WQkKCEhISCC4AAAAAAEYgwBiGvHtYeIcWTqdTcXFxSkpKIrgAAAAAABiFAGOYCTbrwju8+MY3vjHEFQIAAAAAEIgAYxgJF14kJCQoMTFxiCsEAAAAACA41gkMM8GadcbFxRFeAAAAAACMRoAxTHj3vbDeO51OjRgxgmUjAAAAAADjsYQkyj799FM1Nzdr9OjRmjJlipKSkgLO6ezs1Oeff67x48dHtZZgu42MHj06qvcEAAAAAGAwGDEDo6GhQatWrRrqMgbNP/7xD61atUo33nij0tLSNG/ePM2ePVvjxo3TrFmz9PTTT+uf//yn5/xf/epXys/Pj1o9wXYdsfpexHq3kcbGRj399NNav369mpqaYnrvK113d7e6u7uHugwAAAAAiIohDzAOHz6s733ve/rXv/411KUM2OXLl7V27Vrdcsst+vjjj7Vx40bV1dWpublZ586d04cffqh169bpnXfeUXp6uh577DF1dnbqwoULunDhQlRrs0IL6882m02jRo2K6j39Xbp0Sdu2bdO///1vnTlzRlu3btXly5djWgMAAAAA4OtpSJeQ/OUvf9H999+v73//+3rllVeGspQBO3funBYtWqS2tja99957uvnmmwPOuemmm3TTTTcpJydHDodDjz/+uHJycjRjxoyo1RWq90WswwtJqq6uVnt7u+d9e3u73nrrLd11110xr6U/9u3bJ0m67777BjROSUmJGhsb9dBDD2nOnDmDURoA09VXqLDyjDILipQd3dWCAAAAV6whCzCqqqqUm5urhx9+WFu2bJHNZhuqUgasu7tbS5cu1XXXXacDBw7o6quvjnhNVlaW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AQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjEeAAQAAAAAAjPf/AS8o4ephKgkWAAAAAElFTkSuQmCC"},9010:function(s,t,a){s.exports=a.p+"assets/img/1717066007476.6d0507b9.png"},9011:function(s,t,a){s.exports=a.p+"assets/img/1717066068977.ec564fb2.png"},9012:function(s,t,a){s.exports=a.p+"assets/img/1717066176421.7bbf2447.png"},9013:function(s,t,a){s.exports=a.p+"assets/img/1717066331524.b48f6843.png"},9014:function(s,t,a){s.exports=a.p+"assets/img/1717066343764.13aa4e6b.png"},9015:function(s,t,a){s.exports=a.p+"assets/img/1717066382665.1bc7f521.png"},9016:function(s,t,a){s.exports=a.p+"assets/img/1717066435412.cd68d52c.png"},9017:function(s,t,a){s.exports=a.p+"assets/img/1717066498099.643e028a.png"},9018:function(s,t,a){s.exports=a.p+"assets/img/1717066529490.1d5f1f90.png"},9019:function(s,t,a){s.exports=a.p+"assets/img/1717066680064.8679a2c4.png"},9020:function(s,t,a){s.exports=a.p+"assets/img/1717066748834.806b29fb.png"},9021:function(s,t,a){s.exports=a.p+"assets/img/1717066795978.6a697172.png"},9022:function(s,t,a){s.exports=a.p+"assets/img/1717066862966.e94d3155.png"},9023:function(s,t,a){s.exports=a.p+"assets/img/1717066943648.23d43c8f.png"},9024:function(s,t,a){s.exports=a.p+"assets/img/1717067095720.5375aed8.png"},9025:function(s,t,a){s.exports=a.p+"assets/img/1717067034082.aff1f2ec.png"},9026:function(s,t,a){s.exports=a.p+"assets/img/1717067340487.4fe314e8.png"},9027:function(s,t,a){s.exports=a.p+"assets/img/1717067358364.96842314.png"},9028:function(s,t,a){s.exports=a.p+"assets/img/1717067393121.976cd071.png"},9029:function(s,t,a){s.exports=a.p+"assets/img/1717067406709.2c3fe694.png"},9030:function(s,t,a){s.exports=a.p+"assets/img/1717067468480.9d507005.png"},9031:function(s,t,a){s.exports=a.p+"assets/img/1717067495332.a47c6ad5.png"},9032:function(s,t,a){s.exports=a.p+"assets/img/1717067517640.0ad66830.png"},9033:function(s,t,a){s.exports=a.p+"assets/img/1717067560181.547f1cff.png"},9034:function(s,t,a){s.exports=a.p+"assets/img/1717067613395.d4fa4671.png"},9035:function(s,t,a){s.exports=a.p+"assets/img/1717067737709.96d39c40.png"},9036:function(s,t,a){s.exports=a.p+"assets/img/1717067780089.0b937f93.png"},9037:function(s,t,a){s.exports=a.p+"assets/img/1717068004178.09b67f0b.png"},9038:function(s,t,a){s.exports=a.p+"assets/img/1717068018324.4cd79bee.png"},9039:function(s,t,a){s.exports=a.p+"assets/img/1717068359577.7b272817.png"},9040:function(s,t,a){s.exports=a.p+"assets/img/1717068465441.c02fbae8.png"},9041:function(s,t,a){s.exports=a.p+"assets/img/1717068517587.d6f6eeb5.png"},9042:function(s,t,a){s.exports=a.p+"assets/img/1717068534971.eaee819a.png"},9043:function(s,t,a){s.exports=a.p+"assets/img/1717068585479.b3bbf709.png"},9044:function(s,t,a){s.exports=a.p+"assets/img/1717068760756.b63fcd1c.png"},9045:function(s,t,a){s.exports=a.p+"assets/img/1717069305629.05846160.png"},9046:function(s,t,a){s.exports=a.p+"assets/img/1717069401856.78f7d794.png"},9047:function(s,t,a){s.exports=a.p+"assets/img/1717069445994.af6959bf.png"},9048:function(s,t,a){s.exports=a.p+"assets/img/1717069490114.f14474cf.png"},9049:function(s,t,a){s.exports=a.p+"assets/img/1717070021161.41a83cd4.png"},9050:function(s,t,a){s.exports=a.p+"assets/img/1717069954053.77729312.png"},9051:function(s,t,a){s.exports=a.p+"assets/img/1717070112615.6dff9d25.png"}}]);