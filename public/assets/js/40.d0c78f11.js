(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{3854:function(s,a,n){s.exports=n.p+"assets/img/1701940463670.9bef6117.png"},3855:function(s,a,n){s.exports=n.p+"assets/img/1701941435114.4d828c54.png"},3856:function(s,a,n){s.exports=n.p+"assets/img/1701942193109.c3de8f93.png"},3857:function(s,a,n){s.exports=n.p+"assets/img/1701942365692.9b7bb351.png"},3858:function(s,a,n){s.exports=n.p+"assets/img/1701942302468.6fb06f09.png"},3859:function(s,a,n){s.exports=n.p+"assets/img/1701942354150.81cfeacc.png"},3860:function(s,a,n){s.exports=n.p+"assets/img/1701942414480.683761ee.png"},3861:function(s,a,n){s.exports=n.p+"assets/img/1701942429318.e7e01434.png"},3862:function(s,a,n){s.exports=n.p+"assets/img/1701942454444.eed9421e.png"},3863:function(s,a,n){s.exports=n.p+"assets/img/1701942522420.71a0418d.png"},3864:function(s,a,n){s.exports=n.p+"assets/img/1701942545726.89a96062.png"},3865:function(s,a,n){s.exports=n.p+"assets/img/1701942663097.275ee844.png"},3866:function(s,a,n){s.exports=n.p+"assets/img/1701942929303.5c15c776.png"},3867:function(s,a,n){s.exports=n.p+"assets/img/1701942963312.6abbd107.png"},3868:function(s,a,n){s.exports=n.p+"assets/img/1701943054088.049d1e05.png"},3869:function(s,a,n){s.exports=n.p+"assets/img/1701943255272.d4eb8f43.png"},3870:function(s,a,n){s.exports=n.p+"assets/img/1701943853992.c885af9b.png"},4389:function(s,a,n){"use strict";n.r(a);var e=n(2),t=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"一-约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-约束"}},[s._v("#")]),s._v(" 一，约束")]),s._v(" "),a("h3",{attrs:{id:"_1-什么是约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么是约束"}},[s._v("#")]),s._v(" 1，什么是约束")]),s._v(" "),a("p",[s._v("看如下表：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3854),alt:"1701940463670"}})]),s._v(" "),a("p",[s._v("上面表存在的一些问题：")]),s._v(" "),a("ul",[a("li",[s._v("id 列一般是用标示数据的唯一性的，而上述表中的id为1的有三条数据，并且 "),a("code",[s._v("马花疼")]),s._v(" 没有id进行标示")]),s._v(" "),a("li",[a("code",[s._v("柳白")]),s._v(" 这条数据的age列的数据是3000，而人也不可能活到3000岁")]),s._v(" "),a("li",[a("code",[s._v("马运")]),s._v("  这条数据的math数学成绩是-5，而数学学得再不好也不可能出现负分")]),s._v(" "),a("li",[a("code",[s._v("柳青")]),s._v(" 这条数据的english列（英文成绩）值为null，而成绩即使没考也得是0分")])]),s._v(" "),a("p",[s._v("针对上面的遇到的问题，从数据库层面在添加数据的时候进行限制，这个就是约束。约束是作用于表中列上的规则，用于限制加入表的数据。例如：我们可以给id列加约束，让其值不能重复，不能为null值。")]),s._v(" "),a("p",[s._v("约束的存在保证了数据库中数据的正确性、有效性和完整性。添加约束可以在添加数据的时候就限制不正确的数据，年龄是3000，数学成绩是-5分这样无效的数据，继而保障数据的完整性。")]),s._v(" "),a("h3",{attrs:{id:"_2-分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-分类"}},[s._v("#")]),s._v(" 2，分类")]),s._v(" "),a("p",[s._v("非空约束： 关键字是 NOT NULL")]),s._v(" "),a("ul",[a("li",[s._v("保证列中所有的数据不能有null值。")]),s._v(" "),a("li",[s._v("例如：id列在添加 "),a("code",[s._v("马花疼")]),s._v(" 这条数据时就不能添加成功。")])]),s._v(" "),a("p",[s._v("唯一约束：关键字是  UNIQUE")]),s._v(" "),a("ul",[a("li",[s._v("保证列中所有数据各不相同。")]),s._v(" "),a("li",[s._v("例如：id列中三条数据的值都是1，这样的数据在添加时是绝对不允许的。")])]),s._v(" "),a("p",[s._v("主键约束： 关键字是  PRIMARY KEY")]),s._v(" "),a("ul",[a("li",[s._v("主键是一行数据的唯一标识，要求非空且唯一。一般我们都会给没张表添加一个主键列用来唯一标识数据。")]),s._v(" "),a("li",[s._v("例如：上图表中id就可以作为主键，来标识每条数据。那么这样就要求数据中id的值不能重复，不能为null值。")])]),s._v(" "),a("p",[s._v("检查约束： 关键字是  CHECK")]),s._v(" "),a("ul",[a("li",[s._v("保证列中的值满足某一条件。")]),s._v(" "),a("li",[s._v("例如：我们可以给age列添加一个范围，最低年龄可以设置为1，最大年龄就可以设置为300，这样的数据才更合理些。")]),s._v(" "),a("li",[s._v("MySQL不支持检查约束。从数据库层面不能保证，以后可以在java代码中进行限制，一样也可以实现要求。")])]),s._v(" "),a("p",[s._v("默认约束： 关键字是   DEFAULT")]),s._v(" "),a("ul",[a("li",[s._v("保存数据时，未指定值则采用默认值。")]),s._v(" "),a("li",[s._v("例如：我们在给english列添加该约束，指定默认值是0，这样在添加数据时没有指定具体值时就会采用默认给定的0。")])]),s._v(" "),a("p",[s._v("外键约束： 关键字是  FOREIGN KEY")]),s._v(" "),a("ul",[a("li",[s._v("外键用来让两个表的数据之间建立链接，保证数据的一致性和完整性。")]),s._v(" "),a("li",[s._v("外键约束现在可能还不太好理解，后面我们会重点进行讲解。")])]),s._v(" "),a("h3",{attrs:{id:"_3-非空约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-非空约束"}},[s._v("#")]),s._v(" 3，非空约束")]),s._v(" "),a("p",[s._v("非空约束用于保证列中所有数据不能有NULL值。添加约束：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 创建表时添加非空约束\nCREATE TABLE 表名(\n   列名 数据类型 NOT NULL,\n   …\n); \n\n-- 建完表后添加非空约束\nALTER TABLE 表名 MODIFY 字段名 数据类型 NOT NULL;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("删除约束：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ALTER TABLE 表名 MODIFY 字段名 数据类型;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_4-唯一约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-唯一约束"}},[s._v("#")]),s._v(" 4，唯一约束")]),s._v(" "),a("p",[s._v("唯一约束用于保证列中所有数据各不相同。添加约束语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 创建表时添加唯一约束\nCREATE TABLE 表名(\n   列名 数据类型 UNIQUE [AUTO_INCREMENT],\n   -- AUTO_INCREMENT: 当不指定值时自动增长\n   …\n); \nCREATE TABLE 表名(\n   列名 数据类型,\n   …\n   [CONSTRAINT] [约束名称] UNIQUE(列名)\n); \n\n-- 建完表后添加唯一约束\nALTER TABLE 表名 MODIFY 字段名 数据类型 UNIQUE;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("删除约束：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ALTER TABLE 表名 DROP INDEX 字段名;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_5-主键约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-主键约束"}},[s._v("#")]),s._v(" 5，主键约束")]),s._v(" "),a("p",[s._v("键是一行数据的唯一标识，要求非空且唯一。一张表只能有一个主键。添加约束语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 创建表时添加主键约束\nCREATE TABLE 表名(\n   列名 数据类型 PRIMARY KEY [AUTO_INCREMENT],\n   …\n); \nCREATE TABLE 表名(\n   列名 数据类型,\n   [CONSTRAINT] [约束名称] PRIMARY KEY(列名)\n); \n\n-- 建完表后添加主键约束\nALTER TABLE 表名 ADD PRIMARY KEY(字段名);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("删除约束：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ALTER TABLE 表名 DROP PRIMARY KEY;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_6-默认约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-默认约束"}},[s._v("#")]),s._v(" 6，默认约束")]),s._v(" "),a("p",[s._v("保存数据时，未指定值则采用默认值，添加约束语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 创建表时添加默认约束\nCREATE TABLE 表名(\n   列名 数据类型 DEFAULT 默认值,\n   …\n); \n\n-- 建完表后添加默认约束\nALTER TABLE 表名 ALTER 列名 SET DEFAULT 默认值;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("删除约束：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ALTER TABLE 表名 ALTER 列名 DROP DEFAULT;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_7-约束练习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-约束练习"}},[s._v("#")]),s._v(" 7，约束练习")]),s._v(" "),a("p",[s._v("需求：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 员工表\nCREATE TABLE emp (\n\tid INT,  -- 员工id，主键且自增长\n    ename VARCHAR(50), -- 员工姓名，非空且唯一\n    joindate DATE,  -- 入职日期，非空\n    salary DOUBLE(7,2),  -- 工资，非空\n    bonus DOUBLE(7,2)  -- 奖金，如果没有将近默认为0\n);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("上面一定给出了具体的要求，我们可以根据要求创建这张表，并为每一列添加对应的约束。建表语句如下：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DROP TABLE IF EXISTS emp;\n\n-- 员工表\nCREATE TABLE emp (\n  id INT PRIMARY KEY, -- 员工id，主键且自增长\n  ename VARCHAR(50) NOT NULL UNIQUE, -- 员工姓名，非空并且唯一\n  joindate DATE NOT NULL , -- 入职日期，非空\n  salary DOUBLE(7,2) NOT NULL , -- 工资，非空\n  bonus DOUBLE(7,2) DEFAULT 0 -- 奖金，如果没有奖金默认为0\n);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("通过上面语句可以创建带有约束的 "),a("code",[s._v("emp")]),s._v(" 表，约束能不能发挥作用呢。接下来我们一一进行验证，先添加一条没有问题的数据：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("INSERT INTO emp(id,ename,joindate,salary,bonus) values(1,'张三','1999-11-11',8800,5000);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"a-验证主键约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#a-验证主键约束"}},[s._v("#")]),s._v(" a）验证主键约束")]),s._v(" "),a("p",[s._v("验证主键约束，非空且唯一：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("INSERT INTO emp(id,ename,joindate,salary,bonus) values(null,'张三','1999-11-11',8800,5000);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行结果如下：")]),s._v(" "),a("p",[s._v("从上面的结果可以看到，字段 "),a("code",[s._v("id")]),s._v(" 不能为null。那我们重新添加一条数据，如下：：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("INSERT INTO emp(id,ename,joindate,salary,bonus) values(1,'张三','1999-11-11',8800,5000);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("从上面结果可以看到，1这个值重复了。所以主键约束是用来限制数据非空且唯一的。那我们再添加一条符合要求的数据")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("INSERT INTO emp(id,ename,joindate,salary,bonus) values(2,'李四','1999-11-11',8800,5000);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行结果如下：")]),s._v(" "),a("h4",{attrs:{id:"b-验证非空约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#b-验证非空约束"}},[s._v("#")]),s._v(" b）验证非空约束")]),s._v(" "),a("p",[s._v("验证非空约束：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("INSERT INTO emp(id,ename,joindate,salary,bonus) values(3,null,'1999-11-11',8800,5000);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行结果：")]),s._v(" "),a("p",[s._v("从上面结果可以看到， "),a("code",[s._v("ename")]),s._v(" 字段的非空约束生效了。")]),s._v(" "),a("h4",{attrs:{id:"c-验证唯一约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#c-验证唯一约束"}},[s._v("#")]),s._v(" c）验证唯一约束")]),s._v(" "),a("p",[s._v("验证唯一约束：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("INSERT INTO emp(id,ename,joindate,salary,bonus) values(3,'李四','1999-11-11',8800,5000);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行结果如下：")]),s._v(" "),a("p",[s._v("从上面结果可以看到， "),a("code",[s._v("ename")]),s._v(" 字段的唯一约束生效了。")]),s._v(" "),a("h4",{attrs:{id:"d-验证默认约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#d-验证默认约束"}},[s._v("#")]),s._v(" d）验证默认约束")]),s._v(" "),a("p",[s._v("验证默认约束：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("INSERT INTO emp(id,ename,joindate,salary) values(3,'王五','1999-11-11',8800);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行完上面语句后查询表中数据，如下图可以看到王五这条数据的bonus列就有了默认值0。如下：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("默认约束只有在不给值时才会采用默认值。如果给了null，那值就是null值。")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("INSERT INTO emp(id,ename,joindate,salary,bonus) values(4,'赵六','1999-11-11',8800,null);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行结果如下：")]),s._v(" "),a("h4",{attrs:{id:"e-验证自动增长约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#e-验证自动增长约束"}},[s._v("#")]),s._v(" e）验证自动增长约束")]),s._v(" "),a("p",[s._v("条件： auto_increment  当列是数字类型 并且唯一约束")]),s._v(" "),a("p",[s._v("重新创建 "),a("code",[s._v("emp")]),s._v(" 表，并给id列添加自动增长：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 员工表\nCREATE TABLE emp (\n  id INT PRIMARY KEY auto_increment, -- 员工id，主键且自增长\n  ename VARCHAR(50) NOT NULL UNIQUE, -- 员工姓名，非空并且唯一\n  joindate DATE NOT NULL , -- 入职日期，非空\n  salary DOUBLE(7,2) NOT NULL , -- 工资，非空\n  bonus DOUBLE(7,2) DEFAULT 0 -- 奖金，如果没有奖金默认为0\n);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("接下来给emp添加数据，分别验证不给id列添加值以及给id列添加null值，id列的值会不会自动增长：：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("INSERT INTO emp(ename,joindate,salary,bonus) values('赵六','1999-11-11',8800,null);\nINSERT INTO emp(id,ename,joindate,salary,bonus) values(null,'赵六2','1999-11-11',8800,null);\nINSERT INTO emp(id,ename,joindate,salary,bonus) values(null,'赵六3','1999-11-11',8800,null);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"_8-外键约束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-外键约束"}},[s._v("#")]),s._v(" 8，外键约束")]),s._v(" "),a("p",[s._v("外键用来让两个表的数据之间建立链接，保证数据的一致性和完整性。如何理解上面的概念呢？如下图有两张表，员工表和部门表：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3855),alt:"1701941435114"}})]),s._v(" "),a("p",[s._v("员工表中的dep_id字段是部门表的id字段关联，也就是说1号学生张三属于1号部门研发部的员工。现在我要删除1号部门，就会出现错误的数据（员工表中属于1号部门的数据）。而我们上面说的两张表的关系只是我们认为它们有关系，此时需要通过外键让这两张表产生数据库层面的关系，这样你要删除部门表中的1号部门的数据将无法删除。")]),s._v(" "),a("p",[s._v("添加外键约束语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 创建表时添加外键约束\nCREATE TABLE 表名(\n   列名 数据类型,\n   …\n   [CONSTRAINT] [外键名称] FOREIGN KEY(外键列名) REFERENCES 主表(主表列名) \n); \n\n-- 建完表后添加外键约束\nALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段名称) REFERENCES 主表名称(主表列名称);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("删除外键约束：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("ALTER TABLE 表名 DROP FOREIGN KEY 外键名称;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("据上述语法创建员工表和部门表，并添加上外键约束：：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 删除表\nDROP TABLE IF EXISTS emp;\nDROP TABLE IF EXISTS dept;\n\n-- 部门表\nCREATE TABLE dept(\n\tid int primary key auto_increment,\n\tdep_name varchar(20),\n\taddr varchar(20)\n);\n-- 员工表 \nCREATE TABLE emp(\n\tid int primary key auto_increment,\n\tname varchar(20),\n\tage int,\n\tdep_id int,\n\n\t-- 添加外键 dep_id,关联 dept 表的id主键\n\tCONSTRAINT fk_emp_dept FOREIGN KEY(dep_id) REFERENCES dept(id)\t\n);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("添加数据：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 添加 2 个部门\ninsert into dept(dep_name,addr) values\n('研发部','广州'),('销售部', '深圳');\n\n-- 添加员工,dep_id 表示员工所在的部门\nINSERT INTO emp (NAME, age, dep_id) VALUES \n('张三', 20, 1),\n('李四', 20, 1),\n('王五', 20, 1),\n('赵六', 20, 2),\n('孙七', 22, 2),\n('周八', 18, 2);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("此时删除 "),a("code",[s._v("研发部")]),s._v(" 这条数据，会发现无法删除。")]),s._v(" "),a("p",[s._v("删除外键：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("alter table emp drop FOREIGN key fk_emp_dept;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("重新添加外键：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("alter table emp add CONSTRAINT fk_emp_dept FOREIGN key(dep_id) REFERENCES dept(id);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"二-数据库设计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-数据库设计"}},[s._v("#")]),s._v(" 二，数据库设计")]),s._v(" "),a("h3",{attrs:{id:"_1-什么是数据库设计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么是数据库设计"}},[s._v("#")]),s._v(" 1，什么是数据库设计")]),s._v(" "),a("p",[s._v("所谓的数据库设计，就是设计一个项目中都有哪些表，以及表与表之间的关系。表关系分为：")]),s._v(" "),a("ul",[a("li",[s._v("一对一")]),s._v(" "),a("li",[s._v("一对多")]),s._v(" "),a("li",[s._v("多对多")])]),s._v(" "),a("p",[s._v("一对一：")]),s._v(" "),a("ul",[a("li",[s._v("如用户与身份证就是一对一。如用户和用户详情就是一对一。")]),s._v(" "),a("li",[s._v("一对一关系多用于表拆分，将一个实体中经常使用的字段放一张表，不经常使用的字段放另一张表，用于提升查询性能")])]),s._v(" "),a("p",[s._v("一对多：")]),s._v(" "),a("ul",[a("li",[s._v("如部门和员工就是一对多。一个部门对应多个员工，一个员工对应一个部门。")])]),s._v(" "),a("p",[s._v("多对多：")]),s._v(" "),a("ul",[a("li",[s._v("如商品和订单就是多对多。一个商品对应多个订单，一个订单包含多个商品。")])]),s._v(" "),a("h3",{attrs:{id:"_2-一对多"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-一对多"}},[s._v("#")]),s._v(" 2，一对多")]),s._v(" "),a("p",[s._v("实现方式：")]),s._v(" "),a("ul",[a("li",[s._v("在多的一方建立外键，指向一的一方的主键")])]),s._v(" "),a("p",[s._v("以 "),a("code",[s._v("员工表")]),s._v(" 和 "),a("code",[s._v("部门表")]),s._v(" 举例。员工表属于多的一方，而部门表属于一的一方，此时我们会在员工表中添加一列（dep_id），指向于部门表的主键（id）：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3856),alt:"1701942193109"}})]),s._v(" "),a("p",[s._v("建表语句如下：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 删除表\nDROP TABLE IF EXISTS tb_emp;\nDROP TABLE IF EXISTS tb_dept;\n\n-- 部门表\nCREATE TABLE tb_dept(\n\tid int primary key auto_increment,\n\tdep_name varchar(20),\n\taddr varchar(20)\n);\n-- 员工表 \nCREATE TABLE tb_emp(\n\tid int primary key auto_increment,\n\tname varchar(20),\n\tage int,\n\tdep_id int,\n\n\t-- 添加外键 dep_id,关联 dept 表的id主键\n\tCONSTRAINT fk_emp_dept FOREIGN KEY(dep_id) REFERENCES tb_dept(id)\t\n);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("查看表结构模型图：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3857),alt:"1701942365692"}})]),s._v(" "),a("h3",{attrs:{id:"_3-多对多"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-多对多"}},[s._v("#")]),s._v(" 3，多对多")]),s._v(" "),a("p",[s._v("实现方式：")]),s._v(" "),a("ul",[a("li",[s._v("建立第三张中间表，中间表至少包含两个外键，分别关联两方主键")])]),s._v(" "),a("p",[s._v("以 "),a("code",[s._v("订单表")]),s._v(" 和 "),a("code",[s._v("商品表")]),s._v(" 举例，订单表和商品表都属于多的一方，此时需要创建一个中间表，在中间表中添加订单表的外键和商品表的外键指向两张表的主键：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3858),alt:"1701942302468"}})]),s._v(" "),a("p",[s._v("建表语句：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 删除表\nDROP TABLE IF EXISTS tb_order_goods;\nDROP TABLE IF EXISTS tb_order;\nDROP TABLE IF EXISTS tb_goods;\n\n-- 订单表\nCREATE TABLE tb_order(\n\tid int primary key auto_increment,\n\tpayment double(10,2),\n\tpayment_type TINYINT,\n\tstatus TINYINT\n);\n\n-- 商品表\nCREATE TABLE tb_goods(\n\tid int primary key auto_increment,\n\ttitle varchar(100),\n\tprice double(10,2)\n);\n\n-- 订单商品中间表\nCREATE TABLE tb_order_goods(\n\tid int primary key auto_increment,\n\torder_id int,\n\tgoods_id int,\n\tcount int\n);\n\n-- 建完表后，添加外键\nalter table tb_order_goods add CONSTRAINT fk_order_id FOREIGN key(order_id) REFERENCES tb_order(id);\nalter table tb_order_goods add CONSTRAINT fk_goods_id FOREIGN key(goods_id) REFERENCES tb_goods(id);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("p",[s._v("查看表结构模型图：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3859),alt:"1701942354150"}})]),s._v(" "),a("h3",{attrs:{id:"_4-一对一"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-一对一"}},[s._v("#")]),s._v(" 4，一对一")]),s._v(" "),a("p",[s._v("一对一关系多用于表拆分，将一个实体中经常使用的字段放一张表，不经常使用的字段放另一张表，用于提升查询性能。实现方式：")]),s._v(" "),a("ul",[a("li",[s._v("在任意一方加入外键，关联另一方主键，并且设置外键为唯一(UNIQUE)")])]),s._v(" "),a("p",[s._v("以 "),a("code",[s._v("用户表")]),s._v(" 举例：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3860),alt:"1701942414480"}})]),s._v(" "),a("p",[s._v("真正使用过程中发现 id、photo、nickname、age、gender 字段比较常用，此时就可以将这张表查分成两张表。")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3861),alt:"1701942429318"}})]),s._v(" "),a("p",[s._v("建表语句：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("create table tb_user_desc (\n\tid int primary key auto_increment,\n\tcity varchar(20),\n\tedu varchar(10),\n\tincome int,\n\tstatus char(2),\n\tdes varchar(100)\n);\n\ncreate table tb_user (\n\tid int primary key auto_increment,\n\tphoto varchar(100),\n\tnickname varchar(50),\n\tage int,\n\tgender char(1),\n\tdesc_id int unique,\n\t-- 添加外键\n\tCONSTRAINT fk_user_desc FOREIGN KEY(desc_id) REFERENCES tb_user_desc(id)\t\n);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("p",[s._v("查看表结构模型图：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3862),alt:"1701942454444"}})]),s._v(" "),a("h3",{attrs:{id:"_5-案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-案例"}},[s._v("#")]),s._v(" 5，案例")]),s._v(" "),a("p",[s._v("根据下图设计表及表和表之间的关系：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3863),alt:"1701942522420"}})]),s._v(" "),a("p",[s._v("经过分析，我们分为 "),a("code",[s._v("专辑表")]),s._v(" "),a("code",[s._v("曲目表")]),s._v(" "),a("code",[s._v("短评表")]),s._v(" "),a("code",[s._v("用户表")]),s._v(" 4张表。")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3864),alt:"1701942545726"}})]),s._v(" "),a("p",[s._v("一个专辑可以有多个曲目，一个曲目只能属于某一张专辑，所以专辑表和曲目表的关系是：")]),s._v(" "),a("ul",[a("li",[s._v("一对多")])]),s._v(" "),a("p",[s._v("一个专辑可以被多个用户进行评论，一个用户可以对多个专辑进行评论，所以专辑表和用户表的关系是")]),s._v(" "),a("ul",[a("li",[s._v("多对多")])]),s._v(" "),a("p",[s._v("一个用户可以发多个短评，一个短评只能是某一个人发的，所以用户表和短评表的关系是")]),s._v(" "),a("ul",[a("li",[s._v("一对多")])]),s._v(" "),a("p",[a("img",{attrs:{src:n(3865),alt:"1701942663097"}})]),s._v(" "),a("h2",{attrs:{id:"三-多表查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-多表查询"}},[s._v("#")]),s._v(" 三，多表查询")]),s._v(" "),a("p",[s._v("多表查询顾名思义就是从多张表中一次性的查询出我们想要的数据。准备环境：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DROP TABLE IF EXISTS emp;\nDROP TABLE IF EXISTS dept;\n\n# 创建部门表\nCREATE TABLE dept(\n    did INT PRIMARY KEY AUTO_INCREMENT,\n    dname VARCHAR(20)\n);\n\n# 创建员工表\nCREATE TABLE emp (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    NAME VARCHAR(10),\n    gender CHAR(1), -- 性别\n    salary DOUBLE, -- 工资\n    join_date DATE, -- 入职日期\n    dep_id INT,\n    FOREIGN KEY (dep_id) REFERENCES dept(did) -- 外键，关联部门表(部门表的主键)\n);\n-- 添加部门数据\nINSERT INTO dept (dNAME) VALUES ('研发部'),('市场部'),('财务部'),('销售部');\n-- 添加员工数据\nINSERT INTO emp(NAME,gender,salary,join_date,dep_id) VALUES\n('孙悟空','男',7200,'2013-02-24',1),\n('猪八戒','男',3600,'2010-12-02',2),\n('唐僧','男',9000,'2008-08-08',2),\n('白骨精','女',5000,'2015-10-07',3),\n('蜘蛛精','女',4500,'2011-03-14',1),\n('小白龙','男',2500,'2011-02-14',null);\t\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("p",[s._v("执行下面的多表查询语句：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select * from emp , dept;  -- 从emp和dept表中查询所有的字段数据\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("结果如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3866),alt:"1701942929303"}})]),s._v(" "),a("p",[s._v("从上面的结果我们看到有一些无效的数据，如 "),a("code",[s._v("孙悟空")]),s._v(" 这个员工属于1号部门，但也同时关联的2、3、4号部门。所以我们要通过限制员工表中的 "),a("code",[s._v("dep_id")]),s._v(" 字段的值和部门表 "),a("code",[s._v("did")]),s._v(" 字段的值相等来消除这些无效的数据，")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select * from emp , dept where emp.dep_id = dept.did;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行后结果如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3867),alt:"1701942963312"}})]),s._v(" "),a("p",[s._v("上面语句就是连接查询，那么多表查询都有哪些呢？")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("连接查询")]),s._v(" "),a("ul",[a("li",[s._v("内连接查询：相当于查询AB交集数据")]),s._v(" "),a("li",[s._v("外连接查询\n"),a("ul",[a("li",[s._v("左外连接查询：相当于查询A表所有数据和交集部门数据")]),s._v(" "),a("li",[s._v("右外连接查询：相当于查询B表所有数据和交集部分数据")])])])])]),s._v(" "),a("li",[a("p",[s._v("子查询")])])]),s._v(" "),a("p",[s._v("图示：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3868),alt:"1701943054088"}})]),s._v(" "),a("h3",{attrs:{id:"_1-内连接查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-内连接查询"}},[s._v("#")]),s._v(" 1，内连接查询")]),s._v(" "),a("p",[s._v("内连接相当于查询 A B 交集数据。语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 隐式内连接\nSELECT 字段列表 FROM 表1,表2… WHERE 条件;\n\n-- 显示内连接\nSELECT 字段列表 FROM 表1 [INNER] JOIN 表2 ON 条件;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("隐式内连接：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("SELECT\n\t*\nFROM\n\temp,\n\tdept\nWHERE\n\temp.dep_id = dept.did;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("执行结果如下：")]),s._v(" "),a("p",[s._v("查询 emp的 name， gender，dept表的dname：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("SELECT\n\temp. NAME,\n\temp.gender,\n\tdept.dname\nFROM\n\temp,\n\tdept\nWHERE\n\temp.dep_id = dept.did;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("执行语句如下：")]),s._v(" "),a("p",[s._v("上面语句中使用表名指定字段所属有点麻烦，sql也支持给表指别名，上述语句可以改进为：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("SELECT\n\tt1. NAME,\n\tt1.gender,\n\tt2.dname\nFROM\n\temp t1,\n\tdept t2\nWHERE\n\tt1.dep_id = t2.did;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("显式内连接：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select * from emp inner join dept on emp.dep_id = dept.did;\n-- 上面语句中的inner可以省略，可以书写为如下语句\nselect * from emp  join dept on emp.dep_id = dept.did;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("执行结果如下：")]),s._v(" "),a("h3",{attrs:{id:"_2-外连接查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-外连接查询"}},[s._v("#")]),s._v(" 2，外连接查询")]),s._v(" "),a("p",[s._v("语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 左外连接（相当于查询A表所有数据和交集部分数据）\nSELECT 字段列表 FROM 表1 LEFT [OUTER] JOIN 表2 ON 条件;\n\n-- 右外连接（相当于查询B表所有数据和交集部分数据）\nSELECT 字段列表 FROM 表1 RIGHT [OUTER] JOIN 表2 ON 条件;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("图示：")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3869),alt:"1701943255272"}})]),s._v(" "),a("p",[s._v("查询emp表所有数据和对应的部门信息（左外连接）：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select * from emp left join dept on emp.dep_id = dept.did;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行结果：")]),s._v(" "),a("p",[s._v("结果显示查询到了左表（emp）中所有的数据及两张表能关联的数据。")]),s._v(" "),a("p",[s._v("查询dept表所有数据和对应的员工信息（右外连接）：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select * from emp right join dept on emp.dep_id = dept.did;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行结果：")]),s._v(" "),a("p",[s._v("结果显示查询到了右表（dept）中所有的数据及两张表能关联的数据。")]),s._v(" "),a("p",[s._v("要查询出部门表中所有的数据，也可以通过左外连接实现，只需要将两个表的位置进行互换：：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select * from dept left join emp on emp.dep_id = dept.did;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_3-子查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-子查询"}},[s._v("#")]),s._v(" 3，子查询")]),s._v(" "),a("p",[s._v("查询中嵌套查询，称嵌套查询为子查询。举个例子：查询工资高于猪八戒的员工信息。实现这个需求，我们就可以通过二步实现，第一步：先查询出来 猪八戒的工资")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select salary from emp where name = '猪八戒'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("第二步：查询工资高于猪八戒的员工信息：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select * from emp where salary > 3600;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("第二步中的3600可以通过第一步的sql查询出来，所以将3600用第一步的sql语句进行替换：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select * from emp where salary > (select salary from emp where name = '猪八戒');\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这就是查询语句中嵌套查询语句。子查询根据查询结果不同，作用不同")]),s._v(" "),a("ul",[a("li",[s._v("子查询语句结果是单行单列，子查询语句作为条件值，使用 =  !=  >  <  等进行条件判断")]),s._v(" "),a("li",[s._v("子查询语句结果是多行单列，子查询语句作为条件值，使用 in 等关键字进行条件判断")]),s._v(" "),a("li",[s._v("子查询语句结果是多行多列，子查询语句作为虚拟表")])]),s._v(" "),a("p",[s._v("查询 '财务部' 和 '市场部' 所有的员工信息：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 查询 '财务部' 或者 '市场部' 所有的员工的部门did\nselect did from dept where dname = '财务部' or dname = '市场部';\n\nselect * from emp where dep_id in (select did from dept where dname = '财务部' or dname = '市场部');\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("查询入职日期是 '2011-11-11' 之后的员工信息和部门信息：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 查询入职日期是 '2011-11-11' 之后的员工信息\nselect * from emp where join_date > '2011-11-11' ;\n-- 将上面语句的结果作为虚拟表和dept表进行内连接查询\nselect * from (select * from emp where join_date > '2011-11-11' ) t1, dept where t1.dep_id = dept.did;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"_4-案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-案例"}},[s._v("#")]),s._v(" 4，案例")]),s._v(" "),a("p",[s._v("环境准备：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DROP TABLE IF EXISTS emp;\nDROP TABLE IF EXISTS dept;\nDROP TABLE IF EXISTS job;\nDROP TABLE IF EXISTS salarygrade;\n\n-- 部门表\nCREATE TABLE dept (\n  did INT PRIMARY KEY PRIMARY KEY, -- 部门id\n  dname VARCHAR(50), -- 部门名称\n  loc VARCHAR(50) -- 部门所在地\n);\n\n-- 职务表，职务名称，职务描述\nCREATE TABLE job (\n  id INT PRIMARY KEY,\n  jname VARCHAR(20),\n  description VARCHAR(50)\n);\n\n-- 员工表\nCREATE TABLE emp (\n  id INT PRIMARY KEY, -- 员工id\n  ename VARCHAR(50), -- 员工姓名\n  job_id INT, -- 职务id\n  mgr INT , -- 上级领导\n  joindate DATE, -- 入职日期\n  salary DECIMAL(7,2), -- 工资\n  bonus DECIMAL(7,2), -- 奖金\n  dept_id INT, -- 所在部门编号\n  CONSTRAINT emp_jobid_ref_job_id_fk FOREIGN KEY (job_id) REFERENCES job (id),\n  CONSTRAINT emp_deptid_ref_dept_id_fk FOREIGN KEY (dept_id) REFERENCES dept (id)\n);\n-- 工资等级表\nCREATE TABLE salarygrade (\n  grade INT PRIMARY KEY,   -- 级别\n  losalary INT,  -- 最低工资\n  hisalary INT -- 最高工资\n);\n\t\t\t\t\n-- 添加4个部门\nINSERT INTO dept(did,dname,loc) VALUES \n(10,'教研部','北京'),\n(20,'学工部','上海'),\n(30,'销售部','广州'),\n(40,'财务部','深圳');\n\n-- 添加4个职务\nINSERT INTO job (id, jname, description) VALUES\n(1, '董事长', '管理整个公司，接单'),\n(2, '经理', '管理部门员工'),\n(3, '销售员', '向客人推销产品'),\n(4, '文员', '使用办公软件');\n\n-- 添加员工\nINSERT INTO emp(id,ename,job_id,mgr,joindate,salary,bonus,dept_id) VALUES \n(1001,'孙悟空',4,1004,'2000-12-17','8000.00',NULL,20),\n(1002,'卢俊义',3,1006,'2001-02-20','16000.00','3000.00',30),\n(1003,'林冲',3,1006,'2001-02-22','12500.00','5000.00',30),\n(1004,'唐僧',2,1009,'2001-04-02','29750.00',NULL,20),\n(1005,'李逵',4,1006,'2001-09-28','12500.00','14000.00',30),\n(1006,'宋江',2,1009,'2001-05-01','28500.00',NULL,30),\n(1007,'刘备',2,1009,'2001-09-01','24500.00',NULL,10),\n(1008,'猪八戒',4,1004,'2007-04-19','30000.00',NULL,20),\n(1009,'罗贯中',1,NULL,'2001-11-17','50000.00',NULL,10),\n(1010,'吴用',3,1006,'2001-09-08','15000.00','0.00',30),\n(1011,'沙僧',4,1004,'2007-05-23','11000.00',NULL,20),\n(1012,'李逵',4,1006,'2001-12-03','9500.00',NULL,30),\n(1013,'小白龙',4,1004,'2001-12-03','30000.00',NULL,20),\n(1014,'关羽',4,1007,'2002-01-23','13000.00',NULL,10);\n\n-- 添加5个工资等级\nINSERT INTO salarygrade(grade,losalary,hisalary) VALUES \n(1,7000,12000),\n(2,12010,14000),\n(3,14010,20000),\n(4,20010,30000),\n(5,30010,99990);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br")])]),a("p",[s._v("查询所有员工信息。查询员工编号，员工姓名，工资，职务名称，职务描述：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/*\n\t分析：\n\t\t1. 员工编号，员工姓名，工资 信息在emp 员工表中\n\t\t2. 职务名称，职务描述 信息在 job 职务表中\n\t\t3. job 职务表 和 emp 员工表 是 一对多的关系 emp.job_id = job.id\n*/\n-- 方式一 ：隐式内连接\nSELECT\n\temp.id,\n\temp.ename,\n\temp.salary,\n\tjob.jname,\n\tjob.description\nFROM\n\temp,\n\tjob\nWHERE\n\temp.job_id = job.id;\n\n-- 方式二 ：显式内连接\nSELECT\n\temp.id,\n\temp.ename,\n\temp.salary,\n\tjob.jname,\n\tjob.description\nFROM\n\temp\nINNER JOIN job ON emp.job_id = job.id;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("p",[s._v("查询员工编号，员工姓名，工资，职务名称，职务描述，部门名称，部门位置：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/*\n\t分析：\n\t\t1. 员工编号，员工姓名，工资 信息在emp 员工表中\n\t\t2. 职务名称，职务描述 信息在 job 职务表中\n\t\t3. job 职务表 和 emp 员工表 是 一对多的关系 emp.job_id = job.id\n\n\t\t4. 部门名称，部门位置 来自于 部门表 dept\n\t\t5. dept 和 emp 一对多关系 dept.id = emp.dept_id\n*/\n\n-- 方式一 ：隐式内连接\nSELECT\n\temp.id,\n\temp.ename,\n\temp.salary,\n\tjob.jname,\n\tjob.description,\n\tdept.dname,\n\tdept.loc\nFROM\n\temp,\n\tjob,\n\tdept\nWHERE\n\temp.job_id = job.id\n\tand dept.id = emp.dept_id\n;\n\n-- 方式二 ：显式内连接\nSELECT\n\temp.id,\n\temp.ename,\n\temp.salary,\n\tjob.jname,\n\tjob.description,\n\tdept.dname,\n\tdept.loc\nFROM\n\temp\nINNER JOIN job ON emp.job_id = job.id\nINNER JOIN dept ON dept.id = emp.dept_id\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br")])]),a("p",[s._v("查询员工姓名，工资，工资等级：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/*\n\t分析：\n\t\t1. 员工姓名，工资 信息在emp 员工表中\n\t\t2. 工资等级 信息在 salarygrade 工资等级表中\n\t\t3. emp.salary >= salarygrade.losalary  and emp.salary <= salarygrade.hisalary\n*/\nSELECT\n\temp.ename,\n\temp.salary,\n\tt2.*\nFROM\n\temp,\n\tsalarygrade t2\nWHERE\n\temp.salary >= t2.losalary\nAND emp.salary <= t2.hisalary\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("查询员工姓名，工资，职务名称，职务描述，部门名称，部门位置，工资等级：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/*\n\t分析：\n\t\t1. 员工编号，员工姓名，工资 信息在emp 员工表中\n\t\t2. 职务名称，职务描述 信息在 job 职务表中\n\t\t3. job 职务表 和 emp 员工表 是 一对多的关系 emp.job_id = job.id\n\n\t\t4. 部门名称，部门位置 来自于 部门表 dept\n\t\t5. dept 和 emp 一对多关系 dept.id = emp.dept_id\n\t\t6. 工资等级 信息在 salarygrade 工资等级表中\n\t\t7. emp.salary >= salarygrade.losalary  and emp.salary <= salarygrade.hisalary\n*/\nSELECT\n\temp.id,\n\temp.ename,\n\temp.salary,\n\tjob.jname,\n\tjob.description,\n\tdept.dname,\n\tdept.loc,\n\tt2.grade\nFROM\n\temp\nINNER JOIN job ON emp.job_id = job.id\nINNER JOIN dept ON dept.id = emp.dept_id\nINNER JOIN salarygrade t2 ON emp.salary BETWEEN t2.losalary and t2.hisalary;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("p",[s._v("查询出部门编号、部门名称、部门位置、部门人数：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/*\n\t分析：\n\t\t1. 部门编号、部门名称、部门位置 来自于部门 dept 表\n\t\t2. 部门人数: 在emp表中 按照dept_id 进行分组，然后count(*)统计数量\n\t\t3. 使用子查询，让部门表和分组后的表进行内连接\n*/\n-- 根据部门id分组查询每一个部门id和员工数\nselect dept_id, count(*) from emp group by dept_id;\n\nSELECT\n\tdept.id,\n\tdept.dname,\n\tdept.loc,\n\tt1.count\nFROM\n\tdept,\n\t(\n\t\tSELECT\n\t\t\tdept_id,\n\t\t\tcount(*) count\n\t\tFROM\n\t\t\temp\n\t\tGROUP BY\n\t\t\tdept_id\n\t) t1\nWHERE\n\tdept.id = t1.dept_id\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("h2",{attrs:{id:"四-作业"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四-作业"}},[s._v("#")]),s._v(" 四，作业")]),s._v(" "),a("h2",{attrs:{id:"五-事务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五-事务"}},[s._v("#")]),s._v(" 五，事务")]),s._v(" "),a("h3",{attrs:{id:"_1-什么是事务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么是事务"}},[s._v("#")]),s._v(" 1，什么是事务")]),s._v(" "),a("p",[s._v("数据库的事务（Transaction）是一种机制、一个操作序列，包含了一组数据库操作命令。事务把所有的命令作为一个整体一起向系统提交或撤销操作请求，即这一组数据库命令要么同时成功，要么同时失败。事务是一个不可分割的工作逻辑单元。")]),s._v(" "),a("p",[s._v("这些概念不好理解，接下来举例说明，张三和李四账户中各有100块钱，现李四需要转换500块钱给张三，具体的转账操作为")]),s._v(" "),a("ul",[a("li",[s._v("第一步：查询李四账户余额")]),s._v(" "),a("li",[s._v("第二步：从李四账户金额 -500")]),s._v(" "),a("li",[s._v("第三步：给张三账户金额 +500")])]),s._v(" "),a("p",[s._v("现在假设在转账过程中第二步完成后出现了异常第三步没有执行，就会造成李四账户金额少了500，而张三金额并没有多500；这样的系统是有问题的。如果解决呢？使用事务可以解决上述问题")]),s._v(" "),a("p",[a("img",{attrs:{src:n(3870),alt:"1701943853992"}})]),s._v(" "),a("p",[s._v("从上图可以看到在转账前开启事务，如果出现了异常回滚事务，三步正常执行就提交事务，这样就可以完美解决问题。")]),s._v(" "),a("h3",{attrs:{id:"_2-语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-语法"}},[s._v("#")]),s._v(" 2，语法")]),s._v(" "),a("p",[s._v("开启事务：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("START TRANSACTION;\n或者  \nBEGIN;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("提交事务：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("commit;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("回滚事务：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("rollback;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_3-代码验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-代码验证"}},[s._v("#")]),s._v(" 3，代码验证")]),s._v(" "),a("p",[s._v("环境准备：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("DROP TABLE IF EXISTS account;\n\n-- 创建账户表\nCREATE TABLE account(\n\tid int PRIMARY KEY auto_increment,\n\tname varchar(10),\n\tmoney double(10,2)\n);\n\n-- 添加数据\nINSERT INTO account(name,money) values('张三',1000),('李四',1000);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("不加事务演示问题：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 转账操作\n-- 1. 查询李四账户金额是否大于500\n\n-- 2. 李四账户 -500\nUPDATE account set money = money - 500 where name = '李四';\n\n出现异常了...  -- 此处不是注释，在整体执行时会出问题，后面的sql则不执行\n-- 3. 张三账户 +500\nUPDATE account set money = money + 500 where name = '张三';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("整体执行结果肯定会出问题，我们查询账户表中数据，发现李四账户少了500。")]),s._v(" "),a("p",[s._v("添加事务sql如下：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("-- 开启事务\nBEGIN;\n-- 转账操作\n-- 1. 查询李四账户金额是否大于500\n\n-- 2. 李四账户 -500\nUPDATE account set money = money - 500 where name = '李四';\n\n出现异常了...  -- 此处不是注释，在整体执行时会出问题，后面的sql则不执行\n-- 3. 张三账户 +500\nUPDATE account set money = money + 500 where name = '张三';\n\n-- 提交事务\nCOMMIT;\n\n-- 回滚事务\nROLLBACK;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("上面sql中的执行成功进选择执行提交事务，而出现问题则执行回滚事务的语句。以后我们肯定不可能这样操作，而是在java中进行操作，在java中可以抓取异常，没出现异常提交事务，出现异常回滚事务。")]),s._v(" "),a("h3",{attrs:{id:"_4-事务的四大特征"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-事务的四大特征"}},[s._v("#")]),s._v(" 4，事务的四大特征")]),s._v(" "),a("p",[s._v("事务有四在特征：")]),s._v(" "),a("ul",[a("li",[s._v("原子性（Atomicity）: 事务是不可分割的最小操作单位，要么同时成功，要么同时失败")]),s._v(" "),a("li",[s._v("一致性（Consistency） : 事务完成时，必须使所有的数据都保持一致状态")]),s._v(" "),a("li",[s._v("隔离性（Isolation） : 多个事务之间，操作的可见性")]),s._v(" "),a("li",[s._v("持久性（Durability） : 事务一旦提交或回滚，它对数据库中的数据的改变就是永久的")])]),s._v(" "),a("p",[s._v("注意：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("mysql中事务是自动提交的。也就是说我们不添加事务执行sql语句，语句执行完毕会自动的提交事务。")])]),s._v(" "),a("li",[a("p",[s._v("可以通过下面语句查询默认提交方式：")])])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("  SELECT @@autocommit;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("查询到的结果是1 则表示自动提交，结果是0表示手动提交。当然也可以通过下面语句修改提交方式")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("  set @@autocommit = 0;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);